import{j as e,D as Le,x as $e,B as d,y as Ue,z as te,T as He,J as V,K as L,M as $,N as U,ad as H,C as c,c as D,d as P,e as n,u as Re,a as Je,r as t,s as A,m as Ke,X as Xe,L as q,E as le}from"./index-qjbGaV1R.js";import{I as Ze}from"./input-DMmXNW5d.js";import{B as v}from"./badge-Du_-s9xo.js";import{S as Qe,a as We,b as Ye,c as es,d as ss}from"./select-DG44e7yv.js";import{T as Fe,a as Te,b as _,c as E}from"./tabs-Dsj9E4Ur.js";import{M as as}from"./more-vertical-B-WTRQZD.js";import{E as ts}from"./eye-Bb_eQPku.js";import{P as ls}from"./pen-square-DMkr_5gI.js";import{a as rs,S as Ce}from"./SmartFoodForm-C1uqqBiT.js";import{P as R}from"./package-CLLd6dlx.js";import{I as is}from"./info-CuZxRFa3.js";import{u as cs}from"./useDebounce-DVzgXgil.js";import{D as re}from"./database-Dimt_sH2.js";import{P as ie}from"./plus-D0VXwTZj.js";import{S as ns}from"./search-CZaMVAuB.js";import{F as ms}from"./filter-Cms1GFVZ.js";import{C as ce}from"./chevron-left-Klv_B5pP.js";import"./extends-CF3RwP-h.js";import"./label-TnYOms6c.js";import"./progress-Dxax-x-g.js";import"./foodService-CbEIQ_uF.js";import"./query-helpers-CC2p4I3d.js";import"./check-circle-2-BHVXFD1J.js";const ne=({food:s,isCustom:m=!1,onView:o,onEdit:u,onDelete:p})=>{const h={TACO:"TACO",IBGE:"IBGE",USDA:"USDA",Tucunduva:"Tucunduva",TBCA:"TBCA",custom:"Personalizado"},J={TACO:"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300 border-blue-200 dark:border-blue-800",IBGE:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 border-green-200 dark:border-green-800",USDA:"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300 border-purple-200 dark:border-purple-800",Tucunduva:"bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300 border-orange-200 dark:border-orange-800",TBCA:"bg-pink-100 text-pink-700 dark:bg-pink-900 dark:text-pink-300 border-pink-200 dark:border-pink-800",custom:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900 dark:text-emerald-300 border-emerald-200 dark:border-emerald-800"};return e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-muted/50 transition-colors group",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium text-sm text-foreground truncate",children:s.name}),s.source&&e.jsx(v,{variant:"outline",className:`${J[s.source]||"bg-gray-100 text-gray-700"} text-[10px] px-1.5 py-0.5 h-auto font-medium flex-shrink-0`,children:h[s.source]||s.source})]}),s.group&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.group})]}),e.jsxs("div",{className:"hidden sm:flex items-center gap-3 flex-shrink-0",children:[e.jsxs("div",{className:"text-center min-w-[50px]",children:[e.jsx("p",{className:"text-xs font-semibold text-red-600 dark:text-red-400",children:s.calories?Math.round(s.calories):"—"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"kcal"})]}),e.jsxs("div",{className:"text-center min-w-[45px]",children:[e.jsx("p",{className:"text-xs font-semibold text-purple-600 dark:text-purple-400",children:s.protein?s.protein.toFixed(1):"—"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"P"})]}),e.jsxs("div",{className:"text-center min-w-[45px]",children:[e.jsx("p",{className:"text-xs font-semibold text-blue-600 dark:text-blue-400",children:s.carbs?s.carbs.toFixed(1):"—"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"C"})]}),e.jsxs("div",{className:"text-center min-w-[45px]",children:[e.jsx("p",{className:"text-xs font-semibold text-orange-600 dark:text-orange-400",children:s.fat?s.fat.toFixed(1):"—"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"G"})]})]}),e.jsxs("div",{className:"flex sm:hidden items-center gap-2 flex-shrink-0",children:[e.jsxs("div",{className:"text-xs font-semibold text-red-600 dark:text-red-400",children:[s.calories?Math.round(s.calories):"—","kcal"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["P:",s.protein?s.protein.toFixed(1):"—"," C:",s.carbs?s.carbs.toFixed(1):"—"," G:",s.fat?s.fat.toFixed(1):"—"]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs(Le,{children:[e.jsx($e,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(as,{className:"h-4 w-4"})})}),e.jsxs(Ue,{align:"end",children:[e.jsxs(te,{onClick:()=>o&&o(s),children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Ver Detalhes"]}),m&&e.jsxs(e.Fragment,{children:[e.jsxs(te,{onClick:()=>u&&u(s),children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Editar"]}),e.jsxs(te,{onClick:()=>p&&p(s),className:"text-destructive focus:text-destructive",children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"Excluir"]})]})]})]})})]})},ds=({food:s,open:m,onOpenChange:o})=>{if(!s)return null;const u={TACO:"TACO - Tabela Brasileira de Composição de Alimentos",IBGE:"IBGE - Instituto Brasileiro de Geografia e Estatística",USDA:"USDA - United States Department of Agriculture",Tucunduva:"Tucunduva",TBCA:"TBCA - Tabela Brasileira de Composição de Alimentos",custom:"Personalizado"},p={TACO:"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300",IBGE:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300",USDA:"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300",Tucunduva:"bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300",TBCA:"bg-pink-100 text-pink-700 dark:bg-pink-900 dark:text-pink-300",custom:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900 dark:text-emerald-300"};return e.jsx(V,{open:m,onOpenChange:o,children:e.jsxs(L,{className:"max-w-4xl max-h-[90vh] w-[95vw] sm:w-full p-4 sm:p-6",children:[e.jsxs($,{className:"pb-3 sm:pb-4",children:[e.jsxs(U,{className:"text-lg sm:text-xl flex items-center gap-2 flex-wrap",children:[e.jsx(R,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"break-words",children:s.name})]}),e.jsxs(H,{className:"mt-2",children:[s.group&&e.jsx("span",{className:"block text-xs sm:text-sm",children:s.group}),s.source&&e.jsx(v,{variant:"outline",className:`${p[s.source]||""} mt-2 text-xs`,children:u[s.source]||s.source})]})]}),e.jsx(rs,{className:"max-h-[calc(90vh-120px)] sm:max-h-[70vh] pr-2 sm:pr-4",children:e.jsxs(Fe,{defaultValue:"macros",className:"w-full",children:[e.jsxs(Te,{className:"grid w-full grid-cols-3 h-auto p-1 gap-1",children:[e.jsxs(_,{value:"macros",className:"text-xs sm:text-sm px-2 sm:px-4 py-2",children:[e.jsx("span",{className:"hidden sm:inline",children:"Macronutrientes"}),e.jsx("span",{className:"sm:hidden",children:"Macros"})]}),e.jsxs(_,{value:"micros",className:"text-xs sm:text-sm px-2 sm:px-4 py-2",children:[e.jsx("span",{className:"hidden sm:inline",children:"Micronutrientes"}),e.jsx("span",{className:"sm:hidden",children:"Micros"})]}),e.jsx(_,{value:"info",className:"text-xs sm:text-sm px-2 sm:px-4 py-2",children:"Informações"})]}),e.jsxs(E,{value:"macros",className:"space-y-3 sm:space-y-4 mt-3 sm:mt-4",children:[e.jsxs(c,{children:[e.jsx(D,{className:"pb-3",children:e.jsx(P,{className:"text-sm sm:text-base",children:"Valores por 100g"})}),e.jsx(n,{className:"pt-0",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"text-center p-2 sm:p-4 bg-red-50 dark:bg-red-950/20 rounded-lg",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mb-1",children:"Calorias"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-red-600 dark:text-red-400",children:s.calories?Math.round(s.calories):"—"}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"kcal"})]}),e.jsxs("div",{className:"text-center p-2 sm:p-4 bg-purple-50 dark:bg-purple-950/20 rounded-lg",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mb-1",children:"Proteína"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-purple-600 dark:text-purple-400",children:s.protein?s.protein.toFixed(1):"—"}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"g"})]}),e.jsxs("div",{className:"text-center p-2 sm:p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mb-1",children:"Carboidratos"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-blue-600 dark:text-blue-400",children:s.carbs?s.carbs.toFixed(1):"—"}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"g"})]}),e.jsxs("div",{className:"text-center p-2 sm:p-4 bg-orange-50 dark:bg-orange-950/20 rounded-lg",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground mb-1",children:"Gorduras"}),e.jsx("p",{className:"text-lg sm:text-2xl font-bold text-orange-600 dark:text-orange-400",children:s.fat?s.fat.toFixed(1):"—"}),e.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"g"})]})]})})]}),(s.saturated_fat||s.trans_fat||s.monounsaturated_fat||s.polyunsaturated_fat||s.cholesterol||s.fiber||s.sugar||s.sodium)&&e.jsxs(c,{children:[e.jsx(D,{className:"pb-3",children:e.jsx(P,{className:"text-sm sm:text-base",children:"Gorduras Detalhadas e Outros"})}),e.jsx(n,{className:"pt-0",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 sm:gap-4",children:[s.fiber&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Fibra"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.fiber.toFixed(1)," g"]})]}),s.sugar&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Açúcares"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.sugar.toFixed(1)," g"]})]}),s.saturated_fat&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gordura Saturada"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.saturated_fat.toFixed(1)," g"]})]}),s.trans_fat&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gordura Trans"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.trans_fat.toFixed(1)," g"]})]}),s.monounsaturated_fat&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gordura Monoinsaturada"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.monounsaturated_fat.toFixed(1)," g"]})]}),s.polyunsaturated_fat&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gordura Poliinsaturada"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.polyunsaturated_fat.toFixed(1)," g"]})]}),s.cholesterol&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Colesterol"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.cholesterol.toFixed(0)," mg"]})]}),s.sodium&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sódio"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.sodium.toFixed(0)," mg"]})]})]})})]})]}),e.jsx(E,{value:"micros",className:"space-y-3 sm:space-y-4 mt-3 sm:mt-4",children:s.calcium||s.iron||s.magnesium||s.phosphorus||s.potassium||s.zinc||s.vitamin_a||s.vitamin_c||s.vitamin_d||s.vitamin_e||s.vitamin_b12||s.folate?e.jsxs(e.Fragment,{children:[(s.calcium||s.iron||s.magnesium||s.phosphorus||s.potassium||s.zinc)&&e.jsxs(c,{children:[e.jsx(D,{className:"pb-3",children:e.jsx(P,{className:"text-sm sm:text-base",children:"Minerais (mg por 100g)"})}),e.jsx(n,{className:"pt-0",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4",children:[s.calcium&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cálcio"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.calcium.toFixed(1)," mg"]})]}),s.iron&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ferro"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.iron.toFixed(1)," mg"]})]}),s.magnesium&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Magnésio"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.magnesium.toFixed(1)," mg"]})]}),s.phosphorus&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Fósforo"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.phosphorus.toFixed(1)," mg"]})]}),s.potassium&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Potássio"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.potassium.toFixed(1)," mg"]})]}),s.zinc&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Zinco"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.zinc.toFixed(1)," mg"]})]})]})})]}),(s.vitamin_a||s.vitamin_c||s.vitamin_d||s.vitamin_e||s.vitamin_b12||s.folate)&&e.jsxs(c,{children:[e.jsx(D,{className:"pb-3",children:e.jsx(P,{className:"text-sm sm:text-base",children:"Vitaminas (mg por 100g)"})}),e.jsx(n,{className:"pt-0",children:e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 sm:gap-4",children:[s.vitamin_a&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vitamina A"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.vitamin_a.toFixed(1)," mg"]})]}),s.vitamin_c&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vitamina C"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.vitamin_c.toFixed(1)," mg"]})]}),s.vitamin_d&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vitamina D"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.vitamin_d.toFixed(1)," mg"]})]}),s.vitamin_e&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vitamina E"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.vitamin_e.toFixed(1)," mg"]})]}),s.vitamin_b12&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Vitamina B12"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.vitamin_b12.toFixed(1)," mg"]})]}),s.folate&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Folato"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.folate.toFixed(1)," mg"]})]})]})})]})]}):e.jsx(c,{children:e.jsxs(n,{className:"py-8 text-center",children:[e.jsx(is,{className:"w-8 h-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum micronutriente cadastrado para este alimento"})]})})}),e.jsx(E,{value:"info",className:"space-y-3 sm:space-y-4 mt-3 sm:mt-4",children:e.jsxs(c,{children:[e.jsx(D,{className:"pb-3",children:e.jsx(P,{className:"text-sm sm:text-base",children:"Informações Gerais"})}),e.jsxs(n,{className:"pt-0 space-y-3 sm:space-y-4",children:[s.description&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Descrição"}),e.jsx("p",{className:"text-sm",children:s.description})]}),s.preparation&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Modo de Preparo"}),e.jsx("p",{className:"text-sm",children:s.preparation})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Porção Padrão"}),e.jsxs("p",{className:"text-sm font-semibold",children:[s.portion_size||100,"g"]})]}),s.source&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Fonte"}),e.jsx(v,{variant:"outline",className:p[s.source],children:u[s.source]||s.source})]})]}),s.food_measures&&s.food_measures.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Medidas Caseiras Cadastradas"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.food_measures.map(h=>e.jsxs(v,{variant:"outline",children:[h.measure_label," (",h.quantity_grams,"g)"]},h.id))})]})]})]})})]})})]})})},y=20,Ms=()=>{const{user:s}=Re(),{toast:m}=Je(),[o,u]=t.useState([]),[p,h]=t.useState([]),[J,me]=t.useState(!0),[K,de]=t.useState(""),[i,Se]=t.useState("all"),[De,Pe]=t.useState(null),[Ae,xe]=t.useState(!1),[_e,M]=t.useState(!1),[Ee,X]=t.useState(!1),[oe,ue]=t.useState(null),[Me,z]=t.useState(!1),[Z,Q]=t.useState(null),[N,b]=t.useState(0),[k,W]=t.useState(0),[C,pe]=t.useState(0),[B,he]=t.useState(0),[w,je]=t.useState(!1),[Y,ge]=t.useState(!1),f=cs(K,300),ze=[{value:"all",label:"Todas as Fontes"},{value:"custom",label:"Meus Alimentos Personalizados"},{value:"TACO",label:"TACO"},{value:"IBGE",label:"IBGE"},{value:"USDA",label:"USDA"},{value:"Tucunduva",label:"Tucunduva"},{value:"TBCA",label:"TBCA"}],j=t.useCallback(async(a=0,l=!1)=>{if(i!=="all"&&i!=="custom"){l||(u([]),pe(0));return}je(!0);try{const r=a*y;let g=A.from("foods").select("*, food_measures(*)",{count:"exact"}).eq("is_active",!0).or(`source.eq.custom,nutritionist_id.eq.${s.id}`).order("name",{ascending:!0}).range(r,r+y-1);if(f.trim()){const x=f.toLowerCase();g=g.or(`name.ilike.%${x}%,group.ilike.%${x}%,description.ilike.%${x}%`)}const{data:T,error:S,count:ae}=await g;if(S)throw S;u(l?x=>[...x,...T||[]]:T||[]),pe(ae||0)}catch(r){console.error("Erro ao buscar alimentos personalizados:",r),m({title:"Erro",description:"Não foi possível carregar os alimentos personalizados.",variant:"destructive"})}finally{je(!1)}},[s.id,f,i,m]),O=t.useCallback(async(a=0,l=!1)=>{if(i==="custom"){l||(h([]),he(0));return}ge(!0);try{const r=a*y;let g=A.from("foods").select("*, food_measures(*)",{count:"exact"}).eq("is_active",!0).neq("source","custom").is("nutritionist_id",null).order("name",{ascending:!0}).range(r,r+y-1);if(i!=="all"&&(g=g.eq("source",i)),f.trim()){const x=f.toLowerCase();g=g.or(`name.ilike.%${x}%,group.ilike.%${x}%,description.ilike.%${x}%`)}const{data:T,error:S,count:ae}=await g;if(S)throw S;h(l?x=>[...x,...T||[]]:T||[]),he(ae||0)}catch(r){console.error("Erro ao buscar alimentos públicos:",r),m({title:"Erro",description:"Não foi possível carregar os alimentos públicos.",variant:"destructive"})}finally{ge(!1)}},[f,i,m]),G=t.useCallback(async()=>{try{const[a,l]=await Promise.all([A.from("foods").select("id",{count:"exact",head:!0}).eq("is_active",!0).or(`source.eq.custom,nutritionist_id.eq.${s.id}`),A.from("foods").select("id",{count:"exact",head:!0}).eq("is_active",!0).neq("source","custom").is("nutritionist_id",null)]);return{custom:a.count||0,public:l.count||0}}catch(a){return console.error("Erro ao buscar estatísticas:",a),{custom:0,public:0}}},[s.id]),[Ne,I]=t.useState({custom:0,public:0});t.useEffect(()=>{(async()=>{me(!0);const l=await G();I(l),await Promise.all([j(0,!1),O(0,!1)]),me(!1)})()},[]),t.useEffect(()=>{b(0),W(0),(async()=>{await Promise.all([j(0,!1),O(0,!1)])})()},[f,i]);const ee=a=>{Pe(a),xe(!0)},be=a=>{ue(a),X(!0)},fe=a=>{Q(a),z(!0)},Be=async()=>{if(Z)try{const{error:a}=await A.from("foods").delete().eq("id",Z.id);if(a)throw a;m({title:"Sucesso!",description:"Alimento excluído com sucesso."}),b(0),j(0,!1);const l=await G();I(l),z(!1),Q(null)}catch(a){console.error("Erro ao excluir alimento:",a),m({title:"Erro",description:"Não foi possível excluir o alimento.",variant:"destructive"})}},Oe=async()=>{M(!1),b(0),await j(0,!1);const a=await G();I(a),m({title:"Sucesso!",description:"Alimento criado com sucesso."})},Ge=async()=>{X(!1),ue(null),b(0),await j(0,!1);const a=await G();I(a),m({title:"Sucesso!",description:"Alimento atualizado com sucesso."})},F=Math.ceil(C/y),se=Math.ceil(B/y),ve=N<F-1,we=N>0,Ie=k<se-1,qe=k>0,ye=a=>{const l=Math.ceil(a.length/2);return[a.slice(0,l),a.slice(l)]},ke=t.useMemo(()=>ye(o),[o]),Ve=t.useMemo(()=>ye(p),[p]);return e.jsxs("div",{className:"flex flex-col min-h-screen bg-background overflow-x-hidden",children:[e.jsxs(Ke.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-7xl mx-auto w-full px-4 md:px-8 pt-4 md:pt-8 pb-8 md:pb-12 space-y-6 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4",children:[e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 mb-2",children:[e.jsx(re,{className:"w-7 h-7 md:w-8 md:h-8 text-primary shrink-0"}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-foreground break-words",children:"Banco de Alimentos"})]}),e.jsx("p",{className:"text-muted-foreground text-sm md:text-base",children:"Gerencie seus alimentos personalizados e consulte o banco público de alimentos"})]}),e.jsxs(d,{onClick:()=>M(!0),size:"lg",children:[e.jsx(ie,{className:"w-5 h-5 mr-2"}),"Novo Alimento"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 min-w-0",children:[e.jsx(c,{className:"overflow-hidden",children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 min-w-0",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs md:text-sm font-medium text-muted-foreground truncate",children:"Meus Alimentos Personalizados"}),e.jsx("p",{className:"text-2xl md:text-3xl font-bold mt-1",children:Ne.custom})]}),e.jsx(R,{className:"w-8 h-8 md:w-10 md:h-10 text-primary opacity-50 shrink-0"})]})})}),e.jsx(c,{className:"overflow-hidden",children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 min-w-0",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs md:text-sm font-medium text-muted-foreground truncate",children:"Banco de Dados Público"}),e.jsx("p",{className:"text-2xl md:text-3xl font-bold mt-1",children:Ne.public})]}),e.jsx(re,{className:"w-8 h-8 md:w-10 md:h-10 text-primary opacity-50 shrink-0"})]})})})]}),e.jsx(c,{className:"overflow-hidden",children:e.jsx(n,{className:"pt-4 sm:pt-6",children:e.jsxs("div",{className:"space-y-3 sm:space-y-4 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1 relative min-w-0",children:[e.jsx(ns,{className:"absolute left-3 top-3 h-5 w-5 text-muted-foreground"}),e.jsx(Ze,{placeholder:"Buscar alimento por nome, grupo ou descrição...",value:K,onChange:a=>de(a.target.value),className:"pl-10 min-w-0"})]}),e.jsxs(Qe,{value:i,onValueChange:Se,children:[e.jsxs(We,{className:"w-full sm:w-[250px]",children:[e.jsx(ms,{className:"w-4 h-4 mr-2"}),e.jsx(Ye,{placeholder:"Filtrar por fonte"})]}),e.jsx(es,{children:ze.map(a=>e.jsx(ss,{value:a.value,children:a.label},a.value))})]})]}),K&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(v,{variant:"outline",children:[C+B," resultado(s) encontrado(s)"]}),e.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>de(""),children:[e.jsx(Xe,{className:"w-4 h-4 mr-1"}),"Limpar busca"]})]})]})})}),J?e.jsx(c,{children:e.jsx(n,{className:"py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(q,{className:"w-8 h-8 animate-spin text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando alimentos..."})]})})}):e.jsxs(Fe,{defaultValue:"all",className:"w-full",children:[e.jsxs(Te,{className:"grid w-full grid-cols-2 h-auto p-1 gap-1",children:[e.jsxs(_,{value:"all",className:"text-xs sm:text-sm px-2 sm:px-4 py-2",children:[e.jsx("span",{className:"hidden sm:inline",children:"Todos"}),e.jsx("span",{className:"sm:hidden",children:"Todos"}),e.jsxs("span",{className:"ml-1",children:["(",C+B,")"]})]}),e.jsxs(_,{value:"custom",className:"text-xs sm:text-sm px-2 sm:px-4 py-2",children:[e.jsx("span",{className:"hidden sm:inline",children:"Meus Alimentos"}),e.jsx("span",{className:"sm:hidden",children:"Meus"}),e.jsxs("span",{className:"ml-1",children:["(",C,")"]})]})]}),e.jsxs(E,{value:"all",className:"space-y-6 mt-6",children:[(i==="all"||i==="custom")&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-emerald-600"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Meus Alimentos Personalizados"}),e.jsx(v,{variant:"outline",className:"bg-emerald-50 text-emerald-700 dark:bg-emerald-900 dark:text-emerald-300",children:C})]})}),w?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(q,{className:"w-6 h-6 animate-spin text-primary"})}):o.length===0?e.jsx(c,{children:e.jsx(n,{className:"py-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum alimento personalizado encontrado"})})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:ke.map((a,l)=>e.jsx("div",{className:"space-y-2",children:a.map(r=>e.jsx(ne,{food:r,isCustom:!0,onView:ee,onEdit:be,onDelete:fe},r.id))},l))}),F>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 pt-4",children:[e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["Página ",N+1," de ",F]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{b(a=>Math.max(0,a-1)),j(Math.max(0,N-1),!1)},disabled:!we||w,className:"flex-1 sm:flex-initial",children:[e.jsx(ce,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Anterior"}),e.jsx("span",{className:"sm:hidden",children:"Ant"})]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{b(a=>a+1),j(N+1,!1)},disabled:!ve||w,className:"flex-1 sm:flex-initial",children:[e.jsx("span",{className:"hidden sm:inline",children:"Próxima"}),e.jsx("span",{className:"sm:hidden",children:"Próx"}),e.jsx(le,{className:"w-4 h-4 ml-1"})]})]})]})]})]}),(i==="all"||i!=="custom")&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Banco de Dados Público"}),e.jsx(v,{variant:"outline",children:B})]})}),Y?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(q,{className:"w-6 h-6 animate-spin text-primary"})}):p.length===0?e.jsx(c,{children:e.jsx(n,{className:"py-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum alimento público encontrado"})})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:Ve.map((a,l)=>e.jsx("div",{className:"space-y-2",children:a.map(r=>e.jsx(ne,{food:r,isCustom:!1,onView:ee},r.id))},l))}),se>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 pt-4",children:[e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["Página ",k+1," de ",se]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{W(a=>Math.max(0,a-1)),O(Math.max(0,k-1),!1)},disabled:!qe||Y,className:"flex-1 sm:flex-initial",children:[e.jsx(ce,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Anterior"}),e.jsx("span",{className:"sm:hidden",children:"Ant"})]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{W(a=>a+1),O(k+1,!1)},disabled:!Ie||Y,className:"flex-1 sm:flex-initial",children:[e.jsx("span",{className:"hidden sm:inline",children:"Próxima"}),e.jsx("span",{className:"sm:hidden",children:"Próx"}),e.jsx(le,{className:"w-4 h-4 ml-1"})]})]})]})]})]})]}),e.jsx(E,{value:"custom",className:"space-y-6 mt-6",children:w?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(q,{className:"w-8 h-8 animate-spin text-primary"})}):o.length===0?e.jsx(c,{children:e.jsxs(n,{className:"py-12 text-center",children:[e.jsx(R,{className:"w-12 h-12 text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Você ainda não criou nenhum alimento personalizado"}),e.jsxs(d,{onClick:()=>M(!0),children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Criar Primeiro Alimento"]})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:ke.map((a,l)=>e.jsx("div",{className:"space-y-2",children:a.map(r=>e.jsx(ne,{food:r,isCustom:!0,onView:ee,onEdit:be,onDelete:fe},r.id))},l))}),F>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3 pt-4",children:[e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground",children:["Página ",N+1," de ",F]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{b(a=>Math.max(0,a-1)),j(Math.max(0,N-1),!1)},disabled:!we||w,className:"flex-1 sm:flex-initial",children:[e.jsx(ce,{className:"w-4 h-4 mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Anterior"}),e.jsx("span",{className:"sm:hidden",children:"Ant"})]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>{b(a=>a+1),j(N+1,!1)},disabled:!ve||w,className:"flex-1 sm:flex-initial",children:[e.jsx("span",{className:"hidden sm:inline",children:"Próxima"}),e.jsx("span",{className:"sm:hidden",children:"Próx"}),e.jsx(le,{className:"w-4 h-4 ml-1"})]})]})]})]})})]})]}),e.jsx(ds,{food:De,open:Ae,onOpenChange:xe}),e.jsx(V,{open:_e,onOpenChange:M,children:e.jsxs(L,{className:"max-w-4xl max-h-[95vh] overflow-y-auto",children:[e.jsxs($,{children:[e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Novo Alimento Personalizado"]}),e.jsx(H,{children:"Crie um alimento customizado com busca por código de barras e cálculo automático"})]}),e.jsx(Ce,{mode:"full",onSuccess:Oe})]})}),e.jsx(V,{open:Ee,onOpenChange:X,children:e.jsxs(L,{className:"max-w-4xl max-h-[95vh] overflow-y-auto",children:[e.jsxs($,{children:[e.jsx(U,{className:"flex items-center gap-2",children:"Editar Alimento"}),e.jsx(H,{children:"Edite as informações nutricionais e medidas caseiras"})]}),oe&&e.jsx(Ce,{mode:"full",initialData:oe,onSuccess:Ge})]})}),e.jsx(V,{open:Me,onOpenChange:z,children:e.jsxs(L,{children:[e.jsxs($,{children:[e.jsx(U,{children:"Confirmar Exclusão"}),e.jsxs(H,{children:['Tem certeza que deseja excluir o alimento "',Z?.name,'"? Esta ação não pode ser desfeita.']})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(d,{variant:"outline",onClick:()=>{z(!1),Q(null)},children:"Cancelar"}),e.jsx(d,{variant:"destructive",onClick:Be,children:"Excluir"})]})]})})]})};export{Ms as default};
