import{q as He,s as Y,a as rt,r as b,j as e,C as L,c as K,d as W,w as U,e as G,B as re,L as jt,X as st,F as vt,at as yt,O as we,H as Fe,ak as $,aF as Nt,au as _t,b as wt}from"./index-Cl9S2_vK.js";import{A as le,a as ce}from"./alert-Cz0d9f0N.js";import{I as T}from"./input-J8T_OYAP.js";import{L as M}from"./label-B6xwKmAy.js";import{T as kt}from"./textarea-Ck-wLz_m.js";import{T as Ct,a as St,b as ge,c as je}from"./tabs-C2iurRVm.js";import{B as me}from"./badge-DPJEOXlY.js";import{S as At,a as Pt,b as Et,c as Ft,d as Ae}from"./select-DVIkm2mv.js";import{U as Mt}from"./upload-DPPQuvoF.js";import{C as ne}from"./calculator-BdlGdxnE.js";import{R as Ye}from"./ruler-CwIAZpVo.js";import{A as Le}from"./alert-circle--FqPo4fT.js";import{S as Ot}from"./save-Dd24c85S.js";import{d as Tt}from"./differenceInYears-JHOpod1y.js";import{T as Dt,a as Rt,b as Ue,c as Q,d as $t,e as ee}from"./table-D_f1KBqs.js";import{M as zt}from"./minus-YsdgalHT.js";import{T as It}from"./trending-down-RN1wbuZQ.js";import{W as Bt}from"./WeightChart-b84siqcJ.js";import{S as Ze,a as qt,f as qe,L as ve,b as Lt,A as Kt,i as Pe,c as Wt,d as at,E as Gt,g as Ee,e as Vt,h as Ht,C as Xt,j as de,k as Yt,u as Ut,G as Zt,l as ot,m as Je,n as it,o as nt,B as Jt,R as Me,T as Oe,p as Ke,q as se}from"./generateCategoricalChart-Bh86yIqg.js";import{A as lt}from"./Area-BjIIikpx.js";import{L as ye,a as Qt}from"./LineChart-BiebZA-a.js";import{X as ue,Y as pe}from"./YAxis-St3DMelp.js";import{C as Te}from"./CartesianGrid-BgnuVKIx.js";import{A as er}from"./arrow-left-CUOJhKUw.js";import{R as tr,B as rr}from"./refresh-cw-449M6kAo.js";import"./extends-CF3RwP-h.js";const Qe=He("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),sr=He("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),ar=He("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),or=async(r,t={})=>{const{limit:o=50,offset:a=0,orderBy:i="record_date",ascending:n=!1}=t;try{const{data:c,error:s}=await Y.from("growth_records").select("*").eq("patient_id",r).order(i,{ascending:n}).range(a,a+o-1);if(s)throw s;return{data:c||[],error:null}}catch(c){return console.error("Erro ao buscar registros antropométricos:",c),{data:[],error:c}}},ir=async r=>{try{const{data:t,error:o}=await Y.from("growth_records").select("id, weight, height, record_date").eq("patient_id",r).order("record_date",{ascending:!0});if(o)throw o;return{data:(t||[]).map(i=>{const n=i.height&&i.weight?i.weight/Math.pow(i.height/100,2):null;return{...i,bmi:n,calculatedBmi:n}}),error:null}}catch(t){return console.error("Erro ao buscar dados para gráficos:",t),{data:[],error:t}}},nr=async r=>{try{const{patient_id:t,weight:o,height:a,record_date:i,notes:n,circumferences:c,skinfolds:s,bone_diameters:m,bioimpedance:h,photos:p,results:x}=r,d={patient_id:t,weight:o,height:a,record_date:i,notes:n||null,...c&&{circumferences:c},...s&&{skinfolds:s},...m&&{bone_diameters:m},...h&&{bioimpedance:h},...p&&{photos:p},...x&&{results:x}},{data:u,error:y}=await Y.from("growth_records").insert([d]).select().single();if(y)throw y;return{data:u,error:null}}catch(t){return console.error("Erro ao criar registro antropométrico:",t),{data:null,error:t}}},lr=async(r,t)=>{try{const{weight:o,height:a,record_date:i,notes:n,circumferences:c,skinfolds:s,bone_diameters:m,bioimpedance:h,photos:p,results:x}=t,d={...o!==void 0&&{weight:o},...a!==void 0&&{height:a},...i!==void 0&&{record_date:i},...n!==void 0&&{notes:n},...c!==void 0&&{circumferences:c},...s!==void 0&&{skinfolds:s},...m!==void 0&&{bone_diameters:m},...h!==void 0&&{bioimpedance:h},...p!==void 0&&{photos:p},...x!==void 0&&{results:x}},{data:u,error:y}=await Y.from("growth_records").update(d).eq("id",r).select().single();if(y)throw y;return{data:u,error:null}}catch(o){return console.error("Erro ao atualizar registro antropométrico:",o),{data:null,error:o}}},cr=async r=>{try{const{data:t,error:o}=await Y.from("growth_records").delete().eq("id",r).select().single();if(o)throw o;return{data:t,error:null}}catch(t){return console.error("Erro ao deletar registro antropométrico:",t),{data:null,error:t}}},dr=async r=>{try{const{data:t,error:o}=await Y.from("growth_records").select("weight, height, notes").eq("patient_id",r).order("record_date",{ascending:!1}).limit(1).maybeSingle();if(o)throw o;return{data:t,error:null}}catch(t){return console.error("Erro ao buscar último registro:",t),{data:null,error:t}}};function mr({recordId:r,initialPhotos:t=[],onPhotosChange:o}){const{toast:a}=rt(),[i,n]=b.useState(t||[]),[c,s]=b.useState(!1),m=!r||r.toString().startsWith("temp-"),h=async x=>{const d=x.target.files?.[0];if(d){if(m){a({title:"Atenção",description:"Salve o registro primeiro antes de adicionar fotos.",variant:"destructive"}),x.target.value="";return}if(!d.type.startsWith("image/")){a({title:"Erro",description:"Por favor, selecione um arquivo de imagem.",variant:"destructive"});return}if(d.size>5*1024*1024){a({title:"Erro",description:"A imagem deve ter no máximo 5MB.",variant:"destructive"});return}s(!0);try{const u=d.name.split(".").pop(),y=`${r}-${Date.now()}.${u}`,f=`${r}/${y}`,{error:_}=await Y.storage.from("patient-photos").upload(f,d,{cacheControl:"3600",upsert:!1});if(_)throw console.error("Erro no upload:",_),_;const{data:{publicUrl:k}}=Y.storage.from("patient-photos").getPublicUrl(f),C=[...i,k];n(C),o&&o(C),a({title:"Sucesso",description:"Foto enviada com sucesso!"})}catch(u){console.error("Erro ao fazer upload da foto:",u),a({title:"Erro",description:"Não foi possível fazer upload da foto. Tente novamente.",variant:"destructive"})}finally{s(!1),x.target.value=""}}},p=async(x,d)=>{try{const u=x.split("/"),y=u.slice(u.indexOf("patient-photos")+1).join("/"),{error:f}=await Y.storage.from("patient-photos").remove([y]);f&&console.error("Erro ao deletar foto:",f);const _=i.filter((k,C)=>C!==d);n(_),o&&o(_),a({title:"Sucesso",description:"Foto removida com sucesso!"})}catch(u){console.error("Erro ao deletar foto:",u),a({title:"Erro",description:"Não foi possível remover a foto.",variant:"destructive"})}};return e.jsxs(L,{children:[e.jsxs(K,{children:[e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(Qe,{className:"w-5 h-5"}),"Fotos de Progresso"]}),e.jsx(U,{children:"Adicione fotos antes/depois para acompanhar a evolução do paciente"})]}),e.jsxs(G,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("label",{htmlFor:"photo-upload",children:e.jsx(re,{type:"button",variant:"outline",className:"cursor-pointer",disabled:c||m,asChild:!0,children:e.jsx("span",{children:c?e.jsxs(e.Fragment,{children:[e.jsx(jt,{className:"w-4 h-4 mr-2 animate-spin"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Mt,{className:"w-4 h-4 mr-2"}),"Adicionar Foto"]})})})}),m&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"Salve o registro primeiro"}),e.jsx("input",{id:"photo-upload",type:"file",accept:"image/*",onChange:h,className:"hidden",disabled:c}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Máximo 5MB por foto"})]}),i.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:i.map((x,d)=>e.jsxs("div",{className:"relative group aspect-square rounded-lg overflow-hidden border border-border bg-muted",children:[e.jsx("img",{src:x,alt:`Foto ${d+1}`,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsxs(re,{type:"button",variant:"destructive",size:"sm",onClick:()=>p(x,d),className:"opacity-100",children:[e.jsx(st,{className:"w-4 h-4 mr-1"}),"Remover"]})})]},d))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center border-2 border-dashed border-muted rounded-lg",children:[e.jsx(Qe,{className:"w-12 h-12 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhuma foto adicionada ainda"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:'Clique em "Adicionar Foto" para começar'})]})]})]})}function ur(r,t,o){if(!r||!t||r<=0||t<=0)return null;const a=r/t;return o?a>10.9?{size:"Pequena",ratio:a,label:"Pequena"}:a>9.9?{size:"Média",ratio:a,label:"Média"}:{size:"Grande",ratio:a,label:"Grande"}:a>11?{size:"Pequena",ratio:a,label:"Pequena"}:a>10.1?{size:"Média",ratio:a,label:"Média"}:{size:"Grande",ratio:a,label:"Grande"}}function pr(r){const{height:t,weight:o,triceps:a,subscapular:i,suprailiac:n,humerusWidth:c,femurWidth:s,armCirc:m,calfCirc:h}=r;if(!t||!o)return null;let p=null;if(a&&i&&n){const f=a+i+n;p=-.7182+.1451*f-68e-5*f*f+14e-7*f*f*f,p<0&&(p=0)}let x=null;if(t&&c&&s&&m&&h){const f=t/100,_=m-(a||0)/10,k=h-(i||0)/10;x=.858*c+.601*s+.188*_+.161*k-f*.131+4.5,x<0&&(x=0)}let d=null;if(t&&o){const _=t/100/Math.pow(o,1/3);_>=.462?d=.732*_-28.58:_>=.231?d=.463*_-5.5:d=.1,d<0&&(d=0)}if(p===null||x===null||d===null)return null;const u=d-p,y=2*x-(p+d);return{endo:parseFloat(p.toFixed(2)),meso:parseFloat(x.toFixed(2)),ecto:parseFloat(d.toFixed(2)),x:parseFloat(u.toFixed(2)),y:parseFloat(y.toFixed(2))}}function We(r,t,o){if(!r||!t||!o)return"Incompleto";const a=Math.max(r,t,o);return a===r?t>o?"Endomorfo-Mesomorfo":"Endomorfo":a===t?r>o?"Mesomorfo-Endomorfo":o>r?"Mesomorfo-Ectomorfo":"Mesomorfo":t>r?"Ectomorfo-Mesomorfo":"Ectomorfo"}const xr=({patientId:r,initialData:t=null,onSubmit:o,onCancel:a,loading:i=!1,patientGender:n=null,patientBirthDate:c=null})=>{const[s,m]=b.useState({weight:"",height:"",record_date:new Date().toISOString().split("T")[0],notes:"",circumferences:{ombro:"",peito:"",cintura:"",abdomen:"",quadril:"",braco_relaxado_e:"",braco_relaxado_d:"",braco_contraido_e:"",braco_contraido_d:"",coxa_proximal_e:"",coxa_proximal_d:"",coxa_medial_e:"",coxa_medial_d:"",panturrilha_e:"",panturrilha_d:""},skinfolds:{triceps:"",biceps:"",subescapular:"",suprailiaca:"",abdominal:"",coxa:"",panturrilha:"",peito:"",axilar:""},bone_diameters:{punho:"",femur:"",umero:""},bioimpedance:{percent_gordura:"",percent_massa_magra:"",gordura_visceral:""},photos:[]}),[h,p]=b.useState(null),[x,d]=b.useState(null),[u,y]=b.useState(null),[f,_]=b.useState(null),[k,C]=b.useState(null),[N,O]=b.useState({}),[g,oe]=b.useState("pollock7"),[D,Z]=b.useState(null),[z,A]=b.useState(null),[w,F]=b.useState(null);b.useEffect(()=>{(async()=>{if(!t&&r){const{data:j}=await dr(r);j&&p(j)}})()},[r,t]),b.useEffect(()=>{t&&m({weight:t.weight||"",height:t.height||"",record_date:t.record_date||new Date().toISOString().split("T")[0],notes:t.notes||"",circumferences:t.circumferences||s.circumferences,skinfolds:t.skinfolds||s.skinfolds,bone_diameters:t.bone_diameters||{punho:"",femur:"",umero:""},bioimpedance:t.bioimpedance||s.bioimpedance,photos:t.photos||[]})},[t]),b.useEffect(()=>{const{weight:l,height:j}=s;if(l&&j){const v=parseFloat(j)/100,S=parseFloat(l)/Math.pow(v,2);d(S);const V=18.5*Math.pow(v,2),E=24.9*Math.pow(v,2);y({min:V,max:E,current:parseFloat(l)})}else d(null),y(null)},[s.weight,s.height]),b.useEffect(()=>{const{cintura:l,quadril:j}=s.circumferences;if(l&&j){const v=parseFloat(l)/parseFloat(j);_(v)}else _(null)},[s.circumferences.cintura,s.circumferences.quadril]),b.useEffect(()=>{const l=parseFloat(s.weight),j=parseFloat(s.height),v=c?Tt(new Date,new Date(c)):null,S=n?.toLowerCase()||"",V=S.includes("m")||S==="masculino"||S==="male";if(!l||!j){Z(null),C(null);return}let E=null,P=null,fe=null,Ce=null;if(g==="bioimpedance"&&s.bioimpedance?.percent_gordura)P=parseFloat(s.bioimpedance.percent_gordura);else if(g==="pollock3"){const I=parseFloat(s.skinfolds.triceps),X=parseFloat(s.skinfolds.subescapular),J=parseFloat(s.skinfolds.suprailiaca);if(I&&X&&J&&v){const B=I+X+J;V?E=1.10938-8267e-7*B+16e-7*B*B-2574e-7*v:E=1.0994921-9929e-7*B+23e-7*B*B-1392e-7*v}}else if(g==="pollock7"){const I=parseFloat(s.skinfolds.peito),X=parseFloat(s.skinfolds.axilar),J=parseFloat(s.skinfolds.triceps),B=parseFloat(s.skinfolds.subescapular),Se=parseFloat(s.skinfolds.abdominal),be=parseFloat(s.skinfolds.suprailiaca),Xe=parseFloat(s.skinfolds.coxa);if(I&&X&&J&&B&&Se&&be&&Xe&&v){const ie=I+X+J+B+Se+be+Xe;V?E=1.112-43499e-8*ie+55e-8*ie*ie-28826e-8*v:E=1.097-46971e-8*ie+56e-8*ie*ie-12828e-8*v}}else if(g==="weltman"){const I=parseFloat(s.skinfolds.triceps),X=parseFloat(s.skinfolds.biceps),J=parseFloat(s.skinfolds.subescapular),B=parseFloat(s.skinfolds.suprailiaca);if(I&&X&&J&&B&&v){const Se=I+X+J+B,be=Math.log10(Se);V?E=1.1714-.0671*be:E=1.1665-.0706*be}}E&&E>0&&(P=(4.95/E-4.5)*100),P&&P>0&&P<100?(fe=l*P/100,Ce=l-fe,Z({body_density:E,body_fat_percent:P,fat_mass_kg:fe,lean_mass_kg:Ce,protocol:g}),C(P)):(Z(null),C(null))},[s.weight,s.height,s.skinfolds,s.bioimpedance,g,n,c]),b.useEffect(()=>{const l=parseFloat(s.height),j=parseFloat(s.bone_diameters?.punho),v=n?.toLowerCase()||"",S=v.includes("m")||v==="masculino"||v==="male";if(l&&j){const V=ur(l,j,S);A(V)}else A(null)},[s.height,s.bone_diameters?.punho,n]),b.useEffect(()=>{const l=parseFloat(s.height),j=parseFloat(s.weight),v=parseFloat(s.skinfolds.triceps),S=parseFloat(s.skinfolds.subescapular),V=parseFloat(s.skinfolds.suprailiaca),E=parseFloat(s.bone_diameters?.umero),P=parseFloat(s.bone_diameters?.femur),fe=s.circumferences.braco_contraido_e||s.circumferences.braco_contraido_d,Ce=s.circumferences.panturrilha_e||s.circumferences.panturrilha_d,I=n?.toLowerCase()||"";if(I.includes("m"),l&&j){const X=pr({height:l,weight:j,triceps:v,subscapular:S,suprailiac:V,humerusWidth:E,femurWidth:P,armCirc:parseFloat(fe),calfCirc:parseFloat(Ce)});F(X)}else F(null)},[s.height,s.weight,s.skinfolds.triceps,s.skinfolds.subescapular,s.skinfolds.suprailiaca,s.bone_diameters?.umero,s.bone_diameters?.femur,s.circumferences.braco_contraido_e,s.circumferences.braco_contraido_d,s.circumferences.panturrilha_e,s.circumferences.panturrilha_d,n]);const H=l=>{const{name:j,value:v}=l.target;m(S=>({...S,[j]:v})),N[j]&&O(S=>({...S,[j]:null}))},R=(l,j,v)=>{m(S=>({...S,[l]:{...S[l],[j]:v}}))},$e=l=>{m(j=>({...j,photos:l}))},ze=()=>{const l={};return(!s.weight||parseFloat(s.weight)<=0)&&(l.weight="Peso é obrigatório e deve ser maior que zero"),(!s.height||parseFloat(s.height)<=0)&&(l.height="Altura é obrigatória e deve ser maior que zero"),s.record_date||(l.record_date="Data é obrigatória"),O(l),Object.keys(l).length===0},ht=l=>{if(l.preventDefault(),!ze())return;const j=Object.fromEntries(Object.entries(s.circumferences).filter(([E,P])=>P&&P!=="")),v=Object.fromEntries(Object.entries(s.skinfolds).filter(([E,P])=>P&&P!=="")),S=Object.fromEntries(Object.entries(s.bioimpedance).filter(([E,P])=>P&&P!=="")),V={patient_id:r,weight:parseFloat(s.weight),height:parseFloat(s.height),record_date:s.record_date,notes:s.notes.trim()||null,circumferences:Object.keys(j).length>0?j:null,skinfolds:Object.keys(v).length>0?v:null,bone_diameters:Object.keys(s.bone_diameters||{}).filter(E=>s.bone_diameters[E]&&s.bone_diameters[E]!=="").length>0?Object.fromEntries(Object.entries(s.bone_diameters).filter(([E,P])=>P&&P!=="")):null,bioimpedance:Object.keys(S).length>0?S:null,photos:s.photos.length>0?s.photos:null,results:{...D||{},...z&&{frame_size:z.size,frame_ratio:z.ratio},...w&&{somatotype:w}}};o(V,t?.id)},ft=()=>{m({weight:"",height:"",record_date:new Date().toISOString().split("T")[0],notes:"",circumferences:{ombro:"",peito:"",cintura:"",abdomen:"",quadril:"",braco_relaxado_e:"",braco_relaxado_d:"",braco_contraido_e:"",braco_contraido_d:"",coxa_proximal_e:"",coxa_proximal_d:"",coxa_medial_e:"",coxa_medial_d:"",panturrilha_e:"",panturrilha_d:""},skinfolds:{triceps:"",biceps:"",subescapular:"",suprailiaca:"",abdominal:"",coxa:"",panturrilha:""},bone_diameters:{punho:"",femur:"",umero:""},bioimpedance:{percent_gordura:"",percent_massa_magra:"",gordura_visceral:""},photos:[]}),O({}),d(null),y(null),_(null),C(null),a&&a()},bt=l=>l?l<18.5?{label:"Abaixo do peso",color:"text-blue-600"}:l<25?{label:"Peso normal",color:"text-green-600"}:l<30?{label:"Sobrepeso",color:"text-yellow-600"}:{label:"Obesidade",color:"text-red-600"}:null,gt=l=>l?l<.85?{label:"Baixo risco",color:"text-green-600"}:l<.95?{label:"Risco moderado",color:"text-yellow-600"}:{label:"Alto risco",color:"text-red-600"}:null,Ie=bt(x),Be=gt(f);return e.jsxs(L,{children:[e.jsx(K,{children:e.jsx(W,{className:"text-lg",children:t?"Editar Registro":"Novo Registro Antropométrico"})}),e.jsx(G,{children:e.jsxs("form",{onSubmit:ht,className:"space-y-6",children:[e.jsxs(Ct,{defaultValue:"basico",className:"w-full",children:[e.jsxs(St,{className:"grid w-full grid-cols-5",children:[e.jsx(ge,{value:"basico",children:"Básico"}),e.jsx(ge,{value:"circunferencias",children:"Circunferências"}),e.jsx(ge,{value:"dobras",children:"Dobras & Composição"}),e.jsx(ge,{value:"diametros",children:"Diâmetros Ósseos"}),e.jsx(ge,{value:"fotos",children:"Fotos"})]}),e.jsxs(je,{value:"basico",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:"weight",children:["Peso (kg) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(T,{id:"weight",name:"weight",type:"number",step:"0.1",min:"0",placeholder:h?.weight?`Último: ${h.weight} kg`:"Ex: 70.5",value:s.weight,onChange:H,className:N.weight?"border-destructive":"",disabled:i}),N.weight&&e.jsx("p",{className:"text-xs text-destructive",children:N.weight})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:"height",children:["Altura (cm) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(T,{id:"height",name:"height",type:"number",step:"0.1",min:"0",placeholder:h?.height?`Último: ${h.height} cm`:"Ex: 170",value:s.height,onChange:H,className:N.height?"border-destructive":"",disabled:i}),N.height&&e.jsx("p",{className:"text-xs text-destructive",children:N.height})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:"record_date",children:["Data ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(T,{id:"record_date",name:"record_date",type:"date",value:s.record_date,onChange:H,className:N.record_date?"border-destructive":"",disabled:i}),N.record_date&&e.jsx("p",{className:"text-xs text-destructive",children:N.record_date})]})]}),x&&e.jsxs(le,{className:"bg-muted/50",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx(ce,{children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-semibold",children:"IMC Calculado:"}),e.jsx("span",{className:"text-lg font-bold",children:x.toFixed(1)}),Ie&&e.jsx(me,{variant:"outline",className:Ie.color,children:Ie.label})]})})]}),u&&e.jsxs(le,{className:"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800",children:[e.jsx(ne,{className:"h-4 w-4 text-blue-600"}),e.jsx(ce,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Faixa de Peso Ideal (IMC 18.5-24.9):"}),e.jsxs("div",{className:"text-sm text-blue-800 dark:text-blue-200",children:[u.min.toFixed(1)," kg - ",u.max.toFixed(1)," kg"]}),u.current&&e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:["Peso atual: ",u.current.toFixed(1)," kg",u.current<u.min&&e.jsx("span",{className:"ml-2",children:"(Abaixo do ideal)"}),u.current>u.max&&e.jsx("span",{className:"ml-2",children:"(Acima do ideal)"}),u.current>=u.min&&u.current<=u.max&&e.jsx("span",{className:"ml-2",children:"(Dentro do ideal)"})]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"notes",children:"Observações (opcional)"}),e.jsx(kt,{id:"notes",name:"notes",rows:3,placeholder:"Adicione observações sobre o registro...",value:s.notes,onChange:H,disabled:i})]})]}),e.jsx(je,{value:"circunferencias",className:"space-y-6 mt-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4"}),"Tronco"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:["ombro","peito","cintura","abdomen","quadril"].map(l=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:`circ_${l}`,children:[l.charAt(0).toUpperCase()+l.slice(1).replace("_"," ")," (cm)"]}),e.jsx(T,{id:`circ_${l}`,type:"number",step:"0.1",min:"0",placeholder:"0.0",value:s.circumferences[l]||"",onChange:j=>R("circumferences",l,j.target.value),disabled:i})]},l))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Membros (E/D)"}),e.jsx("div",{className:"space-y-4",children:[{key:"braco_relaxado",label:"Braço Relaxado"},{key:"braco_contraido",label:"Braço Contraído"},{key:"coxa_proximal",label:"Coxa Proximal"},{key:"coxa_medial",label:"Coxa Medial"},{key:"panturrilha",label:"Panturrilha"}].map(({key:l,label:j})=>e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(M,{className:"col-span-3 text-xs text-muted-foreground",children:j}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:`circ_${l}_e`,children:"Esquerdo (cm)"}),e.jsx(T,{id:`circ_${l}_e`,type:"number",step:"0.1",min:"0",placeholder:"0.0",value:s.circumferences[`${l}_e`]||"",onChange:v=>R("circumferences",`${l}_e`,v.target.value),disabled:i})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:`circ_${l}_d`,children:"Direito (cm)"}),e.jsx(T,{id:`circ_${l}_d`,type:"number",step:"0.1",min:"0",placeholder:"0.0",value:s.circumferences[`${l}_d`]||"",onChange:v=>R("circumferences",`${l}_d`,v.target.value),disabled:i})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:`circ_${l}_media`,children:"Média (cm)"}),e.jsx(T,{id:`circ_${l}_media`,type:"number",step:"0.1",disabled:!0,value:s.circumferences[`${l}_e`]&&s.circumferences[`${l}_d`]?((parseFloat(s.circumferences[`${l}_e`])+parseFloat(s.circumferences[`${l}_d`]))/2).toFixed(1):"",className:"bg-muted"})]})]},l))})]}),f&&e.jsxs(le,{className:"bg-muted/50",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx(ce,{children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-semibold",children:"RCQ (Relação Cintura-Quadril):"}),e.jsx("span",{className:"text-lg font-bold",children:f.toFixed(2)}),Be&&e.jsx(me,{variant:"outline",className:Be.color,children:Be.label})]})})]})]})}),e.jsxs(je,{value:"dobras",className:"space-y-6 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"protocol",children:"Protocolo de Cálculo"}),e.jsxs(At,{value:g,onValueChange:oe,children:[e.jsx(Pt,{id:"protocol",children:e.jsx(Et,{placeholder:"Selecione o protocolo"})}),e.jsxs(Ft,{children:[e.jsx(Ae,{value:"pollock3",children:"Pollock 3 Dobras (Tríceps, Subescapular, Suprailíaca)"}),e.jsx(Ae,{value:"pollock7",children:"Pollock 7 Dobras (Peito, Axilar, Tríceps, Subescapular, Abdominal, Suprailíaca, Coxa)"}),e.jsx(Ae,{value:"weltman",children:"Weltman 4 Dobras (Tríceps, Bíceps, Subescapular, Suprailíaca)"}),e.jsx(Ae,{value:"bioimpedance",children:"Bioimpedância (Direto)"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[g==="pollock3"&&"Requer: Tríceps, Subescapular, Suprailíaca, Idade, Gênero",g==="pollock7"&&"Requer: Peito, Axilar, Tríceps, Subescapular, Abdominal, Suprailíaca, Coxa, Idade, Gênero",g==="weltman"&&"Requer: Tríceps, Bíceps, Subescapular, Suprailíaca, Idade, Gênero",g==="bioimpedance"&&"Use os valores de bioimpedância diretamente"]})]}),g!=="bioimpedance"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:[e.jsx(ar,{className:"w-4 h-4"}),"Dobras Cutâneas (mm)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[g==="pollock3"&&[{key:"triceps",label:"Tríceps",required:!0},{key:"subescapular",label:"Subescapular",required:!0},{key:"suprailiaca",label:"Suprailíaca",required:!0}].map(({key:l,label:j,required:v})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:`fold_${l}`,children:[j," (mm) ",v&&e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(T,{id:`fold_${l}`,type:"number",step:"0.1",min:"0",placeholder:"0.0",value:s.skinfolds[l]||"",onChange:S=>R("skinfolds",l,S.target.value),disabled:i})]},l)),g==="pollock7"&&[{key:"peito",label:"Peito",required:!0},{key:"axilar",label:"Axilar",required:!0},{key:"triceps",label:"Tríceps",required:!0},{key:"subescapular",label:"Subescapular",required:!0},{key:"abdominal",label:"Abdominal",required:!0},{key:"suprailiaca",label:"Suprailíaca",required:!0},{key:"coxa",label:"Coxa",required:!0}].map(({key:l,label:j,required:v})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:`fold_${l}`,children:[j," (mm) ",v&&e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(T,{id:`fold_${l}`,type:"number",step:"0.1",min:"0",placeholder:"0.0",value:s.skinfolds[l]||"",onChange:S=>R("skinfolds",l,S.target.value),disabled:i})]},l)),g==="weltman"&&[{key:"triceps",label:"Tríceps",required:!0},{key:"biceps",label:"Bíceps",required:!0},{key:"subescapular",label:"Subescapular",required:!0},{key:"suprailiaca",label:"Suprailíaca",required:!0}].map(({key:l,label:j,required:v})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:`fold_${l}`,children:[j," (mm) ",v&&e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(T,{id:`fold_${l}`,type:"number",step:"0.1",min:"0",placeholder:"0.0",value:s.skinfolds[l]||"",onChange:S=>R("skinfolds",l,S.target.value),disabled:i})]},l))]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold mb-3",children:"Bioimpedância"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(M,{htmlFor:"bio_percent_gordura",children:["% Gordura Corporal ",g==="bioimpedance"&&e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(T,{id:"bio_percent_gordura",type:"number",step:"0.1",min:"0",max:"100",placeholder:"0.0",value:s.bioimpedance.percent_gordura||"",onChange:l=>R("bioimpedance","percent_gordura",l.target.value),disabled:i})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"bio_percent_massa_magra",children:"% Massa Magra"}),e.jsx(T,{id:"bio_percent_massa_magra",type:"number",step:"0.1",min:"0",max:"100",placeholder:"0.0",value:s.bioimpedance.percent_massa_magra||"",onChange:l=>R("bioimpedance","percent_massa_magra",l.target.value),disabled:i})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"bio_gordura_visceral",children:"Gordura Visceral"}),e.jsx(T,{id:"bio_gordura_visceral",type:"number",step:"0.1",min:"0",placeholder:"0.0",value:s.bioimpedance.gordura_visceral||"",onChange:l=>R("bioimpedance","gordura_visceral",l.target.value),disabled:i})]})]})]}),e.jsxs(L,{className:"bg-gradient-to-br from-emerald-50 to-blue-50 dark:from-emerald-950/20 dark:to-blue-950/20 border-emerald-200 dark:border-emerald-800",children:[e.jsxs(K,{children:[e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5 text-emerald-600"}),"Resultados Calculados em Tempo Real"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Protocolo: ",g==="pollock3"?"Pollock 3 Dobras":g==="pollock7"?"Pollock 7 Dobras":g==="weltman"?"Weltman 4 Dobras":"Bioimpedância"]})]}),e.jsx(G,{children:D?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-1 p-3 bg-white/50 dark:bg-black/20 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Densidade Corporal"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-700 dark:text-emerald-300",children:D.body_density?.toFixed(4)||"N/A"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"g/cm³"})]}),e.jsxs("div",{className:"space-y-1 p-3 bg-white/50 dark:bg-black/20 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"% Gordura Corporal"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:[D.body_fat_percent?.toFixed(1)||"N/A","%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Percentual de gordura"})]}),e.jsxs("div",{className:"space-y-1 p-3 bg-white/50 dark:bg-black/20 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Massa Gorda"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:[D.fat_mass_kg?.toFixed(1)||"N/A"," kg"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Peso de gordura"})]}),e.jsxs("div",{className:"space-y-1 p-3 bg-white/50 dark:bg-black/20 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Massa Magra"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[D.lean_mass_kg?.toFixed(1)||"N/A"," kg"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Peso sem gordura"})]})]}),e.jsx("div",{className:"pt-4 border-t border-emerald-200 dark:border-emerald-800",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["*Cálculos baseados em ",g==="pollock3"?"Jackson & Pollock (1985) - 3 dobras":g==="pollock7"?"Jackson & Pollock (1985) - 7 dobras":g==="weltman"?"Weltman et al. (1988)":"Bioimpedância direta"," e equação de Siri (1961) para conversão de densidade em % de gordura."]})})]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Le,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Preencha os dados necessários para ver os resultados calculados"})]})})]}),!D&&g!=="bioimpedance"&&e.jsxs(le,{className:"bg-amber-50 dark:bg-amber-950/20 border-amber-200 dark:border-amber-800",children:[e.jsx(Le,{className:"h-4 w-4 text-amber-600"}),e.jsx(ce,{children:e.jsx("p",{className:"text-sm text-amber-900 dark:text-amber-100",children:"Preencha todas as dobras cutâneas necessárias para o protocolo selecionado e certifique-se de que o paciente tem idade e gênero cadastrados no perfil."})})]}),w&&e.jsxs(L,{className:"bg-gradient-to-br from-purple-50 to-indigo-50 dark:from-purple-950/20 dark:to-indigo-950/20 border-purple-200 dark:border-purple-800",children:[e.jsxs(K,{children:[e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5 text-purple-600"}),"Somatotipo (Heath-Carter)"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Classificação da composição corporal"})]}),e.jsx(G,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-1 text-center p-4 bg-red-50 dark:bg-red-950/20 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Endomorfia"}),e.jsx("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:w.endo}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gordura relativa"})]}),e.jsxs("div",{className:"space-y-1 text-center p-4 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mesomorfia"}),e.jsx("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:w.meso}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Massa muscular/óssea"})]}),e.jsxs("div",{className:"space-y-1 text-center p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ectomorfia"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:w.ecto}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Linearidade"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-purple-200 dark:border-purple-800",children:[e.jsx("p",{className:"text-sm font-semibold text-purple-900 dark:text-purple-100 mb-2",children:"Classificação:"}),e.jsx("p",{className:"text-lg font-bold text-purple-800 dark:text-purple-200",children:We(w.endo,w.meso,w.ecto)}),e.jsxs("p",{className:"text-xs text-purple-700 dark:text-purple-300 mt-2",children:["Coordenadas para Somatochart: X = ",w.x,", Y = ",w.y]})]})]})})]})]}),e.jsx(je,{value:"diametros",className:"space-y-6 mt-4",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4"}),"Diâmetros Ósseos (cm)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"bone_punho",children:"Punho (Estiloide) (cm)"}),e.jsx(T,{id:"bone_punho",type:"number",step:"0.1",min:"0",placeholder:"0.0",value:s.bone_diameters?.punho||"",onChange:l=>R("bone_diameters","punho",l.target.value),disabled:i}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Medida do processo estilóide do rádio"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"bone_femur",children:"Fêmur (Biepicondilar) (cm)"}),e.jsx(T,{id:"bone_femur",type:"number",step:"0.1",min:"0",placeholder:"0.0",value:s.bone_diameters?.femur||"",onChange:l=>R("bone_diameters","femur",l.target.value),disabled:i}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Largura biepicondilar do fêmur"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(M,{htmlFor:"bone_umero",children:"Úmero (Biepicondilar) (cm)"}),e.jsx(T,{id:"bone_umero",type:"number",step:"0.1",min:"0",placeholder:"0.0",value:s.bone_diameters?.umero||"",onChange:l=>R("bone_diameters","umero",l.target.value),disabled:i}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Largura biepicondilar do úmero"})]})]}),z&&e.jsxs(le,{className:"bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-800 mt-4",children:[e.jsx(ne,{className:"h-4 w-4 text-blue-600"}),e.jsx(ce,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold text-blue-900 dark:text-blue-100",children:"Compleição Óssea (Frame Size):"}),e.jsx("div",{className:"text-lg font-bold text-blue-800 dark:text-blue-200",children:z.label}),e.jsxs("div",{className:"text-xs text-blue-700 dark:text-blue-300",children:["Ratio Altura/Punho: ",z.ratio.toFixed(2)]})]})})]})]})}),e.jsx(je,{value:"fotos",className:"mt-4",children:e.jsx(mr,{recordId:t?.id||`temp-${Date.now()}`,initialPhotos:s.photos,onPhotosChange:$e})})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t",children:[e.jsxs(re,{type:"button",variant:"outline",onClick:ft,disabled:i,children:[e.jsx(st,{className:"w-4 h-4 mr-2"}),t?"Cancelar":"Limpar"]}),e.jsxs(re,{type:"submit",disabled:i,children:[e.jsx(Ot,{className:"w-4 h-4 mr-2"}),i?"Salvando...":t?"Atualizar":"Salvar"]})]})]})})]})},hr=({records:r=[],onEdit:t,onDelete:o,loading:a=!1})=>{const i=s=>s?s<18.5?{label:"Abaixo do peso",variant:"secondary"}:s<25?{label:"Peso normal",variant:"success"}:s<30?{label:"Sobrepeso",variant:"warning"}:{label:"Obesidade",variant:"destructive"}:{label:"N/A",variant:"outline"},n=(s,m)=>{if(!m)return null;const h=s-m;return Math.abs(h)<.1?{icon:zt,color:"text-gray-500",text:"Estável"}:h>0?{icon:yt,color:"text-red-500",text:`+${h.toFixed(1)} kg`}:{icon:It,color:"text-green-500",text:`${h.toFixed(1)} kg`}},c=s=>{try{return we(new Date(s),"dd 'de' MMMM 'de' yyyy",{locale:Fe})}catch{return s}};return a?e.jsx("div",{className:"border rounded-lg p-8 text-center text-muted-foreground",children:"Carregando registros..."}):r.length===0?e.jsxs("div",{className:"border rounded-lg p-8 text-center",children:[e.jsx("p",{className:"text-muted-foreground font-medium",children:"Nenhum registro encontrado"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Adicione o primeiro registro usando o formulário acima"})]}):e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(Dt,{children:[e.jsx(Rt,{children:e.jsxs(Ue,{children:[e.jsx(Q,{children:"Data"}),e.jsx(Q,{children:"Peso (kg)"}),e.jsx(Q,{children:"Altura (cm)"}),e.jsx(Q,{children:"IMC"}),e.jsx(Q,{children:"Classificação"}),e.jsx(Q,{children:"Tendência"}),e.jsx(Q,{children:"Observações"}),e.jsx(Q,{className:"text-right",children:"Ações"})]})}),e.jsx($t,{children:r.map((s,m)=>{const h=s.bmi||(s.height?s.weight/Math.pow(s.height/100,2):null),p=i(h),x=m<r.length-1?r[m+1].weight:null,d=n(s.weight,x),u=d?.icon;return e.jsxs(Ue,{children:[e.jsx(ee,{className:"font-medium",children:c(s.record_date)}),e.jsxs(ee,{children:[e.jsx("span",{className:"font-semibold",children:s.weight})," kg"]}),e.jsx(ee,{children:s.height?`${s.height} cm`:"N/A"}),e.jsx(ee,{children:h?e.jsx("span",{className:"font-semibold",children:h.toFixed(1)}):e.jsx("span",{className:"text-muted-foreground",children:"N/A"})}),e.jsx(ee,{children:e.jsx(me,{variant:p.variant,children:p.label})}),e.jsx(ee,{children:d&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(u,{className:`w-4 h-4 ${d.color}`}),e.jsx("span",{className:`text-sm ${d.color}`,children:d.text})]})}),e.jsx(ee,{className:"max-w-xs",children:s.notes?e.jsx("span",{className:"text-sm text-muted-foreground line-clamp-2",children:s.notes}):e.jsx("span",{className:"text-xs text-muted-foreground italic",children:"Sem observações"})}),e.jsx(ee,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(re,{variant:"ghost",size:"sm",onClick:()=>t(s),className:"h-8 w-8 p-0",children:e.jsx(sr,{className:"h-4 w-4"})}),e.jsx(re,{variant:"ghost",size:"sm",onClick:()=>o(s),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:e.jsx(vt,{className:"h-4 w-4"})})]})})]},s.id)})})]})})};function xe(r){"@babel/helpers - typeof";return xe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(r)}function fr(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function br(r,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,mt(a.key),a)}}function gr(r,t,o){return t&&br(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function jr(r,t,o){return t=De(t),vr(r,ct()?Reflect.construct(t,o||[],De(r).constructor):t.apply(r,o))}function vr(r,t){if(t&&(xe(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yr(r)}function yr(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ct(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ct=function(){return!!r})()}function De(r){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},De(r)}function Nr(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Ge(r,t)}function Ge(r,t){return Ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,i){return a.__proto__=i,a},Ge(r,t)}function dt(r,t,o){return t=mt(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function mt(r){var t=_r(r,"string");return xe(t)=="symbol"?t:t+""}function _r(r,t){if(xe(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var a=o.call(r,t);if(xe(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var ke=(function(r){function t(){return fr(this,t),jr(this,t,arguments)}return Nr(t,r),gr(t,[{key:"render",value:function(){return null}}])})(b.Component);dt(ke,"displayName","ZAxis");dt(ke,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var wr=["option","isActive"];function Ne(){return Ne=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a])}return r},Ne.apply(this,arguments)}function kr(r,t){if(r==null)return{};var o=Cr(r,t),a,i;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(r,a)&&(o[a]=r[a])}return o}function Cr(r,t){if(r==null)return{};var o={};for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a)){if(t.indexOf(a)>=0)continue;o[a]=r[a]}return o}function Sr(r){var t=r.option,o=r.isActive,a=kr(r,wr);return typeof t=="string"?b.createElement(Ze,Ne({option:b.createElement(qt,Ne({type:t},a)),isActive:o,shapeType:"symbols"},a)):b.createElement(Ze,Ne({option:t,isActive:o,shapeType:"symbols"},a))}function he(r){"@babel/helpers - typeof";return he=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},he(r)}function _e(){return _e=Object.assign?Object.assign.bind():function(r){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a])}return r},_e.apply(this,arguments)}function et(r,t){var o=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),o.push.apply(o,a)}return o}function q(r){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?et(Object(o),!0).forEach(function(a){te(r,a,o[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):et(Object(o)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(o,a))})}return r}function Ar(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function tt(r,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,pt(a.key),a)}}function Pr(r,t,o){return t&&tt(r.prototype,t),o&&tt(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r}function Er(r,t,o){return t=Re(t),Fr(r,ut()?Reflect.construct(t,o||[],Re(r).constructor):t.apply(r,o))}function Fr(r,t){if(t&&(he(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mr(r)}function Mr(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function ut(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ut=function(){return!!r})()}function Re(r){return Re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},Re(r)}function Or(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&Ve(r,t)}function Ve(r,t){return Ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,i){return a.__proto__=i,a},Ve(r,t)}function te(r,t,o){return t=pt(t),t in r?Object.defineProperty(r,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[t]=o,r}function pt(r){var t=Tr(r,"string");return he(t)=="symbol"?t:t+""}function Tr(r,t){if(he(r)!="object"||!r)return r;var o=r[Symbol.toPrimitive];if(o!==void 0){var a=o.call(r,t);if(he(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var ae=(function(r){function t(){var o;Ar(this,t);for(var a=arguments.length,i=new Array(a),n=0;n<a;n++)i[n]=arguments[n];return o=Er(this,t,[].concat(i)),te(o,"state",{isAnimationFinished:!1}),te(o,"handleAnimationEnd",function(){o.setState({isAnimationFinished:!0})}),te(o,"handleAnimationStart",function(){o.setState({isAnimationFinished:!1})}),te(o,"id",Ut("recharts-scatter-")),o}return Or(t,r),Pr(t,[{key:"renderSymbolsStatically",value:function(a){var i=this,n=this.props,c=n.shape,s=n.activeShape,m=n.activeIndex,h=qe(this.props,!1);return a.map(function(p,x){var d=m===x,u=d?s:c,y=q(q({},h),p);return $.createElement(ve,_e({className:"recharts-scatter-symbol",key:"symbol-".concat(p?.cx,"-").concat(p?.cy,"-").concat(p?.size,"-").concat(x)},Lt(i.props,p,x),{role:"img"}),$.createElement(Sr,_e({option:u,isActive:d,key:"symbol-".concat(x)},y)))})}},{key:"renderSymbolsWithAnimation",value:function(){var a=this,i=this.props,n=i.points,c=i.isAnimationActive,s=i.animationBegin,m=i.animationDuration,h=i.animationEasing,p=i.animationId,x=this.state.prevPoints;return $.createElement(Kt,{begin:s,duration:m,isActive:c,easing:h,from:{t:0},to:{t:1},key:"pie-".concat(p),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(d){var u=d.t,y=n.map(function(f,_){var k=x&&x[_];if(k){var C=Pe(k.cx,f.cx),N=Pe(k.cy,f.cy),O=Pe(k.size,f.size);return q(q({},f),{},{cx:C(u),cy:N(u),size:O(u)})}var g=Pe(0,f.size);return q(q({},f),{},{size:g(u)})});return $.createElement(ve,null,a.renderSymbolsStatically(y))})}},{key:"renderSymbols",value:function(){var a=this.props,i=a.points,n=a.isAnimationActive,c=this.state.prevPoints;return n&&i&&i.length&&(!c||!Wt(c,i))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(i)}},{key:"renderErrorBar",value:function(){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,n=i.points,c=i.xAxis,s=i.yAxis,m=i.children,h=at(m,Gt);return h?h.map(function(p,x){var d=p.props,u=d.direction,y=d.dataKey;return $.cloneElement(p,{key:"".concat(u,"-").concat(y,"-").concat(n[x]),data:n,xAxis:c,yAxis:s,layout:u==="x"?"vertical":"horizontal",dataPointFormatter:function(_,k){return{x:_.cx,y:_.cy,value:u==="x"?+_.node.x:+_.node.y,errorVal:Ee(_,k)}}})}):null}},{key:"renderLine",value:function(){var a=this.props,i=a.points,n=a.line,c=a.lineType,s=a.lineJointType,m=qe(this.props,!1),h=qe(n,!1),p,x;if(c==="joint")p=i.map(function(N){return{x:N.cx,y:N.cy}});else if(c==="fitting"){var d=Vt(i),u=d.xmin,y=d.xmax,f=d.a,_=d.b,k=function(O){return f*O+_};p=[{x:u,y:k(u)},{x:y,y:k(y)}]}var C=q(q(q({},m),{},{fill:"none",stroke:m&&m.fill},h),{},{points:p});return $.isValidElement(n)?x=$.cloneElement(n,C):Ht(n)?x=n(C):x=$.createElement(Xt,_e({},C,{type:s})),$.createElement(ve,{className:"recharts-scatter-line",key:"recharts-scatter-line"},x)}},{key:"render",value:function(){var a=this.props,i=a.hide,n=a.points,c=a.line,s=a.className,m=a.xAxis,h=a.yAxis,p=a.left,x=a.top,d=a.width,u=a.height,y=a.id,f=a.isAnimationActive;if(i||!n||!n.length)return null;var _=this.state.isAnimationFinished,k=Nt("recharts-scatter",s),C=m&&m.allowDataOverflow,N=h&&h.allowDataOverflow,O=C||N,g=de(y)?this.id:y;return $.createElement(ve,{className:k,clipPath:O?"url(#clipPath-".concat(g,")"):null},C||N?$.createElement("defs",null,$.createElement("clipPath",{id:"clipPath-".concat(g)},$.createElement("rect",{x:C?p:p-d/2,y:N?x:x-u/2,width:C?d:d*2,height:N?u:u*2}))):null,c&&this.renderLine(),this.renderErrorBar(),$.createElement(ve,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!f||_)&&Yt.renderCallByParent(this.props,n))}}],[{key:"getDerivedStateFromProps",value:function(a,i){return a.animationId!==i.prevAnimationId?{prevAnimationId:a.animationId,curPoints:a.points,prevPoints:i.curPoints}:a.points!==i.curPoints?{curPoints:a.points}:null}}])})(b.PureComponent);te(ae,"displayName","Scatter");te(ae,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!Zt.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});te(ae,"getComposedData",function(r){var t=r.xAxis,o=r.yAxis,a=r.zAxis,i=r.item,n=r.displayedData,c=r.xAxisTicks,s=r.yAxisTicks,m=r.offset,h=i.props.tooltipType,p=at(i.props.children,ot),x=de(t.dataKey)?i.props.dataKey:t.dataKey,d=de(o.dataKey)?i.props.dataKey:o.dataKey,u=a&&a.dataKey,y=a?a.range:ke.defaultProps.range,f=y&&y[0],_=t.scale.bandwidth?t.scale.bandwidth():0,k=o.scale.bandwidth?o.scale.bandwidth():0,C=n.map(function(N,O){var g=Ee(N,x),oe=Ee(N,d),D=!de(u)&&Ee(N,u)||"-",Z=[{name:de(t.dataKey)?i.props.name:t.name||t.dataKey,unit:t.unit||"",value:g,payload:N,dataKey:x,type:h},{name:de(o.dataKey)?i.props.name:o.name||o.dataKey,unit:o.unit||"",value:oe,payload:N,dataKey:d,type:h}];D!=="-"&&Z.push({name:a.name||a.dataKey,unit:a.unit||"",value:D,payload:N,dataKey:u,type:h});var z=Je({axis:t,ticks:c,bandSize:_,entry:N,index:O,dataKey:x}),A=Je({axis:o,ticks:s,bandSize:k,entry:N,index:O,dataKey:d}),w=D!=="-"?a.scale(D):f,F=Math.sqrt(Math.max(w,0)/Math.PI);return q(q({},N),{},{cx:z,cy:A,x:z-F,y:A-F,xAxis:t,yAxis:o,zAxis:a,width:2*F,height:2*F,size:w,node:{x:g,y:oe,z:D},tooltipPayload:Z,tooltipPosition:{x:z,y:A},payload:N},p&&p[O]&&p[O].props)});return q({points:C},m)});var xt=it({chartName:"ScatterChart",GraphicalChild:ae,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:ue},{axisType:"yAxis",AxisComp:pe},{axisType:"zAxis",AxisComp:ke}],formatAxisMap:nt}),Dr=it({chartName:"ComposedChart",GraphicalChild:[ye,lt,Jt,ae],axisComponents:[{axisType:"xAxis",AxisComp:ue},{axisType:"yAxis",AxisComp:pe},{axisType:"zAxis",AxisComp:ke}],formatAxisMap:nt});const Rr=({data:r=[]})=>{if(r.length===0)return e.jsxs(L,{children:[e.jsxs(K,{children:[e.jsx(W,{children:"Evolução de IMC"}),e.jsx(U,{children:"Acompanhamento do Índice de Massa Corporal"})]}),e.jsx(G,{children:e.jsx("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"Sem dados para exibir o gráfico"})})]});const t=r.filter(m=>m.bmi||m.calculatedBmi).map(m=>({date:we(new Date(m.record_date),"dd/MM/yy"),fullDate:we(new Date(m.record_date),"dd 'de' MMM",{locale:Fe}),bmi:parseFloat((m.bmi||m.calculatedBmi).toFixed(1)),originalDate:m.record_date}));if(t.length===0)return e.jsxs(L,{children:[e.jsxs(K,{children:[e.jsx(W,{children:"Evolução de IMC"}),e.jsx(U,{children:"Acompanhamento do Índice de Massa Corporal"})]}),e.jsx(G,{children:e.jsx("div",{className:"h-[300px] flex items-center justify-center text-muted-foreground",children:"Sem dados suficientes para calcular IMC"})})]});const o=t[0]?.bmi,a=t[t.length-1]?.bmi,i=a-o,n=m=>m<18.5?{label:"Abaixo do peso",variant:"secondary",color:"#3b82f6"}:m<25?{label:"Peso normal",variant:"success",color:"#10b981"}:m<30?{label:"Sobrepeso",variant:"warning",color:"#f59e0b"}:{label:"Obesidade",variant:"destructive",color:"#ef4444"},c=n(a),s=({active:m,payload:h})=>{if(m&&h&&h.length){const p=h[0].value,x=n(p);return e.jsxs("div",{className:"bg-background border border-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"text-sm font-semibold",children:h[0].payload.fullDate}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["IMC: ",e.jsx("span",{className:"font-bold text-foreground",children:p})]}),e.jsx(me,{variant:x.variant,className:"mt-1",children:x.label})]})}return null};return e.jsxs(L,{children:[e.jsx(K,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{children:"Evolução de IMC"}),e.jsx(U,{children:"Índice de Massa Corporal ao longo do tempo"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"IMC Atual"}),e.jsx("p",{className:"text-2xl font-bold",children:a}),e.jsx(me,{variant:c.variant,className:"mt-1",children:c.label})]})]})}),e.jsxs(G,{children:[e.jsx(Me,{width:"100%",height:300,children:e.jsxs(Dr,{data:t,margin:{top:5,right:20,left:0,bottom:5},children:[e.jsx(Te,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(ue,{dataKey:"date",tick:{fontSize:12},className:"text-muted-foreground"}),e.jsx(pe,{domain:[16,35],tick:{fontSize:12},className:"text-muted-foreground",label:{value:"IMC",angle:-90,position:"insideLeft",fontSize:12}}),e.jsx(Oe,{content:e.jsx(s,{})}),e.jsx(Ke,{}),e.jsx(se,{y:18.5,stroke:"#3b82f6",strokeDasharray:"3 3",label:{value:"Abaixo",position:"insideTopLeft",fontSize:10}}),e.jsx(se,{y:25,stroke:"#10b981",strokeDasharray:"3 3",label:{value:"Normal",position:"insideTopLeft",fontSize:10}}),e.jsx(se,{y:30,stroke:"#f59e0b",strokeDasharray:"3 3",label:{value:"Sobrepeso",position:"insideTopLeft",fontSize:10}}),e.jsx(lt,{type:"monotone",dataKey:"bmi",fill:c.color,fillOpacity:.1,stroke:"none"}),e.jsx(ye,{type:"monotone",dataKey:"bmi",name:"IMC",stroke:c.color,strokeWidth:2,dot:{fill:c.color,r:4},activeDot:{r:6}})]})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Primeiro"}),e.jsx("p",{className:"text-lg font-semibold",children:o})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Atual"}),e.jsx("p",{className:"text-lg font-semibold",children:a})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Variação"}),e.jsxs("p",{className:`text-lg font-semibold ${i>=0?"text-red-600":"text-green-600"}`,children:[i>=0?"+":"",i.toFixed(1)]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2 font-semibold",children:"Classificação IMC:"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-blue-500"}),e.jsxs("span",{children:["< 18.5"," Abaixo"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-green-500"}),e.jsx("span",{children:"18.5-25 Normal"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-yellow-500"}),e.jsx("span",{children:"25-30 Sobrepeso"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-red-500"}),e.jsxs("span",{children:["> 30"," Obesidade"]})]})]})]})]})]})};function $r({data:r=[]}){const t=b.useMemo(()=>!r||r.length===0?[]:r.filter(n=>n.weight&&n.record_date).map(n=>{const c=new Date(n.record_date),s=parseFloat(n.weight)||0,m=n.results||{},h=m.body_fat_percent||null,p=m.lean_mass_kg||null,x=m.fat_mass_kg||null;let d=p,u=x;if(!p&&h)u=s*h/100,d=s-u;else if(!p&&n.bioimpedance?.percent_gordura){const y=parseFloat(n.bioimpedance.percent_gordura);u=s*y/100,d=s-u}return{date:we(c,"dd/MM/yyyy",{locale:Fe}),dateValue:c,weight:s.toFixed(1),leanMass:d?d.toFixed(1):null,fatMass:u?u.toFixed(1):null}}).sort((n,c)=>n.dateValue-c.dateValue),[r]);if(t.length===0)return e.jsxs(L,{children:[e.jsxs(K,{children:[e.jsx(W,{children:"Composição Corporal"}),e.jsx(U,{children:"Evolução de peso, massa magra e massa gorda"})]}),e.jsx(G,{children:e.jsx("div",{className:"flex items-center justify-center h-[300px] text-muted-foreground",children:e.jsx("p",{children:"Nenhum dado disponível para exibir"})})})]});const o=t.some(n=>n.leanMass!==null||n.fatMass!==null),a=b.useMemo(()=>!r||r.length===0?[]:r.filter(n=>n.results?.somatotype).map(n=>{const c=n.results.somatotype,s=new Date(n.record_date);return{date:we(s,"dd/MM/yyyy",{locale:Fe}),dateValue:s,x:c.x||c.ecto-c.endo,y:c.y||2*c.meso-(c.endo+c.ecto),endo:c.endo,meso:c.meso,ecto:c.ecto}}).sort((n,c)=>n.dateValue-c.dateValue),[r]),i=a.length>0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs(K,{children:[e.jsx(W,{children:"Composição Corporal"}),e.jsx(U,{children:"Evolução de peso, massa magra e massa gorda ao longo do tempo"})]}),e.jsxs(G,{children:[e.jsx(Me,{width:"100%",height:400,children:e.jsxs(Qt,{data:t,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(Te,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(ue,{dataKey:"date",className:"text-xs",tick:{fill:"hsl(var(--muted-foreground))"},angle:-45,textAnchor:"end",height:80}),e.jsx(pe,{className:"text-xs",tick:{fill:"hsl(var(--muted-foreground))"},label:{value:"Peso (kg)",angle:-90,position:"insideLeft"}}),e.jsx(Oe,{contentStyle:{backgroundColor:"hsl(var(--popover))",border:"1px solid hsl(var(--border))",borderRadius:"8px"},formatter:(n,c)=>n===null||n==="null"?["N/A",c]:[`${n} kg`,c]}),e.jsx(Ke,{formatter:n=>({weight:"Peso Total",leanMass:"Massa Magra",fatMass:"Massa Gorda"})[n]||n}),e.jsx(ye,{type:"monotone",dataKey:"weight",stroke:"#ffffff",strokeWidth:2,dot:{fill:"#ffffff",r:4},name:"weight"}),o&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{type:"monotone",dataKey:"leanMass",stroke:"#10b981",strokeWidth:2,dot:{fill:"#10b981",r:4},strokeDasharray:"5 5",name:"leanMass"}),e.jsx(ye,{type:"monotone",dataKey:"fatMass",stroke:"#ef4444",strokeWidth:2,dot:{fill:"#ef4444",r:4},strokeDasharray:"5 5",name:"fatMass"})]})]})}),!o&&e.jsx("div",{className:"mt-4 text-center text-sm text-muted-foreground",children:e.jsx("p",{children:"Preencha dados de composição corporal (dobras cutâneas ou bioimpedância) para visualizar massa magra e massa gorda."})})]})]}),i&&e.jsxs(L,{children:[e.jsxs(K,{children:[e.jsx(W,{children:"Somatochart (Heath-Carter)"}),e.jsx(U,{children:"Visualização do somatotipo ao longo do tempo. Cada ponto representa um registro."})]}),e.jsxs(G,{children:[e.jsx(Me,{width:"100%",height:400,children:e.jsxs(xt,{margin:{top:20,right:20,bottom:60,left:60},children:[e.jsx(Te,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(ue,{type:"number",dataKey:"x",name:"X",domain:[-8,8],label:{value:"Ectomorfia - Endomorfia",position:"insideBottom",offset:-5},className:"text-xs",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(pe,{type:"number",dataKey:"y",name:"Y",domain:[-8,8],label:{value:"2×Mesomorfia - (Endomorfia + Ectomorfia)",angle:-90,position:"insideLeft"},className:"text-xs",tick:{fill:"hsl(var(--muted-foreground))"}}),e.jsx(Oe,{cursor:{strokeDasharray:"3 3"},contentStyle:{backgroundColor:"hsl(var(--popover))",border:"1px solid hsl(var(--border))",borderRadius:"8px"},formatter:(n,c,s)=>c==="x"?[`X: ${s.payload.x.toFixed(2)}`,"Coordenada X"]:c==="y"?[`Y: ${s.payload.y.toFixed(2)}`,"Coordenada Y"]:c==="endo"?[`Endo: ${s.payload.endo}`,"Endomorfia"]:c==="meso"?[`Meso: ${s.payload.meso}`,"Mesomorfia"]:c==="ecto"?[`Ecto: ${s.payload.ecto}`,"Ectomorfia"]:[n,c]}),e.jsx(Ke,{}),e.jsx(se,{x:0,stroke:"#888",strokeDasharray:"2 2"}),e.jsx(se,{y:0,stroke:"#888",strokeDasharray:"2 2"}),e.jsx(ae,{name:"Somatotipo",data:a,fill:"#8b5cf6",children:a.map((n,c)=>e.jsx("circle",{cx:n.x,cy:n.y,r:6,fill:"#8b5cf6",stroke:"#fff",strokeWidth:2},c))})]})}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-center gap-6 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{children:"Endomorfia (Gordura)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{children:"Mesomorfia (Músculo)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{children:"Ectomorfia (Linearidade)"})]})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:"O gráfico mostra a evolução do somatotipo. Pontos mais à esquerda indicam maior endomorfia, à direita maior ectomorfia, e acima maior mesomorfia."})]})]})]})]})}const zr=({somatotype:r,className:t=""})=>{if(!r||!r.x||!r.y)return e.jsxs(L,{className:t,children:[e.jsxs(K,{children:[e.jsx(W,{className:"text-lg",children:"Somatotipo (Heath-Carter)"}),e.jsx(U,{children:"Gráfico de classificação corporal"})]}),e.jsx(G,{children:e.jsx("div",{className:"h-[400px] flex items-center justify-center text-muted-foreground border-2 border-dashed rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm",children:"Preencha os dados necessários para calcular o somatotipo"}),e.jsxs("p",{className:"text-xs mt-2 text-muted-foreground",children:["Requer: Altura, Peso, Dobras (Tríceps, Subescapular, Suprailíaca),",e.jsx("br",{}),"Diâmetros Ósseos (Úmero, Fêmur) e Circunferências (Braço, Panturrilha)"]})]})})})]});const o=[{x:r.x,y:r.y}],a=({active:n,payload:c})=>n&&c&&c.length?(c[0].payload,e.jsxs("div",{className:"bg-background border border-border rounded-lg p-3 shadow-lg",children:[e.jsx("p",{className:"font-semibold text-sm mb-2",children:"Somatotipo"}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Endomorfia:"})," ",r.endo]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Mesomorfia:"})," ",r.meso]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Ectomorfia:"})," ",r.ecto]}),e.jsxs("p",{className:"pt-2 border-t border-border mt-2",children:[e.jsx("span",{className:"font-medium",children:"Classificação:"})," ",We(r.endo,r.meso,r.ecto)]})]})]})):null,i=()=>{const{endo:n,meso:c,ecto:s}=r,m=Math.max(n,c,s);return m===n?"#ef4444":m===c?"#22c55e":"#3b82f6"};return e.jsxs(L,{className:t,children:[e.jsxs(K,{children:[e.jsxs(W,{className:"text-lg flex items-center justify-between",children:[e.jsx("span",{children:"Somatotipo (Heath-Carter)"}),e.jsx(me,{variant:"outline",className:"ml-2",children:We(r.endo,r.meso,r.ecto)})]}),e.jsx(U,{children:"Gráfico de classificação corporal baseado no método Heath-Carter (1967)"})]}),e.jsx(G,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Me,{width:"100%",height:400,children:e.jsxs(xt,{margin:{top:20,right:20,bottom:20,left:20},data:o,children:[e.jsx(Te,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(ue,{type:"number",dataKey:"x",name:"X",domain:[-8,8],ticks:[-8,-6,-4,-2,0,2,4,6,8],label:{value:"Ectomorfia - Endomorfia",position:"insideBottom",offset:-10,style:{fontSize:12}},className:"text-muted-foreground"}),e.jsx(pe,{type:"number",dataKey:"y",name:"Y",domain:[-5,10],ticks:[-5,-2.5,0,2.5,5,7.5,10],label:{value:"2×Mesomorfia - (Endomorfia + Ectomorfia)",angle:-90,position:"insideLeft",style:{fontSize:12}},className:"text-muted-foreground"}),e.jsx(Oe,{content:e.jsx(a,{})}),e.jsx(se,{x:0,stroke:"#888",strokeDasharray:"2 2"}),e.jsx(se,{y:0,stroke:"#888",strokeDasharray:"2 2"}),e.jsx(ae,{name:"Somatotipo",data:o,fill:i(),children:o.map((n,c)=>e.jsx(ot,{fill:i()},`cell-${c}`))})]})}),e.jsx("div",{className:"absolute top-4 left-4 text-xs font-semibold text-red-600 dark:text-red-400",children:"Endomorfo"}),e.jsx("div",{className:"absolute top-4 right-4 text-xs font-semibold text-blue-600 dark:text-blue-400",children:"Ectomorfo"}),e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-xs font-semibold text-green-600 dark:text-green-400",children:"Mesomorfo"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t",children:[e.jsxs("div",{className:"text-center p-3 bg-red-50 dark:bg-red-950/20 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Endomorfia"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:r.endo}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Gordura relativa"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Mesomorfia"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:r.meso}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Massa muscular/óssea"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Ectomorfia"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:r.ecto}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Linearidade"})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center pt-2",children:["Coordenadas: X = ",r.x,", Y = ",r.y]})]})})]})},ms=()=>{const{patientId:r}=_t(),t=wt(),{toast:o}=rt(),[a,i]=b.useState(!0),[n,c]=b.useState(!1),[s,m]=b.useState([]),[h,p]=b.useState([]),[x,d]=b.useState(null),[u,y]=b.useState(null),[f,_]=b.useState(null),[k,C]=b.useState(null),[N,O]=b.useState(null),g=b.useCallback(async()=>{i(!0),y(null);try{const{data:A}=await Y.from("user_profiles").select("gender, birth_date").eq("id",r).single();A&&O(A);const[w,F]=await Promise.all([or(r,{limit:50}),ir(r)]);if(w.error)throw console.error("Erro ao buscar registros:",w.error),new Error("Erro ao buscar registros antropométricos");if(F.error)throw console.error("Erro ao buscar dados de gráficos:",F.error),new Error("Erro ao buscar dados de gráficos");if(m(w.data||[]),p(F.data||[]),w.data&&w.data.length>0){const H=w.data[0];if(_(H),H.height&&H.weight){const R=parseFloat(H.height)/100,$e=18.5*Math.pow(R,2),ze=24.9*Math.pow(R,2);C({min:$e,max:ze,current:parseFloat(H.weight)})}else C(null)}else _(null),C(null)}catch(A){console.error("Erro ao carregar dados:",A);const w=A.message||"Erro ao carregar dados";y(w),o({title:"Erro",description:w,variant:"destructive"})}finally{i(!1)}},[r,o]);b.useEffect(()=>{g()},[g]);const oe=async(A,w=null)=>{c(!0);try{let F;if(w?F=await lr(w,A):F=await nr(A),F.error)throw F.error;o({title:"Sucesso",description:w?"Registro atualizado com sucesso":"Registro criado com sucesso",variant:"success"}),d(null),await g()}catch(F){console.error("Erro ao salvar registro:",F),o({title:"Erro",description:F.message||"Não foi possível salvar o registro",variant:"destructive"})}finally{c(!1)}},D=A=>{d(A),window.scrollTo({top:0,behavior:"smooth"})},Z=async A=>{if(window.confirm("Tem certeza que deseja excluir este registro?"))try{const w=await cr(A.id);if(w.error)throw w.error;o({title:"Sucesso",description:"Registro excluído com sucesso",variant:"success"}),await g()}catch(w){console.error("Erro ao deletar registro:",w),o({title:"Erro",description:w.message||"Não foi possível excluir o registro",variant:"destructive"})}},z=()=>{d(null)};return e.jsxs("div",{className:"container mx-auto p-4 sm:p-6 max-w-7xl space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(re,{variant:"ghost",size:"sm",onClick:()=>t(`/nutritionist/patients/${r}/hub`),className:"-ml-2 text-[#5f6f52] hover:text-[#5f6f52] hover:bg-[#5f6f52]/10",children:[e.jsx(er,{className:"w-4 h-4 mr-1"}),"Voltar"]}),e.jsxs(re,{variant:"outline",size:"sm",onClick:g,disabled:a,className:"flex-shrink-0",children:[e.jsx(tr,{className:`w-4 h-4 mr-2 ${a?"animate-spin":""}`}),e.jsx("span",{className:"hidden sm:inline",children:"Atualizar"})]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(rr,{className:"w-6 h-6 sm:w-8 sm:h-8 text-[#5f6f52]"}),e.jsx("span",{className:"truncate",children:"Avaliação Antropométrica"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Acompanhamento de peso, altura e IMC"}),f&&f.weight&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Peso atual:"}),e.jsxs("span",{className:"font-semibold",children:[f.weight," kg"]})]}),k&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Peso ideal:"}),e.jsxs("span",{className:"font-semibold text-[#5f6f52]",children:[k.min.toFixed(1)," - ",k.max.toFixed(1)," kg"]}),k.current&&e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${k.current<k.min?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300":k.current>k.max?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300":"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300"}`,children:k.current<k.min?"Abaixo":k.current>k.max?"Acima":"Ideal"})]})]})]})]}),u&&e.jsxs(le,{variant:"destructive",children:[e.jsx(Le,{className:"h-4 w-4"}),e.jsx(ce,{children:u})]}),e.jsx(xr,{patientId:r,initialData:x,onSubmit:oe,onCancel:z,loading:n,patientGender:N?.gender,patientBirthDate:N?.birth_date}),e.jsxs("div",{className:"space-y-6",children:[s.some(A=>A.results||A.bioimpedance)&&e.jsx($r,{data:s}),f?.results?.somatotype&&e.jsx(zr,{somatotype:f.results.somatotype}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Bt,{data:h}),e.jsx(Rr,{data:h})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Histórico de Registros"}),e.jsx(hr,{records:s,onEdit:D,onDelete:Z,loading:a})]})]})};export{ms as default};
