import{q as ue,u as ge,r as x,j as e,C as p,e as N,B as w,U as ie,v as T,T as H,O as je,H as ne,b as F,I as q,E as L,ap as E,aq as be,K as oe,J as pe,c as _,d as S,L as R,ar as O,as as K,G as Ne,s as W,at as X,w as Q,S as ve,au as we,av as ye,g as I}from"./index-Cl9S2_vK.js";import{T as Ce,a as Ae,b as z,c as G}from"./tabs-C2iurRVm.js";import{b as ke,c as _e}from"./patient-queries-BiDm2yau.js";import{B as D}from"./badge-DPJEOXlY.js";import{P as Pe}from"./pen-square-BteyrFgO.js";import{M as Se}from"./mail-dMP3ZHqe.js";import{P as De,M as Me}from"./phone-D5gWdrRV.js";import{W as ce}from"./weight-CsZAqTLq.js";import{A as U}from"./activity-B8cihxwR.js";import{d as Ee}from"./differenceInYears-JHOpod1y.js";import{P as Le}from"./progress-Hy44xw5P.js";import{B as V,R as Fe}from"./refresh-cw-449M6kAo.js";import{C as B}from"./calculator-BdlGdxnE.js";import{C as de}from"./check-circle-2-Cpln7o88.js";import{A}from"./arrow-right-CjmXL75M.js";import{S as ee,a as se,b as te,c as ae,d as M}from"./select-DVIkm2mv.js";import{F as Te}from"./filter-DzDouWgV.js";import{s as Be}from"./subMonths-BLetOafQ.js";import{M as Re}from"./message-square-C-ORpudX.js";import{C as $e}from"./clock-DpFyvVKk.js";import{F as $}from"./flame-88bmHynt.js";import{g as ze}from"./anamnesis-queries-C1nreQvl.js";import{g as Ge}from"./lab-results-queries-DZIuezl-.js";import{A as Z}from"./alert-circle--FqPo4fT.js";import{D as J}from"./droplet-ELMZZ7Pu.js";import{T as me}from"./trending-down-RN1wbuZQ.js";import{R as He}from"./ruler-CwIAZpVo.js";import{C as Y}from"./camera-5649FDKA.js";import{getActiveMealPlan as qe}from"./meal-plan-queries-CpEkmQ-d.js";import{c as We,g as Ve}from"./food-diary-queries-DSkeXQnQ.js";import{A as xe,a as he}from"./alert-Cz0d9f0N.js";import{g as Ue,a as Je,b as Ye}from"./goals-queries-BEthkKAE.js";import{S as k}from"./skeleton-CsLrLeHJ.js";import{A as re}from"./arrow-left-CUOJhKUw.js";import{S as Ke}from"./stethoscope-BAKp2bP3.js";import{H as Qe}from"./heart-DnTBSUyn.js";import"./mealTranslations-B1KHhmEq.js";import"./extends-CF3RwP-h.js";import"./addMonths-D_HdIz3j.js";const le=ue("BookHeart",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["path",{d:"M16 8.2C16 7 15 6 13.8 6c-.8 0-1.4.3-1.8.9-.4-.6-1-.9-1.8-.9C9 6 8 7 8 8.2c0 .6.3 1.2.7 1.6h0C10 11.1 12 13 12 13s2-1.9 3.3-3.1h0c.4-.4.7-1 .7-1.7z",key:"1dlbw1"}]]),Xe=s=>{const{user:g}=ge(),[d,a]=x.useState(!0),[o,f]=x.useState(null),[i,m]=x.useState(null),[v,b]=x.useState(null),[u,h]=x.useState({}),[n,l]=x.useState([]),[c,t]=x.useState(!1),r=x.useCallback(async()=>{if(!(!s||!g?.id)){a(!0),f(null);try{const{data:j,error:P}=await ke(s,g.id);if(P)throw P;j?(m(j.profile),b(j.metrics),h(j.modulesStatus)):f(new Error("Paciente n√£o encontrado"))}catch(j){console.error("Erro ao carregar resumo do paciente:",j),f(j),m(null)}finally{a(!1)}}},[s,g?.id]),C=x.useCallback(async()=>{if(s){t(!0);try{const{data:j,error:P}=await _e(s,100);if(P)throw P;l(j||[])}catch(j){console.error("Erro ao carregar atividades:",j),l([])}finally{t(!1)}}},[s]),y=x.useCallback(async()=>{await Promise.all([r(),C()])},[r,C]);return x.useEffect(()=>{r()},[r]),x.useEffect(()=>{i&&C()},[i,C]),{loading:d,error:o,patientData:i,latestMetrics:v,modulesStatus:u,activities:n,activitiesLoading:c,refresh:y,loadActivities:C}},Ze=({patientData:s,latestMetrics:g,onEditProfile:d,onOpenChat:a,onScheduleAppointment:o})=>{const f=t=>{if(!t)return null;try{const r=new Date(t);return r.setHours(r.getHours()+4),Ee(new Date,r)}catch{return null}},i=(t,r)=>{if(!t||!r||r===0)return null;const C=r/100;return(t/(C*C)).toFixed(1)},m=t=>t?t<18.5?{label:"Abaixo do peso",variant:"destructive"}:t<25?{label:"Peso normal",variant:"success"}:t<30?{label:"Sobrepeso",variant:"warning"}:{label:"Obesidade",variant:"destructive"}:{label:"N/A",variant:"secondary"},v=t=>{if(!t)return"N√£o informado";try{return je(new Date(t),"dd/MM/yyyy",{locale:ne})}catch{return"Data inv√°lida"}},b=t=>{if(!t)return"N√£o informado";const r=t.replace(/\D/g,"");return r.length===11?`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7)}`:t},u=t=>{if(!t)return null;if(typeof t=="string")return t;const r=[];return t.street&&r.push(t.street),t.number&&r.push(t.number),t.neighborhood&&r.push(t.neighborhood),t.city&&r.push(t.city),t.state&&r.push(t.state),t.zipcode&&r.push(t.zipcode),r.length>0?r.join(", "):null},h=t=>t?{lose:"Perder Peso",gain:"Ganhar Peso",maintain:"Manter Peso",muscle:"Ganhar Massa Muscular",health:"Sa√∫de e Bem-estar"}[t.toLowerCase()]||t:"N√£o definido",n=f(s?.birth_date),l=i(g?.weight,g?.height),c=m(l);return e.jsx(p,{className:"bg-card shadow-lg border-border relative",children:e.jsxs(N,{className:"p-6",children:[e.jsx(w,{variant:"ghost",size:"icon",onClick:d,className:"md:hidden absolute top-4 right-4 h-8 w-8 rounded-full hover:bg-primary/10",children:e.jsx(Pe,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 mb-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-24 h-24 bg-secondary rounded-full flex items-center justify-center font-bold text-primary overflow-hidden border-4 border-primary/20",children:s?.avatar_url?e.jsx("img",{src:s.avatar_url,alt:s.name,className:"w-full h-full object-cover"}):e.jsx(ie,{className:"w-12 h-12 text-primary/70"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2 pr-10",children:s?.name||"Paciente"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Se,{className:"w-4 h-4"}),e.jsx("span",{children:s?.email||"N√£o informado"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(De,{className:"w-4 h-4"}),e.jsx("span",{children:b(s?.phone)})]}),u(s?.address)&&e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground md:col-span-2",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx("span",{className:"truncate",children:u(s.address)})]})]})]}),e.jsxs("div",{className:"hidden md:flex flex-row gap-2 items-start",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:d,className:"whitespace-nowrap",children:"Editar Perfil"}),e.jsx(w,{variant:"outline",size:"sm",onClick:a,className:"whitespace-nowrap",children:"Abrir Chat"}),e.jsx(w,{variant:"default",size:"sm",onClick:o,className:"whitespace-nowrap",children:"Agendar Consulta"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-background p-4 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(T,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Idade"})]}),e.jsx("p",{className:"text-xl font-bold text-foreground",children:n?`${n} anos`:"N/A"})]}),e.jsxs("div",{className:"bg-background p-4 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ce,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Peso Atual"})]}),e.jsx("p",{className:"text-xl font-bold text-foreground",children:g?.weight?`${g.weight} kg`:"N/A"})]}),e.jsxs("div",{className:"bg-background p-4 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(U,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"IMC"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-xl font-bold text-foreground",children:l||"N/A"}),l&&e.jsx(D,{variant:c.variant,className:"text-xs",children:c.label})]})]}),e.jsxs("div",{className:"bg-background p-4 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(H,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Objetivo"})]}),e.jsx("p",{className:"text-sm font-semibold text-foreground truncate",children:h(s?.goal)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-background p-3 rounded-lg border border-border",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Paciente desde"}),e.jsx("p",{className:"text-sm font-semibold text-foreground",children:v(s?.created_at)})]}),e.jsxs("div",{className:"bg-background p-3 rounded-lg border border-border",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"√öltima consulta"}),e.jsx("p",{className:"text-sm font-semibold text-foreground",children:g?.last_appointment||"Sem registro"})]}),e.jsxs("div",{className:"bg-background p-3 rounded-lg border border-border",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Pr√≥xima consulta"}),e.jsx("p",{className:"text-sm font-semibold text-foreground",children:g?.next_appointment||"N√£o agendada"})]})]}),e.jsxs("div",{className:"flex md:hidden flex-row gap-2",children:[e.jsx(w,{variant:"outline",size:"sm",onClick:a,className:"flex-1",children:"Abrir Chat"}),e.jsx(w,{variant:"default",size:"sm",onClick:o,className:"flex-1",children:"Agendar"})]})]})})},Oe=({patientId:s,modulesStatus:g={},latestMetrics:d={}})=>{const a=F(),[o,f]=x.useState(!1),i=[{id:"anamnesis",title:"Anamnese",description:"Hist√≥rico cl√≠nico e alergias",icon:q,isComplete:g.anamnese==="completed",route:`/nutritionist/patients/${s}/anamnese`},{id:"anthropometry",title:"Avalia√ß√£o Antropom√©trica",description:"Peso, altura e medidas",icon:V,isComplete:g.anthropometry==="completed",route:`/nutritionist/patients/${s}/anthropometry`},{id:"energy_calculation",title:"C√°lculo de Necessidades",description:"VET e distribui√ß√£o de macros",icon:B,isComplete:g.energy_expenditure==="completed",route:`/nutritionist/patients/${s}/energy-expenditure`},{id:"diet_plan",title:"Plano Alimentar",description:"Prescri√ß√£o diet√©tica vigente",icon:L,isComplete:g.meal_plan==="completed",route:`/nutritionist/patients/${s}/meal-plan`}],m=i.filter(n=>n.isComplete).length,v=i.length,b=Math.round(m/v*100),u=m===v,h=i.find(n=>!n.isComplete);return u?null:o?e.jsxs("div",{className:"bg-gradient-to-r from-[#fefae0]/70 via-[#f9ebc7]/60 to-[#fefae0]/70 border border-[#a9b388]/40 rounded-lg shadow-md overflow-hidden",children:[e.jsxs("button",{onClick:()=>f(!1),className:"w-full text-left px-3 sm:px-4 py-2.5 sm:py-3 flex items-center justify-between hover:bg-[#a9b388]/10 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:[e.jsx("div",{className:"w-2 h-2 bg-[#5f6f52] rounded-full flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-sm font-bold text-[#5f6f52] truncate",children:"Guia de Atendimento"}),e.jsx("p",{className:"text-[10px] text-gray-600 mt-0.5 truncate",children:"Siga estas etapas para avalia√ß√£o completa"})]})]}),e.jsx(pe,{className:"w-4 h-4 text-gray-400 group-hover:text-[#5f6f52] transition-colors flex-shrink-0"})]}),e.jsx("div",{className:"px-3 sm:px-4 pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 relative h-1.5 rounded-full overflow-hidden bg-gradient-to-r from-gray-100 to-gray-200 shadow-inner",children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-gradient-to-r from-[#5f6f52] via-[#6d7e5f] to-[#7a8d6c] transition-all duration-700",style:{width:`${b}%`}})}),e.jsxs("span",{className:"text-[10px] font-bold text-gray-700 min-w-[2.5rem] text-right",children:[b,"%"]})]})}),e.jsx("div",{className:"px-3 sm:px-4 pb-3 sm:pb-4 space-y-2",children:i.map((n,l)=>{const c=n.icon,t=n.id===h?.id;return e.jsxs("div",{className:E("flex items-center gap-2 sm:gap-3 p-2.5 sm:p-3 rounded-lg transition-all duration-300","border",n.isComplete?"bg-gradient-to-r from-green-50 to-emerald-50 border-green-300 shadow-sm":t?"bg-white border-[#c4661f] shadow-sm ring-1 ring-[#c4661f]/20":"bg-white/60 border-gray-200 hover:border-gray-300"),children:[e.jsx("div",{className:E("w-8 h-8 sm:w-9 sm:h-9 rounded-lg flex items-center justify-center flex-shrink-0 transition-all","border",n.isComplete?"bg-gradient-to-br from-green-400 to-emerald-500 border-green-500 shadow-md":t?"bg-gradient-to-br from-[#c4661f] to-[#d4764f] border-[#c4661f] shadow-sm":"bg-gray-100 border-gray-300"),children:n.isComplete?e.jsx(de,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white",strokeWidth:2.5}):e.jsx(c,{className:E("w-3.5 h-3.5 sm:w-4 sm:h-4",t?"text-white":"text-gray-500")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5 flex-wrap",children:[e.jsxs("span",{className:E("text-[9px] sm:text-[10px] font-bold px-1.5 py-0.5 rounded",n.isComplete?"bg-green-100 text-green-700":t?"bg-orange-100 text-[#c4661f]":"bg-gray-100 text-gray-600"),children:["ETAPA ",l+1]}),n.isComplete&&e.jsx("span",{className:"text-[9px] sm:text-[10px] font-semibold text-green-600",children:"‚úì Conclu√≠da"}),t&&!n.isComplete&&e.jsx("span",{className:"text-[9px] sm:text-[10px] font-semibold text-[#c4661f] animate-pulse",children:"‚Ä¢ Pendente"})]}),e.jsx("h4",{className:E("text-xs sm:text-sm font-bold mb-0.5 truncate",n.isComplete?"text-green-800":"text-gray-800"),children:n.title}),e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-600 truncate",children:n.description})]}),e.jsxs("div",{className:"flex-shrink-0",children:[t&&!n.isComplete&&e.jsxs(w,{size:"sm",onClick:()=>a(n.route),className:E("h-7 sm:h-8 px-2 sm:px-3 text-[10px] sm:text-xs font-semibold","bg-gradient-to-r from-[#5f6f52] to-[#6d7e5f] hover:from-[#4a5841] hover:to-[#5f6f52]","shadow-sm hover:shadow-md transition-all"),children:[e.jsx("span",{className:"hidden sm:inline",children:"Iniciar"}),e.jsx("span",{className:"sm:hidden",children:"‚ñ∂"}),e.jsx(A,{className:"ml-0.5 sm:ml-1 w-3 h-3 hidden sm:inline"})]}),n.isComplete&&e.jsxs(w,{size:"sm",variant:"outline",onClick:()=>a(n.route),className:"h-7 sm:h-8 px-2 sm:px-3 text-[10px] sm:text-xs font-medium border-green-300 text-green-700 hover:bg-green-50",children:[e.jsx("span",{className:"hidden sm:inline",children:"Revisar"}),e.jsx("span",{className:"sm:hidden",children:"‚Üª"})]})]})]},n.id)})})]}):e.jsxs("button",{onClick:()=>f(!0),className:E("w-full text-left transition-all duration-300","bg-gradient-to-r from-[#fefae0]/70 via-[#f9ebc7]/60 to-[#fefae0]/70","border border-[#a9b388]/40 rounded-lg","hover:shadow-md hover:border-[#a9b388]/60 hover:scale-[1.005]","px-3 sm:px-4 py-2.5 sm:py-3 flex items-center gap-2 sm:gap-3","group"),children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("div",{className:"relative w-2 h-2",children:[e.jsx("div",{className:"absolute inset-0 bg-[#5f6f52] rounded-full animate-pulse"}),e.jsx("div",{className:"absolute inset-0 bg-[#5f6f52] rounded-full animate-ping opacity-40"})]})}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-3 min-w-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-sm font-bold text-[#5f6f52] truncate",children:"Jornada Cl√≠nica"}),e.jsxs("span",{className:"px-1.5 py-0.5 rounded-full bg-[#a9b388]/20 text-[10px] sm:text-xs font-semibold text-[#5f6f52] border border-[#a9b388]/30 whitespace-nowrap",children:[m,"/",v]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 relative h-2 rounded-full overflow-hidden bg-gradient-to-r from-gray-100 to-gray-200 shadow-inner",children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-gradient-to-r from-[#5f6f52] via-[#6d7e5f] to-[#7a8d6c] shadow-sm transition-all duration-700 ease-out",style:{width:`${b}%`},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-pulse"})})}),e.jsxs("span",{className:"text-xs font-bold text-[#5f6f52] min-w-[2rem] text-right",children:[b,"%"]})]})]}),h&&e.jsxs("div",{className:"hidden lg:flex items-center gap-1.5 px-2 py-1 rounded-md bg-white/60 border border-[#a9b388]/30",children:[e.jsx(be,{className:"w-2.5 h-2.5 text-[#c4661f] fill-[#c4661f]"}),e.jsx("span",{className:"text-[10px] text-gray-600",children:"Pr√≥ximo:"}),e.jsx("span",{className:"text-[10px] font-semibold text-[#5f6f52] truncate max-w-[100px]",children:h.title})]}),e.jsx(oe,{className:"w-4 h-4 text-gray-400 group-hover:text-[#5f6f52] transition-colors flex-shrink-0"})]})]})},Ie=({activity:s})=>{const g=a=>{switch(a){case"meal":return e.jsx(L,{className:"w-4 h-4 text-[#c4661f]"});case"weight":return e.jsx(ce,{className:"w-4 h-4 text-[#5f6f52]"});case"achievement":return e.jsx(K,{className:"w-4 h-4 text-[#b99470]"});case"appointment":return e.jsx(T,{className:"w-4 h-4 text-[#783d19]"});case"message":return e.jsx(Re,{className:"w-4 h-4 text-[#a9b388]"});case"anamnese":return e.jsx(q,{className:"w-4 h-4 text-[#5f6f52]"});default:return e.jsx(q,{className:"w-4 h-4 text-muted-foreground"})}},d=a=>{try{return Ne(new Date(a),{addSuffix:!0,locale:ne})}catch{return"Data inv√°lida"}};return e.jsxs("div",{className:"flex gap-3 p-3 hover:bg-muted/50 rounded-lg transition-colors cursor-pointer group",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx("div",{className:"p-2 rounded-full bg-background border border-border group-hover:border-primary/50 transition-colors",children:g(s.type)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[e.jsx("p",{className:"text-sm font-medium text-foreground group-hover:text-primary transition-colors",children:s.title}),e.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:d(s.timestamp)})]}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:s.description}),s.metadata&&s.metadata.length>0&&e.jsx("div",{className:"flex gap-2 mt-2 flex-wrap",children:s.metadata.map((a,o)=>e.jsx(D,{variant:"outline",className:"text-xs",children:a},o))})]})]})},es=({patientId:s,activities:g=[],loading:d=!1,onLoadMore:a,onFilterChange:o})=>{const[f,i]=x.useState("all"),[m,v]=x.useState("all"),[b,u]=x.useState(10),n=(()=>{let y=[...g];if(f!=="all"&&(y=y.filter(j=>j.type===f)),m!=="all"){const j=new Date;let P;switch(m){case"7d":P=O(j,7);break;case"30d":P=O(j,30);break;case"3m":P=Be(j,3);break;default:P=null}P&&(y=y.filter(fe=>new Date(fe.timestamp)>=P))}return y})(),l=n.slice(0,b),c=n.length>b;x.useEffect(()=>{u(10)},[f,m]),x.useEffect(()=>{o&&o({type:f,period:m})},[f,m,o]);const t=y=>{i(y)},r=y=>{v(y)},C=()=>{u(y=>y+10)};return e.jsxs(p,{className:"bg-card shadow-lg border-border",children:[e.jsx(_,{children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(S,{className:"text-xl font-bold text-foreground",children:"Feed de Atividades"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[n.length," ",n.length===1?"atividade":"atividades",m!=="all"&&` nos √∫ltimos ${m==="7d"?"7 dias":m==="30d"?"30 dias":"3 meses"}`]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsxs(ee,{value:f,onValueChange:t,children:[e.jsxs(se,{className:"flex-1 md:w-[140px] h-9",children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),e.jsx(te,{placeholder:"Tipo"})]}),e.jsxs(ae,{children:[e.jsx(M,{value:"all",children:"Todos"}),e.jsx(M,{value:"meal",children:"Refei√ß√µes"}),e.jsx(M,{value:"weight",children:"Peso"}),e.jsx(M,{value:"achievement",children:"Conquistas"}),e.jsx(M,{value:"appointment",children:"Consultas"}),e.jsx(M,{value:"message",children:"Mensagens"}),e.jsx(M,{value:"anamnese",children:"Anamnese"})]})]}),e.jsxs(ee,{value:m,onValueChange:r,children:[e.jsx(se,{className:"flex-1 md:w-[120px] h-9",children:e.jsx(te,{placeholder:"Per√≠odo"})}),e.jsxs(ae,{children:[e.jsx(M,{value:"all",children:"Tudo"}),e.jsx(M,{value:"7d",children:"7 dias"}),e.jsx(M,{value:"30d",children:"30 dias"}),e.jsx(M,{value:"3m",children:"3 meses"})]})]})]})]})}),e.jsx(N,{children:d?e.jsxs("div",{className:"flex flex-col justify-center items-center py-12",children:[e.jsx(R,{className:"w-8 h-8 animate-spin text-primary mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando atividades..."})]}):l.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-1 divide-y divide-border",children:l.map(y=>e.jsx(Ie,{activity:y},y.id))}),c&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(w,{variant:"outline",onClick:C,className:"w-full md:w-auto",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Carregar Mais (",n.length-b," restantes)"]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"w-12 h-12 text-muted-foreground/50 mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground font-medium mb-1",children:"Nenhuma atividade encontrada"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f!=="all"||m!=="all"?"Tente ajustar os filtros acima":"Este paciente ainda n√£o possui atividades registradas"})]})})]})},ss=({patientId:s,activities:g,loading:d,onLoadMore:a})=>{const o=F(),[f,i]=x.useState([]),[m,v]=x.useState(!0);x.useEffect(()=>{(async()=>{if(s){v(!0);try{const{data:c,error:t}=await W.from("meal_audit_log").select("id, action, meal_type, meal_date, meal_time, details, created_at").eq("patient_id",s).order("created_at",{ascending:!1}).limit(4);if(t)throw t;i(c||[])}catch(c){console.error("Erro ao buscar refei√ß√µes:",c),i([])}finally{v(!1)}}})()},[s]);const b=l=>({breakfast:"Caf√© da Manh√£",morning_snack:"Lanche da Manh√£",lunch:"Almo√ßo",afternoon_snack:"Lanche da Tarde",dinner:"Jantar",supper:"Ceia"})[l]||l,u=l=>({create:"Registrado",update:"Editado",delete:"Deletado"})[l]||l,h=l=>({create:"bg-[#5f6f52]",update:"bg-blue-600",delete:"bg-red-600"})[l]||"bg-gray-600",n=()=>e.jsxs(p,{className:"border-l-4 border-l-[#b99470] bg-gradient-to-br from-[#fefae0]/30 to-[#f9ebc7]/20",children:[e.jsxs(_,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(S,{className:"text-base flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-[#b99470]"}),"Di√°rio Alimentar"]}),e.jsxs(w,{variant:"ghost",size:"sm",onClick:()=>o(`/nutritionist/patients/${s}/food-diary`),className:"h-7 text-xs text-[#5f6f52] hover:text-[#5f6f52] hover:bg-[#5f6f52]/10",children:["Ver tudo",e.jsx(A,{className:"w-3 h-3 ml-1"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"√öltimos registros"})]}),e.jsx(N,{className:"space-y-2",children:m?e.jsxs("div",{className:"text-center py-6",children:[e.jsx(R,{className:"w-6 h-6 animate-spin text-[#5f6f52] mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Carregando..."})]}):f.length>0?e.jsxs(e.Fragment,{children:[f.map(l=>{const c=new Date(l.created_at),t=l.details?.total_calories||0;return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-[#fefae0]/50 hover:bg-[#fefae0] transition-colors border border-[#a9b388]/20",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-foreground truncate",children:b(l.meal_type)}),e.jsx(D,{className:`${h(l.action)} text-white text-xs`,children:u(l.action)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx($e,{className:"w-3 h-3"}),e.jsx("span",{children:c.toLocaleDateString("pt-BR")}),e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:c.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsx("div",{className:"text-right ml-2 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3 text-[#c4661f]"}),e.jsx("span",{className:"text-sm font-bold text-[#5f6f52]",children:t})]})})]},l.id)}),e.jsxs(w,{variant:"outline",size:"sm",onClick:()=>o(`/nutritionist/patients/${s}/food-diary`),className:"w-full mt-2 border-[#5f6f52] text-[#5f6f52] hover:bg-[#5f6f52]/10",children:["Ver di√°rio completo",e.jsx(A,{className:"w-3 h-3 ml-1"})]})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(L,{className:"w-8 h-8 text-muted-foreground/40 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Nenhuma refei√ß√£o registrada"}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>o(`/nutritionist/patients/${s}/food-diary`),className:"text-[#5f6f52] hover:text-[#5f6f52] hover:bg-[#5f6f52]/10 text-xs",children:"Abrir Di√°rio Alimentar"})]})})]});return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(es,{patientId:s,activities:g,loading:d,onLoadMore:a})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(n,{})})]})},ts=({patientId:s,modulesStatus:g={}})=>{const d=F(),[a,o]=x.useState(null),[f,i]=x.useState(!0),[m,v]=x.useState([]),[b,u]=x.useState(!0);x.useEffect(()=>{const l=async()=>{if(s){i(!0);try{const{data:t}=await ze(s);o(t)}catch(t){console.error("Erro ao buscar anamnese:",t)}finally{i(!1)}}},c=async()=>{if(s){u(!0);try{const{data:t}=await Ge(s);v(t||[])}catch(t){console.error("Erro ao buscar exames:",t),v([])}finally{u(!1)}}};l(),c()},[s]);const h=()=>{const l=!f&&a;if(f)return e.jsx(p,{className:"border-l-4 border-l-[#a9b388] h-full",children:e.jsx(N,{className:"py-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando anamnese..."})})});if(!l)return e.jsx(p,{className:"border-l-4 border-l-[#c4661f] bg-[#fefae0]/30 hover:shadow-md transition-all cursor-pointer h-full",onClick:()=>d(`/nutritionist/patients/${s}/anamnese`),children:e.jsx(N,{className:"py-8",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#fefae0] flex items-center justify-center flex-shrink-0",children:e.jsx(Z,{className:"w-6 h-6 text-[#c4661f]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Anamnese"}),e.jsx(D,{className:"bg-[#fefae0] text-[#c4661f] border-[#c4661f]",children:"Pendente"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Hist√≥rico cl√≠nico ainda n√£o registrado. Complete a anamnese para identificar alergias, condi√ß√µes de sa√∫de e medica√ß√µes em uso."}),e.jsxs("span",{className:"inline-flex items-center gap-2 text-sm font-medium text-[#c4661f]",children:[e.jsx(q,{className:"w-4 h-4"}),"Iniciar Anamnese",e.jsx(A,{className:"w-4 h-4"})]})]})]})})});const c={draft:{label:"Rascunho",color:"bg-yellow-100 text-yellow-800 border-yellow-300"},completed:{label:"Completa",color:"bg-[#a9b388]/20 text-[#5f6f52] border-[#5f6f52]"}},t=c[a.status]||c.draft;return e.jsxs(p,{className:"border-l-4 border-l-[#5f6f52] hover:shadow-xl transition-all cursor-pointer h-full",onClick:()=>d(`/nutritionist/patients/${s}/anamnese`),children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5 text-[#5f6f52]"}),e.jsx(S,{className:"text-lg",children:"Anamnese"}),e.jsx(D,{variant:"outline",className:t.color,children:t.label})]})}),e.jsxs(N,{children:[e.jsxs("div",{className:"bg-[#fefae0] border border-[#a9b388] rounded-lg p-3 mb-3",children:[e.jsx("div",{className:"text-xs font-semibold text-[#5f6f52] mb-1 uppercase tracking-wide",children:"üìã Documento"}),e.jsx("p",{className:"text-sm text-foreground",children:a.template?.title||"Anamnese Nutricional"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground pt-3 mt-3 border-t",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),"Registrada em: ",new Date(a.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"})]}),e.jsxs(w,{variant:"ghost",size:"sm",className:"h-7 text-[#5f6f52] hover:bg-[#5f6f52]/10",onClick:()=>d(`/nutritionist/patients/${s}/anamnesis`),children:["Abrir ",e.jsx(A,{className:"w-3 h-3 ml-1"})]})]})]})]})},n=()=>{if(b)return e.jsx(p,{className:"border-l-4 border-l-[#b99470] h-full",children:e.jsxs(N,{className:"py-8 text-center",children:[e.jsx(R,{className:"w-6 h-6 animate-spin text-primary mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando exames..."})]})});if(!(m&&m.length>0))return e.jsx(p,{className:"border-dashed border-2 border-[#a9b388] bg-[#fefae0]/30 hover:shadow-md transition-all cursor-pointer h-full",onClick:()=>d(`/nutritionist/patients/${s}/lab-results`),children:e.jsxs(N,{className:"py-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#fefae0] flex items-center justify-center mx-auto mb-3",children:e.jsx(J,{className:"w-6 h-6 text-[#b99470]"})}),e.jsx("h3",{className:"text-base font-semibold text-foreground mb-2",children:"Exames Laboratoriais"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 max-w-sm mx-auto",children:"Nenhum exame registrado. Adicione resultados de an√°lises cl√≠nicas para um acompanhamento mais completo."}),e.jsxs("span",{className:"inline-flex items-center gap-2 text-sm font-medium text-[#b99470]",children:[e.jsx(J,{className:"w-4 h-4"}),"Adicionar Exames",e.jsx(A,{className:"w-4 h-4"})]})]})});const c=m.slice(0,3),t=m[0]?.test_date;return e.jsxs(p,{className:"border-l-4 border-l-[#b99470] hover:shadow-xl transition-all cursor-pointer h-full",onClick:()=>d(`/nutritionist/patients/${s}/lab-results`),children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-[#b99470]"}),e.jsx(S,{className:"text-base",children:"Exames Laboratoriais"})]})}),e.jsxs(N,{children:[e.jsx("div",{className:"space-y-2 mb-3",children:c.map(r=>e.jsxs("div",{className:E("flex items-center justify-between p-3 rounded-lg border",r.status==="normal"?"bg-emerald-50 border-emerald-200":r.status==="low"?"bg-amber-50 border-amber-200":r.status==="high"?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-foreground truncate",children:r.test_name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[r.test_value," ",r.test_unit||""]})]}),e.jsx(D,{variant:"outline",className:E("text-xs ml-2",r.status==="normal"?"bg-emerald-100 text-emerald-800 border-emerald-300":r.status==="low"?"bg-amber-100 text-amber-800 border-amber-300":r.status==="high"?"bg-red-100 text-red-800 border-red-300":"bg-gray-100 text-gray-800 border-gray-300"),children:r.status==="normal"?"Normal":r.status==="low"?"Baixo":r.status==="high"?"Alto":"Pendente"})]},r.id))}),e.jsxs("div",{className:"text-xs text-muted-foreground pt-3 border-t flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),t&&`√öltimos exames: ${new Date(t).toLocaleDateString("pt-BR")}`,!t&&"Nenhum exame recente"]}),e.jsxs(w,{variant:"ghost",size:"sm",className:"h-7 text-[#b99470] hover:bg-[#b99470]/10",onClick:()=>d(`/nutritionist/patients/${s}/lab-results`),children:["Abrir ",e.jsx(A,{className:"w-3 h-3 ml-1"})]})]})]})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-foreground mb-1",children:"Dados Cl√≠nicos"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hist√≥rico de sa√∫de e exames laboratoriais"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(h,{}),e.jsx(n,{})]})]})},as=({patientId:s,modulesStatus:g={},latestMetrics:d={}})=>{const a=F(),o={hasData:g.anthropometry==="completed"||!!d?.weight,currentWeight:d?.weight,previousWeight:d?.previous_weight||null,height:d?.height,bmi:null,lastUpdate:d?.updated_at||d?.created_at};if(o.height&&o.currentWeight){const u=o.height/100;o.bmi=(o.currentWeight/u**2).toFixed(1)}const f=o.previousWeight?o.currentWeight-o.previousWeight:0,i=Math.abs(f).toFixed(1),m=u=>{const h=parseFloat(u);return h<16?{label:"Magreza Grave",color:"bg-red-700/10 text-red-800 border-red-700",severity:"critical"}:h>=16&&h<17?{label:"Magreza Moderada",color:"bg-orange-600/10 text-orange-800 border-orange-600",severity:"high"}:h>=17&&h<18.5?{label:"Magreza Leve",color:"bg-yellow-500/10 text-yellow-800 border-yellow-500",severity:"moderate"}:h>=18.5&&h<25?{label:"Peso Normal",color:"bg-[#5f6f52]/10 text-[#5f6f52] border-[#5f6f52]",severity:"normal"}:h>=25&&h<30?{label:"Sobrepeso",color:"bg-yellow-500/10 text-yellow-800 border-yellow-500",severity:"moderate"}:h>=30&&h<35?{label:"Obesidade Grau I",color:"bg-orange-600/10 text-orange-800 border-orange-600",severity:"high"}:h>=35&&h<40?{label:"Obesidade Grau II",color:"bg-red-600/10 text-red-800 border-red-600",severity:"critical"}:{label:"Obesidade Grau III",color:"bg-red-700/10 text-red-900 border-red-700",severity:"critical"}},v=()=>o.hasData?e.jsxs(p,{className:"border-l-4 border-l-[#5f6f52] hover:shadow-xl transition-all bg-gradient-to-br from-[#fefae0]/20 to-[#fefae0]/30 cursor-pointer h-full",onClick:()=>a(`/nutritionist/patients/${s}/anthropometry`),children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-[#5f6f52]"}),e.jsx(S,{className:"text-base",children:"Avalia√ß√£o Antropom√©trica"})]})}),e.jsxs(N,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#5f6f52] to-[#a9b388] text-white rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{className:"text-xs font-medium opacity-90",children:"Peso Atual"}),f!==0&&e.jsxs("div",{className:"flex items-center gap-1 bg-[#fefae0]/20 px-1.5 py-0.5 rounded text-xs",children:[f<0?e.jsx(me,{className:"w-3 h-3 text-green-300"}):e.jsx(X,{className:"w-3 h-3 text-red-300"}),e.jsxs("span",{className:"font-semibold",children:[f<0?"-":"+",i," kg"]})]})]}),e.jsxs("div",{className:"text-4xl font-bold mb-1",children:[o.currentWeight.toFixed(1),e.jsx("span",{className:"text-lg ml-1 opacity-80",children:"kg"})]}),o.previousWeight&&e.jsxs("div",{className:"text-xs opacity-80",children:["Anterior: ",o.previousWeight.toFixed(1)," kg"]})]}),o.bmi&&(()=>{const u=m(o.bmi);return e.jsxs("div",{className:"bg-[#fefae0] border border-[#a9b388] rounded-lg p-4 text-center flex flex-col justify-center",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"IMC"}),e.jsx("div",{className:"text-3xl font-bold text-foreground mb-2",children:o.bmi}),e.jsx(D,{variant:"outline",className:E("text-xs font-medium mx-auto",u.color),children:u.label})]})})()]}),o.height&&e.jsx("div",{className:"bg-[#f9ebc7] border border-[#a9b388] rounded-lg p-3 text-center mb-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{className:"text-xl font-bold text-foreground",children:[o.height," cm"]})]})}),o.lastUpdate&&e.jsxs("div",{className:"text-xs pt-3 mt-3 border-t flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",children:[e.jsx(T,{className:"w-3 h-3"}),new Date(o.lastUpdate).toLocaleDateString("pt-BR")]}),e.jsxs(w,{variant:"ghost",size:"sm",className:"h-7 text-[#5f6f52] hover:bg-[#5f6f52]/10",onClick:()=>a(`/nutritionist/patients/${s}/anthropometry`),children:["Abrir ",e.jsx(A,{className:"w-3 h-3 ml-1"})]})]})]})]}):e.jsx(p,{className:"border-dashed border-2 border-[#a9b388] bg-[#fefae0]/30 hover:shadow-lg transition-all cursor-pointer h-full",onClick:()=>a(`/nutritionist/patients/${s}/anthropometry`),children:e.jsxs(N,{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-[#fefae0] flex items-center justify-center mb-4",children:e.jsx(V,{className:"w-8 h-8 text-[#5f6f52]"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Nenhuma Avalia√ß√£o Registrada"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-md",children:"Registre peso, altura e medidas para acompanhar a evolu√ß√£o do paciente"}),e.jsxs("span",{className:"inline-flex items-center gap-2 text-sm font-medium text-[#5f6f52]",children:[e.jsx(V,{className:"w-4 h-4"}),"Registrar Avalia√ß√£o",e.jsx(A,{className:"w-4 h-4"})]})]})}),b=()=>e.jsxs(p,{className:"border-dashed border-2 border-[#b99470] bg-[#fefae0]/30 hover:shadow-md transition-all cursor-pointer h-full",onClick:()=>a(`/nutritionist/patients/${s}/photos`),children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-[#b99470]"}),e.jsx(S,{className:"text-base",children:"Fotos de Progresso"})]})}),e.jsx(N,{children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#fefae0] flex items-center justify-center mx-auto mb-3",children:e.jsx(Y,{className:"w-6 h-6 text-[#b99470]"})}),e.jsx("p",{className:"text-sm font-medium text-foreground mb-2",children:"Nenhuma foto registrada"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:"Adicione fotos para acompanhar o progresso visual"}),e.jsxs("span",{className:"inline-flex items-center gap-2 text-sm font-medium text-[#b99470]",children:[e.jsx(Y,{className:"w-3 h-3"}),"Adicionar Fotos",e.jsx(A,{className:"w-3 h-3"})]})]})})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-foreground mb-1",children:"Avalia√ß√£o Corporal"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Medidas antropom√©tricas e registro visual do progresso"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-10 gap-4",children:[e.jsx("div",{className:"lg:col-span-7",children:e.jsx(v,{})}),e.jsx("div",{className:"lg:col-span-3",children:e.jsx(b,{})})]})]})},rs=({patientId:s})=>{const g=F(),[d,a]=x.useState(!0),[o,f]=x.useState(!1),[i,m]=x.useState(null),[v,b]=x.useState(null);x.useEffect(()=>{u()},[s]);const u=async()=>{if(s){a(!0);try{const{data:l,error:c}=await W.from("user_profiles").select("name, birth_date, gender, weight, height").eq("id",s).single();if(c)throw c;const{data:t}=await W.from("growth_records").select("weight, height").eq("patient_id",s).order("record_date",{ascending:!1}).limit(1).maybeSingle(),r={weight:t?.weight||l.weight,height:t?.height||l.height,birth_date:l.birth_date,gender:l.gender};b(r);const C=h(r.birth_date),y=r.weight&&r.height&&C&&r.gender;f(y);const{data:j}=await W.from("energy_expenditure_calculations").select("*").eq("patient_id",s).order("created_at",{ascending:!1}).limit(1).maybeSingle();j&&m(j)}catch(l){console.error("Erro ao buscar dados:",l)}finally{a(!1)}}},h=l=>{if(!l)return null;const c=new Date,t=new Date(l);let r=c.getFullYear()-t.getFullYear();const C=c.getMonth()-t.getMonth();return(C<0||C===0&&c.getDate()<t.getDate())&&r--,r},n=()=>{g(`/nutritionist/patients/${s}/energy-expenditure`)};if(d)return e.jsx(p,{className:"hover:shadow-md transition-all",children:e.jsx(N,{className:"flex items-center justify-center py-12",children:e.jsx(R,{className:"w-6 h-6 animate-spin text-primary"})})});if(!o)return e.jsxs(p,{className:"hover:shadow-md transition-all border-dashed border-2 border-amber-300 bg-amber-50/30 cursor-pointer",onClick:n,children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-amber-600"}),e.jsx(S,{className:"text-base",children:"Gasto Energ√©tico"})]})}),e.jsx(N,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(xe,{className:"border-amber-300 bg-amber-50/50",children:[e.jsx(Z,{className:"h-4 w-4 text-amber-600"}),e.jsxs(he,{className:"text-sm",children:[e.jsx("strong",{children:"Dados incompletos"}),e.jsx("p",{className:"mt-1 text-muted-foreground text-xs",children:"Para calcular, √© necess√°rio peso, altura, idade e sexo."})]})]}),e.jsxs(w,{onClick:n,className:"w-full gap-2",variant:"outline",children:[e.jsx(B,{className:"w-4 h-4"}),"Calcular Gasto Energ√©tico",e.jsx(A,{className:"w-4 h-4 ml-auto"})]})]})})]});if(i){const l=i.protocol?.startsWith("eer-iom"),c=i.get_with_activities||i.get||0,t=i.activities&&Array.isArray(i.activities)&&i.activities.length>0,r=i.target_weight&&i.venta_adjusted;return e.jsxs(p,{className:"hover:shadow-md transition-all border-l-4 border-l-[#5f6f52] cursor-pointer",onClick:n,children:[e.jsxs(_,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(B,{className:"w-5 h-5 text-[#5f6f52]"}),e.jsx(S,{className:"text-base",children:"Gasto Energ√©tico"}),t&&e.jsxs(D,{variant:"outline",className:"text-xs border-[#5f6f52] text-[#5f6f52]",children:["+",i.activities.length," ",i.activities.length===1?"atividade":"atividades"]}),r&&e.jsxs(D,{className:"text-xs bg-amber-500 hover:bg-amber-600",children:["Objetivo: ",i.target_weight,"kg"]})]}),e.jsxs(Q,{className:"text-xs",children:["Protocolo: ",i.protocol||"Harris-Benedict"]})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[!l&&e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg border border-orange-200",children:[e.jsx($,{className:"w-4 h-4 text-orange-600 mx-auto mb-1"}),e.jsx("div",{className:"text-2xl font-bold text-orange-700",children:Math.round(i.tmb||0)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"TMB (kcal)"})]}),e.jsxs("div",{className:`text-center p-3 bg-gradient-to-br from-emerald-600 to-emerald-500 rounded-lg text-white ${l?"col-span-2":""}`,children:[e.jsx(U,{className:"w-4 h-4 mx-auto mb-1 opacity-90"}),e.jsx("div",{className:"text-2xl font-bold",children:Math.round(c)}),e.jsxs("div",{className:"text-xs opacity-90",children:[t?"GET + Atividades":l?"EER":"GET"," (kcal)"]})]})]}),r&&e.jsxs("div",{className:"text-center p-2.5 bg-gradient-to-br from-amber-500 to-amber-600 rounded-lg text-white shadow-sm",children:[e.jsxs("div",{className:"text-lg font-bold",children:[Math.round(i.venta_adjusted)," kcal/dia"]}),e.jsxs("div",{className:"text-xs opacity-90",children:["Objetivo: ",i.target_weight,"kg"]})]}),e.jsxs("div",{className:"text-xs text-center text-muted-foreground",children:[i.activity_level==="1.2"&&"Sedent√°rio",i.activity_level==="1.375"&&"Levemente Ativo",i.activity_level==="1.55"&&"Moderadamente Ativo",i.activity_level==="1.725"&&"Muito Ativo",i.activity_level==="1.9"&&"Extremamente Ativo"]}),e.jsxs(w,{onClick:n,variant:"outline",size:"sm",className:"w-full gap-1",children:["Ver detalhes / Editar",e.jsx(A,{className:"w-3 h-3"})]})]})]})}return e.jsxs(p,{className:"hover:shadow-md transition-all border-dashed border-2 border-[#a9b388] bg-[#fefae0]/30 cursor-pointer",onClick:n,children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-[#5f6f52]"}),e.jsx(S,{className:"text-base",children:"Gasto Energ√©tico"})]})}),e.jsx(N,{children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#fefae0] flex items-center justify-center mx-auto mb-3",children:e.jsx($,{className:"w-6 h-6 text-[#c4661f]"})}),e.jsx("p",{className:"text-sm font-medium text-foreground mb-2",children:"Calcular TMB e GET"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:"Dados dispon√≠veis. Calcule o gasto energ√©tico total."}),e.jsxs(w,{onClick:n,className:"gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"Calcular Agora",e.jsx(A,{className:"w-4 h-4"})]})]})})]})},ls=({patientId:s,modulesStatus:g={}})=>{const d=F(),[a,o]=x.useState(null),[f,i]=x.useState(!0),[m,v]=x.useState(null),[b,u]=x.useState(!0);x.useEffect(()=>{(async()=>{if(s){i(!0);try{const{data:c,error:t}=await qe(s);if(t)throw t;o(c)}catch(c){console.error("Erro ao buscar plano ativo:",c),o(null)}finally{i(!1)}}})()},[s]),x.useEffect(()=>{(async()=>{if(s){u(!0);try{const{data:c}=await We(s,7),t=new Date().toISOString().split("T")[0],r=new Date;r.setDate(r.getDate()-7);const C=r.toISOString().split("T")[0],{data:y}=await Ve(s,C,t);v({adherence:c||{adherencePercentage:0,totalMeals:0,currentStreak:0},summary:y||{avgCaloriesPerDay:0,avgProteinPerDay:0}})}catch(c){console.error("Erro ao buscar estat√≠sticas do di√°rio:",c),v(null)}finally{u(!1)}}})()},[s]);const h=()=>f?e.jsx(p,{className:"h-full",children:e.jsx(N,{className:"flex items-center justify-center py-12",children:e.jsx(R,{className:"w-8 h-8 animate-spin text-[#5f6f52]"})})}):a?e.jsxs(p,{className:"border-l-4 border-l-[#5f6f52] hover:shadow-xl transition-all bg-gradient-to-br from-[#fefae0]/20 to-[#fefae0]/30 cursor-pointer h-full",onClick:()=>d(`/nutritionist/patients/${s}/meal-plan`),children:[e.jsxs(_,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(L,{className:"w-5 h-5 text-[#5f6f52]"}),e.jsx(S,{className:"text-lg",children:"Plano Alimentar"}),e.jsx(D,{className:"bg-[#a9b388]/20 text-[#5f6f52] border-[#5f6f52]",children:"Vigente"})]}),e.jsx(Q,{className:"text-base font-semibold text-foreground",children:a.name})]}),e.jsxs(N,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsxs("div",{className:"text-center p-2 bg-[#fefae0] rounded-lg border border-[#c4661f]",children:[e.jsx($,{className:"w-4 h-4 text-[#c4661f] mx-auto mb-0.5"}),e.jsx("div",{className:"text-xl font-bold text-foreground",children:a.daily_calories?Math.round(a.daily_calories):0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"kcal/dia"})]}),e.jsxs("div",{className:"text-center p-2 bg-[#fefae0] rounded-lg border border-[#8B3BF2]",children:[e.jsx("div",{className:"text-xs text-[#8B3BF2] font-medium mb-0.5",children:"Prote√≠nas"}),e.jsxs("div",{className:"text-lg font-bold text-[#8B3BF2]",children:[a.daily_protein?Math.round(a.daily_protein):0,"g"]}),e.jsxs("div",{className:"text-xs text-[#8B3BF2]",children:[a.daily_calories?Math.round(a.daily_protein*4/a.daily_calories*100):0,"%"]})]}),e.jsxs("div",{className:"text-center p-2 bg-[#a9b388]/10 rounded-lg border border-[#3B6FF2]",children:[e.jsx("div",{className:"text-xs text-[#3B6FF2] font-medium mb-0.5",children:"Carboidratos"}),e.jsxs("div",{className:"text-lg font-bold text-[#3B6FF2]",children:[a.daily_carbs?Math.round(a.daily_carbs):0,"g"]}),e.jsxs("div",{className:"text-xs text-[#3B6FF2]",children:[a.daily_calories?Math.round(a.daily_carbs*4/a.daily_calories*100):0,"%"]})]}),e.jsxs("div",{className:"text-center p-2 bg-[#f9ebc7] rounded-lg border border-[#F28B3B]",children:[e.jsx("div",{className:"text-xs text-[#F28B3B] font-medium mb-0.5",children:"Gorduras"}),e.jsxs("div",{className:"text-lg font-bold text-[#F28B3B]",children:[a.daily_fat?Math.round(a.daily_fat):0,"g"]}),e.jsxs("div",{className:"text-xs text-[#F28B3B]",children:[a.daily_calories?Math.round(a.daily_fat*9/a.daily_calories*100):0,"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs pt-3 border-t",children:[e.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",children:[e.jsx(T,{className:"w-3 h-3"}),"Iniciado em ",new Date(a.start_date).toLocaleDateString("pt-BR")]}),e.jsxs(w,{variant:"ghost",size:"sm",className:"h-7 text-[#5f6f52] hover:text-[#5f6f52] hover:bg-[#5f6f52]/10",onClick:()=>d(`/nutritionist/patients/${s}/meal-plan`),children:["Abrir ",e.jsx(A,{className:"w-3 h-3 ml-1"})]})]})]})]}):e.jsx(p,{className:"border-dashed border-2 border-[#a9b388] bg-[#fefae0]/30 hover:shadow-lg transition-all cursor-pointer h-full",onClick:()=>d(`/nutritionist/patients/${s}/meal-plan`),children:e.jsxs(N,{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-[#fefae0] flex items-center justify-center mb-4",children:e.jsx(L,{className:"w-8 h-8 text-[#5f6f52]"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Nenhum Plano Alimentar Ativo"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6 max-w-md",children:"Crie um plano alimentar personalizado com refei√ß√µes, alimentos e valores nutricionais"}),e.jsxs("span",{className:"inline-flex items-center gap-2 text-sm font-medium text-[#5f6f52]",children:[e.jsx(L,{className:"w-4 h-4"}),"Criar Plano Alimentar",e.jsx(A,{className:"w-4 h-4"})]})]})}),n=()=>{if(b)return e.jsx(p,{className:"h-full",children:e.jsx(N,{className:"flex items-center justify-center py-12",children:e.jsx(R,{className:"w-8 h-8 animate-spin text-[#5f6f52]"})})});const l=m&&m.adherence.totalMeals>0;return e.jsxs(p,{className:"border-l-4 border-l-[#c4661f] hover:shadow-lg transition-all h-full bg-gradient-to-br from-[#fefae0]/20 to-white cursor-pointer",onClick:()=>d(`/nutritionist/patients/${s}/food-diary`),children:[e.jsxs(_,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(le,{className:"w-5 h-5 text-[#c4661f]"}),e.jsx(S,{className:"text-lg",children:"Di√°rio Alimentar"})]}),e.jsx(Q,{className:"text-sm",children:"√öltimos 7 dias"})]}),e.jsx(N,{children:l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{className:"text-center p-3 bg-[#fefae0]/50 rounded-lg border border-[#a9b388]/30",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[e.jsx(X,{className:"w-3 h-3 text-[#5f6f52]"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Ades√£o"})]}),e.jsxs("div",{className:"text-2xl font-bold text-[#5f6f52]",children:[m.adherence.adherencePercentage,"%"]})]}),e.jsxs("div",{className:"text-center p-3 bg-[#fefae0]/50 rounded-lg border border-[#a9b388]/30",children:[e.jsxs("div",{className:"flex items-center justify-center gap-1 mb-1",children:[e.jsx(U,{className:"w-3 h-3 text-[#c4661f]"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Sequ√™ncia"})]}),e.jsx("div",{className:"text-2xl font-bold text-[#c4661f]",children:m.adherence.currentStreak}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"dias"})]})]}),e.jsxs("div",{className:"bg-[#fefae0]/40 rounded-lg p-3 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"M√©dia Cal√≥rica"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3 text-[#c4661f]"}),e.jsx("span",{className:"text-sm font-bold text-[#c4661f]",children:m.summary.avgCaloriesPerDay}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"kcal/dia"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Total de Refei√ß√µes"}),e.jsx("span",{className:"text-sm font-semibold text-foreground",children:m.adherence.totalMeals})]})]}),e.jsx("div",{className:"pt-3 border-t flex justify-center",children:e.jsxs(w,{variant:"ghost",size:"sm",className:"text-[#5f6f52] hover:bg-[#5f6f52]/10",onClick:()=>d(`/nutritionist/patients/${s}/food-diary`),children:["Ver Di√°rio Completo",e.jsx(A,{className:"w-3 h-3 ml-1"})]})})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#fefae0] flex items-center justify-center mx-auto mb-3",children:e.jsx(le,{className:"w-6 h-6 text-[#c4661f]"})}),e.jsx("p",{className:"text-sm font-medium text-foreground mb-2",children:"Nenhum Registro Recente"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-4",children:"Paciente ainda n√£o registrou refei√ß√µes nos √∫ltimos 7 dias"}),e.jsxs(w,{variant:"outline",size:"sm",className:"border-[#c4661f] text-[#c4661f] hover:bg-[#c4661f]/10",onClick:()=>d(`/nutritionist/patients/${s}/food-diary`),children:["Abrir Di√°rio",e.jsx(A,{className:"w-3 h-3 ml-1"})]})]})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-foreground mb-1",children:"Nutri√ß√£o"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Prescri√ß√£o diet√©tica, gasto energ√©tico e acompanhamento alimentar"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(h,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(rs,{patientId:s}),e.jsx(n,{})]})]})]})},is=({patientId:s,modulesStatus:g={}})=>{const d=F(),[a,o]=x.useState(null),[f,i]=x.useState(!0);x.useEffect(()=>{m()},[s]);const m=async()=>{i(!0);try{const{data:h}=await Ue(s);o(h)}catch(h){console.error("Erro ao carregar meta ativa:",h)}finally{i(!1)}},v=h=>({weight_loss:me,weight_gain:X,weight_maintenance:ve,custom:H})[h]||H,b=()=>{if(f)return e.jsx(p,{className:"border-l-4 border-l-[#a9b388] h-full",children:e.jsx(N,{className:"py-8 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando meta..."})})});if(!a)return e.jsx(p,{className:"border-dashed border-2 border-[#a9b388] bg-[#fefae0]/30 hover:shadow-md transition-all cursor-pointer h-full",onClick:()=>d(`/nutritionist/patients/${s}/goals`),children:e.jsxs(N,{className:"py-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#fefae0] flex items-center justify-center mx-auto mb-3",children:e.jsx(H,{className:"w-6 h-6 text-[#5f6f52]"})}),e.jsx("h3",{className:"text-base font-semibold text-foreground mb-2",children:"Metas Nutricionais"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 max-w-sm mx-auto",children:"Nenhuma meta ativa. Defina um objetivo nutricional para o paciente"}),e.jsxs("span",{className:"inline-flex items-center gap-2 text-sm font-medium text-[#5f6f52]",children:[e.jsx(H,{className:"w-4 h-4"}),"Criar Meta",e.jsx(A,{className:"w-3 h-3"})]})]})});const h=v(a.goal_type),n=Je(a.target_date),l=Ye(a),c=Math.abs(a.current_weight-a.target_weight);return e.jsxs(p,{className:"border-l-4 border-l-[#5f6f52] hover:shadow-xl transition-all bg-gradient-to-br from-[#fefae0]/20 to-[#fefae0]/30 cursor-pointer h-full",onClick:()=>d(`/nutritionist/patients/${s}/goals`),children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"w-5 h-5 text-[#5f6f52]"}),e.jsx(S,{className:"text-base",children:"Meta Ativa"}),e.jsx(D,{variant:"outline",className:"bg-green-50 text-green-700 border-green-300 text-xs",children:"Em andamento"})]})}),e.jsxs(N,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-2",children:a.title}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-1",children:[e.jsx("span",{children:"Progresso"}),e.jsxs("span",{className:"font-semibold text-[#5f6f52]",children:[a.progress_percentage?.toFixed(0)||0,"%"]})]}),e.jsx(Le,{value:a.progress_percentage||0,className:"h-2"})]}),l&&e.jsx(D,{variant:"outline",className:`text-xs ${l.color}`,children:l.label})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-[#fefae0] border border-[#a9b388] rounded p-2 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-foreground",children:a.current_weight?.toFixed(1)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Peso Atual"})]}),e.jsxs("div",{className:"bg-[#fefae0] border border-[#5f6f52] rounded p-2 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-[#5f6f52]",children:a.target_weight?.toFixed(1)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Meta"})]})]}),e.jsxs("div",{className:"space-y-1 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Faltam:"}),e.jsxs("span",{className:"font-semibold text-foreground",children:[c.toFixed(1)," kg"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3"}),"Prazo:"]}),e.jsx("span",{className:"font-semibold text-foreground",children:n>0?`${n} dias`:"Prazo expirado"})]}),a.daily_calorie_goal&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"}),"Meta di√°ria:"]}),e.jsxs("span",{className:"font-semibold text-foreground",children:[Math.round(a.daily_calorie_goal)," kcal"]})]})]}),e.jsxs("div",{className:"text-xs pt-3 mt-3 border-t flex items-center justify-between",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Meta criada em ",new Date(a.start_date).toLocaleDateString("pt-BR")]}),e.jsxs(w,{variant:"ghost",size:"sm",className:"h-7 text-[#5f6f52] hover:bg-[#5f6f52]/10",onClick:()=>d(`/nutritionist/patients/${s}/goals`),children:["Abrir ",e.jsx(A,{className:"w-3 h-3 ml-1"})]})]})]})]})},u=()=>e.jsx(p,{className:"border-dashed border-2 border-[#a9b388] bg-[#fefae0]/30 hover:shadow-md transition-all",children:e.jsxs(N,{className:"py-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#fefae0] flex items-center justify-center mx-auto mb-3",children:e.jsx(K,{className:"w-6 h-6 text-[#5f6f52]"})}),e.jsx("h3",{className:"text-base font-semibold text-foreground mb-2",children:"Conquistas"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4 max-w-sm mx-auto",children:"Sistema de gamifica√ß√£o em desenvolvimento - Badges e conquistas para motivar o paciente"}),e.jsxs(w,{variant:"outline",onClick:()=>d(`/nutritionist/patients/${s}/achievements`),className:"gap-2 border-[#5f6f52] text-[#5f6f52] hover:bg-[#5f6f52]/10",children:[e.jsx(K,{className:"w-4 h-4"}),"Ver Conquistas"]})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-foreground mb-1",children:"Ades√£o ao Tratamento"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Metas, prescri√ß√µes e sistema de conquistas"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(b,{}),e.jsx(u,{})]})]})},Ys=()=>{const{patientId:s}=we(),g=F(),[d,a]=ye(),[o,f]=x.useState(()=>{const j=d.get("tab");return j||"feed"}),{loading:i,error:m,patientData:v,latestMetrics:b,modulesStatus:u,activities:h,activitiesLoading:n,refresh:l,loadActivities:c}=Xe(s),t=()=>{},r=()=>{g(`/chat/nutritionist/${s}`)},C=()=>{g("/nutritionist/agenda")},y=()=>{c(h.length+20)};return x.useEffect(()=>{d.get("tab")&&(d.delete("tab"),a(d,{replace:!0}))},[d,a]),i?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-card/80 backdrop-blur-md border-b border-border p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{className:"w-10 h-10 rounded-md"}),e.jsxs("div",{children:[e.jsx(k,{className:"h-5 w-32 mb-2"}),e.jsx(k,{className:"h-3 w-24"})]})]}),e.jsx(k,{className:"w-24 h-9"})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto w-full p-4 md:p-8 space-y-8",children:[e.jsxs(p,{children:[e.jsxs(_,{className:"flex flex-row items-start justify-between space-y-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{className:"h-20 w-20 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"h-6 w-48"}),e.jsx(k,{className:"h-4 w-32"}),e.jsx(k,{className:"h-4 w-40"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(k,{className:"h-10 w-24"}),e.jsx(k,{className:"h-10 w-24"})]})]}),e.jsx(N,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[1,2,3,4].map(j=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{className:"h-4 w-16"}),e.jsx(k,{className:"h-6 w-20"})]},j))})})]}),e.jsxs(p,{children:[e.jsx(_,{children:e.jsx(k,{className:"h-5 w-40"})}),e.jsx(N,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[1,2,3,4].map(j=>e.jsx(k,{className:"h-20 rounded-lg"},j))})})]}),e.jsxs(p,{children:[e.jsx(_,{children:e.jsx(k,{className:"h-10 w-full"})}),e.jsx(N,{className:"space-y-3",children:[1,2,3].map(j=>e.jsx(k,{className:"h-16 w-full"},j))})]})]})]}):m||!v?e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-background p-4",children:[e.jsxs(xe,{variant:"destructive",className:"max-w-md mb-6",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx(he,{children:m?.message||"Paciente n√£o encontrado ou voc√™ n√£o tem permiss√£o para visualiz√°-lo."})]}),e.jsx(w,{asChild:!0,variant:"outline",children:e.jsxs(I,{to:"/nutritionist/patients",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Voltar para Pacientes"]})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"bg-card/80 backdrop-blur-md border-b border-border p-4 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{to:"/nutritionist/patients",children:e.jsx(w,{variant:"ghost",size:"icon",children:e.jsx(re,{className:"w-5 h-5"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-semibold text-foreground text-lg",children:v.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Hub do Paciente"})]})]}),e.jsxs(w,{variant:"outline",size:"sm",onClick:l,className:"gap-2",children:[e.jsx(Fe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Atualizar"})]})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto w-full p-4 md:p-8 space-y-8",children:[e.jsx("section",{children:e.jsx(Ze,{patientData:v,latestMetrics:b,onEditProfile:t,onOpenChat:r,onScheduleAppointment:C})}),e.jsx("section",{children:e.jsx(Oe,{patientId:s,modulesStatus:u,latestMetrics:b})}),e.jsx("section",{children:e.jsxs(Ce,{value:o,onValueChange:f,className:"w-full",children:[e.jsxs(Ae,{className:"grid w-full grid-cols-3 lg:grid-cols-5 gap-1 h-auto p-1 bg-muted/30 rounded-lg",children:[e.jsxs(z,{value:"feed",className:"flex flex-col items-center justify-center gap-1.5 py-3 px-2 rounded-md transition-all data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-[#5f6f52] data-[state=inactive]:text-muted-foreground hover:text-foreground",children:[e.jsx(U,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Feed"})]}),e.jsxs(z,{value:"clinical",className:"flex flex-col items-center justify-center gap-1.5 py-3 px-2 rounded-md transition-all data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-[#5f6f52] data-[state=inactive]:text-muted-foreground hover:text-foreground",children:[e.jsx(Ke,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Cl√≠nico"})]}),e.jsxs(z,{value:"body",className:"flex flex-col items-center justify-center gap-1.5 py-3 px-2 rounded-md transition-all data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-[#5f6f52] data-[state=inactive]:text-muted-foreground hover:text-foreground",children:[e.jsx(ie,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Corporal"})]}),e.jsxs(z,{value:"nutrition",className:"flex flex-col items-center justify-center gap-1.5 py-3 px-2 rounded-md transition-all data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-[#5f6f52] data-[state=inactive]:text-muted-foreground hover:text-foreground",children:[e.jsx(L,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Nutri√ß√£o"})]}),e.jsxs(z,{value:"adherence",className:"flex flex-col items-center justify-center gap-1.5 py-3 px-2 rounded-md transition-all data-[state=active]:bg-background data-[state=active]:shadow-sm data-[state=active]:text-[#5f6f52] data-[state=inactive]:text-muted-foreground hover:text-foreground",children:[e.jsx(Qe,{className:"h-5 w-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Ades√£o"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx(G,{value:"feed",className:"m-0",children:e.jsx(ss,{patientId:s,activities:h,loading:n,onLoadMore:y})}),e.jsx(G,{value:"clinical",className:"m-0",children:e.jsx(ts,{patientId:s,modulesStatus:u})}),e.jsx(G,{value:"body",className:"m-0",children:e.jsx(as,{patientId:s,modulesStatus:u,latestMetrics:b})}),e.jsx(G,{value:"nutrition",className:"m-0",children:e.jsx(ls,{patientId:s,modulesStatus:u})}),e.jsx(G,{value:"adherence",className:"m-0",children:e.jsx(is,{patientId:s,modulesStatus:u})})]})]})})]})]})};export{Ys as default};
