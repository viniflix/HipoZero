import{q as pe,j as e,ai as se,aj as te,ak as ae,I as ue,al as re,B as N,au as le,v as fe,O as y,H as k,C as S,c as B,d as U,e as P,E as z,u as ge,b as je,a as be,r as p,s as A,P as Ne,m as G,M as ye,w as ve,D as _e,x as we,y as Me,z as J,F as Ce,aM as De,Q as ke,A as Se,h as Pe,i as Te,k as Fe,l as Ee,n as Oe,o as Ae,p as ze,ap as Re,a7 as $e}from"./index-CcAkuQOE.js";import{C as He}from"./calendar-DeSrfKBW.js";import{P as Le,a as qe,b as Ie}from"./popover-B-EzZgCP.js";import{P as W}from"./progress-DvMXjg5N.js";import{t as R}from"./mealTranslations-B1KHhmEq.js";import{B as Ge}from"./badge-DaJMa4dF.js";import{f as X}from"./measureTranslations-AG6EuUvS.js";import{E as We,a as Be}from"./jspdf.plugin.autotable-BJsFH-tU.js";import{D as Ue}from"./download-D_a5qc_k.js";import{u as Ye,B as Qe,W as Ve}from"./useNotifications-B2gUsTMD.js";import{E as Je}from"./eye-Br99OX-v.js";import{C as Xe}from"./chevron-left-Cv-N1T5h.js";import{F as Ze}from"./flame-5q_YoUwH.js";import{D as Ke}from"./droplet-DMOnYacG.js";import{P as Z}from"./plus-CaXHNMLp.js";import{P as es}from"./pen-square-CW-SimQB.js";import{i as ss}from"./isSameDay-BDpT3siV.js";import{i as K}from"./isToday-DghT-lz3.js";import{i as ts}from"./isYesterday-c2CIwdLa.js";import{i as as}from"./isTomorrow-BI7bK77D.js";import"./startOfMonth-CZeQkHhJ.js";import"./addMonths-B4JTX81v.js";import"./extends-CF3RwP-h.js";const ee=pe("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);function rs({open:u,onOpenChange:$,mealPlan:x,patientName:f}){if(!x)return null;const D=["breakfast","morning_snack","lunch","afternoon_snack","dinner","supper"],g=[...x.meal_plan_meals||[]].sort((s,h)=>D.indexOf(s.meal_type)-D.indexOf(h.meal_type)),v=g.reduce((s,h)=>{const o=(h.meal_plan_foods||[]).reduce((r,i)=>({calories:r.calories+(i.calories||0),protein:r.protein+(i.protein||0),carbs:r.carbs+(i.carbs||0),fat:r.fat+(i.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});return{calories:s.calories+o.calories,protein:s.protein+o.protein,carbs:s.carbs+o.carbs,fat:s.fat+o.fat}},{calories:0,protein:0,carbs:0,fat:0}),T=async()=>{const s=new We,h=s.internal.pageSize.width,_=s.internal.pageSize.height,o=[70,125,70],r=[68,64,60],i=[120,113,108],F=[245,245,244];let l=20;s.setFont("helvetica");try{const C=await(await fetch("https://afyoidxrshkmplxhcyeh.supabase.co/storage/v1/object/public/IDV/HIPOZERO%20(2).png")).blob();await new Promise(E=>{const w=new Image;w.onload=()=>{const m=h*.2,O=w.height/w.width*m,c=new FileReader;c.onloadend=()=>{const Q=c.result;s.addImage(Q,"PNG",14,10,m,O),E()},c.readAsDataURL(C)},w.src=URL.createObjectURL(C)})}catch(d){console.error("Erro ao carregar logo:",d)}s.setFontSize(20),s.setTextColor(...o),s.setFont("helvetica","bold"),s.text("Plano Alimentar",h/2,20,{align:"center"}),s.setDrawColor(...o),s.setLineWidth(.5),s.line(14,24,h-14,24),l=32,s.setFont("helvetica","normal"),s.setFontSize(10),s.setTextColor(...r),f&&(s.text(`Paciente: ${f}`,14,l),l+=5);const H=y(new Date(x.start_date),"dd 'de' MMMM 'de' yyyy",{locale:k}),Y=x.end_date?y(new Date(x.end_date),"dd 'de' MMMM 'de' yyyy",{locale:k}):"Indeterminado";s.text(`Período: ${H} até ${Y}`,14,l),l+=5,s.text(`Gerado em: ${y(new Date,"dd/MM/yyyy 'às' HH:mm")}`,14,l),l+=10,s.setFillColor(...F),s.roundedRect(14,l,h-28,20,2,2,"F"),s.setFontSize(9),s.setTextColor(...r),s.setFont("helvetica","bold"),s.text("Meta Diária Total:",18,l+6),s.setFont("helvetica","normal"),s.setTextColor(...i);const L=`${Math.round(v.calories)} kcal  •  Proteínas: ${Math.round(v.protein)}g  •  Carboidratos: ${Math.round(v.carbs)}g  •  Gorduras: ${Math.round(v.fat)}g`;s.text(L,18,l+13),l+=28;for(let d=0;d<g.length;d++){const M=g[d],C=M.meal_plan_foods||[],E=15+(C.length+1)*7+(M.notes?10:0);l+E>_-30&&(s.addPage(),l=20),s.setFontSize(12),s.setTextColor(...o),s.setFont("helvetica","bold");const w=R(M.meal_type),m=M.meal_time||"";if(s.text(`${w}${m?` • ${m}`:""}`,14,l),l+=7,C.length>0){const O=C.map(c=>[c.foods?.name||"Alimento",X(c.quantity||0,c.unit||"",c.measure),Math.round(c.calories||0),Math.round(c.protein||0),Math.round(c.carbs||0),Math.round(c.fat||0)]);Be(s,{startY:l,head:[["Alimento","Quantidade","Calorias","Proteína","Carboidrato","Gordura"]],body:O,theme:"striped",headStyles:{fillColor:o,textColor:[255,255,255],fontSize:9,fontStyle:"bold",halign:"center",font:"helvetica"},bodyStyles:{fontSize:8,textColor:r,font:"helvetica"},columnStyles:{0:{halign:"left",cellWidth:"auto"},1:{halign:"center",cellWidth:30},2:{halign:"center",cellWidth:23},3:{halign:"center",cellWidth:23},4:{halign:"center",cellWidth:28},5:{halign:"center",cellWidth:23}},alternateRowStyles:{fillColor:F},margin:{left:14,right:14}}),l=s.lastAutoTable.finalY+3}M.notes&&(s.setFontSize(8),s.setTextColor(...i),s.setFont("helvetica","italic"),s.text(`Obs: ${M.notes}`,14,l),l+=6),d<g.length-1&&(l+=5)}const q=s.internal.getNumberOfPages();for(let d=1;d<=q;d++)s.setPage(d),s.setFontSize(8),s.setTextColor(...i),s.setFont("helvetica","normal"),s.text(`Página ${d} de ${q}`,h-14,_-10,{align:"right"});const j=`plano-alimentar-${f?.replace(/\s+/g,"-").toLowerCase()||"paciente"}-${y(new Date,"dd-MM-yyyy")}.pdf`;s.save(j)};return e.jsx(se,{open:u,onOpenChange:$,children:e.jsxs(te,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ae,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-6 h-6 text-primary"}),e.jsx(re,{className:"text-2xl",children:"Meu Plano Alimentar"})]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:T,className:"gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Baixar PDF"]})]}),e.jsxs(le,{className:"flex items-center gap-2 pt-2",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsxs("span",{children:["Período: ",y(new Date(x.start_date),"dd 'de' MMMM",{locale:k})," até ",x.end_date?y(new Date(x.end_date),"dd 'de' MMMM 'de' yyyy",{locale:k}):"indeterminado"]})]})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs(S,{className:"bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20",children:[e.jsx(B,{className:"pb-3",children:e.jsx(U,{className:"text-base text-primary",children:"Meta Diária Total"})}),e.jsx(P,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:Math.round(v.calories)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Calorias"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Math.round(v.protein),"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Proteínas"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Math.round(v.carbs),"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Carboidratos"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Math.round(v.fat),"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gorduras"})]})]})})]}),e.jsx("div",{className:"space-y-4",children:g.length>0?g.map((s,h)=>{const _=s.meal_plan_foods||[],o=_.reduce((r,i)=>({calories:r.calories+(i.calories||0),protein:r.protein+(i.protein||0),carbs:r.carbs+(i.carbs||0),fat:r.fat+(i.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});return e.jsxs(S,{className:"border-l-4 border-l-primary",children:[e.jsxs(B,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-primary"}),e.jsx(U,{className:"text-lg",children:R(s.meal_type)}),s.meal_time&&e.jsx(Ge,{variant:"outline",className:"text-xs",children:s.meal_time})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm font-bold text-primary",children:[Math.round(o.calories)," kcal"]})})]}),s.name&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.name})]}),e.jsx(P,{children:_.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"text-left p-2 font-semibold",children:"Alimento"}),e.jsx("th",{className:"text-right p-2 font-semibold",children:"Quantidade"}),e.jsx("th",{className:"text-right p-2 font-semibold",children:"Calorias"}),e.jsx("th",{className:"text-right p-2 font-semibold hidden md:table-cell",children:"Prot."}),e.jsx("th",{className:"text-right p-2 font-semibold hidden md:table-cell",children:"Carb."}),e.jsx("th",{className:"text-right p-2 font-semibold hidden md:table-cell",children:"Gord."})]})}),e.jsx("tbody",{children:_.map((r,i)=>e.jsxs("tr",{className:"border-b last:border-0 hover:bg-muted/30",children:[e.jsx("td",{className:"p-2",children:r.foods?.name||"Alimento"}),e.jsx("td",{className:"p-2 text-right whitespace-nowrap",children:X(r.quantity||0,r.unit||"",r.measure)}),e.jsxs("td",{className:"p-2 text-right font-medium whitespace-nowrap",children:[Math.round(r.calories||0)," kcal"]}),e.jsxs("td",{className:"p-2 text-right text-muted-foreground hidden md:table-cell",children:[Math.round(r.protein||0),"g"]}),e.jsxs("td",{className:"p-2 text-right text-muted-foreground hidden md:table-cell",children:[Math.round(r.carbs||0),"g"]}),e.jsxs("td",{className:"p-2 text-right text-muted-foreground hidden md:table-cell",children:[Math.round(r.fat||0),"g"]})]},i))})]})}),e.jsxs("div",{className:"md:hidden mt-3 p-2 bg-muted/30 rounded text-xs",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Totais desta refeição:"}),e.jsxs("p",{className:"text-muted-foreground",children:["P: ",Math.round(o.protein),"g | C: ",Math.round(o.carbs),"g | G: ",Math.round(o.fat),"g"]})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum alimento cadastrado nesta refeição"})})]},h)}):e.jsx(S,{children:e.jsxs(P,{className:"py-8 text-center",children:[e.jsx(z,{className:"w-12 h-12 text-muted-foreground/50 mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:"Nenhuma refeição cadastrada neste plano"})]})})})]})]})})}function ks(){const{user:u}=ge(),$=je(),{toast:x}=be(),[f,D]=p.useState(new Date),[g,v]=p.useState([]),[T,s]=p.useState(null),[h,_]=p.useState(!0),[o,r]=p.useState(!1),[i,F]=p.useState(null),[l,H]=p.useState(!1),[Y,L]=p.useState(!1),{unreadCount:q}=Ye(),[j,d]=p.useState(null),M=[{key:"breakfast",label:"Café da Manhã"},{key:"morning_snack",label:"Lanche da Manhã"},{key:"lunch",label:"Almoço"},{key:"afternoon_snack",label:"Lanche da Tarde"},{key:"dinner",label:"Jantar"},{key:"supper",label:"Ceia"}],C=T?.meal_plan_meals?.map(t=>t.meal_type)||[],E=p.useCallback(async()=>{if(!u)return;const t=y(new Date,"yyyy-MM-dd"),{data:n}=await A.from("meal_plans").select(`
        *,
        meal_plan_meals (
          *,
          meal_plan_foods (
            *,
            foods (id, name)
          )
        )
      `).eq("patient_id",u.id).eq("is_active",!0).lte("start_date",t).or(`end_date.is.null,end_date.gte.${t}`).maybeSingle();s(n);const{data:a}=await A.from("prescriptions").select("calories, protein, carbs, fat, start_date, end_date").eq("patient_id",u.id).lte("start_date",t).or(`end_date.is.null,end_date.gte.${t}`).maybeSingle();a&&d({calories:a.calories||0,protein:a.protein||0,carbs:a.carbs||0,fat:a.fat||0})},[u]),w=p.useCallback(async()=>{if(!u)return;_(!0);const t=y(f,"yyyy-MM-dd"),{data:n,error:a}=await A.from("meals").select(`
        *,
        meal_items (
          *,
          foods (
            id,
            name
          )
        )
      `).eq("patient_id",u.id).eq("meal_date",t).is("deleted_at",null).order("created_at",{ascending:!0});a?(console.error("Erro ao carregar refeições:",a),x({title:"Erro",description:"Não foi possível carregar as refeições.",variant:"destructive"})):v(n||[]),_(!1)},[u,f,x]);p.useEffect(()=>{E()},[E]),p.useEffect(()=>{w()},[w]);const m=g.reduce((t,n)=>({calories:t.calories+(n.total_calories||0),protein:t.protein+(n.total_protein||0),carbs:t.carbs+(n.total_carbs||0),fat:t.fat+(n.total_fat||0)}),{calories:0,protein:0,carbs:0,fat:0}),O=[...new Set(g.map(t=>t.meal_type))],c=[...new Set([...C,...O])],Q=c.reduce((t,n)=>(t[n]=g.filter(a=>a.meal_type===n),t),{}),ie=()=>{D(t=>Re(t,1))},ne=()=>{D(t=>$e(t,1))},oe=()=>{D(new Date)},ce=t=>K(t)?"HOJE":ts(t)?"ONTEM":as(t)?"AMANHÃ":y(t,"dd 'de' MMMM",{locale:k}),de=t=>y(t,"EEEE, dd 'de' MMMM 'de' yyyy",{locale:k}),me=async()=>{if(!i)return;const t=g.find(a=>a.id===i),{error:n}=await A.from("meals").update({deleted_at:new Date().toISOString()}).eq("id",i);n?x({title:"Erro",description:"Não foi possível excluir a refeição.",variant:"destructive"}):(t&&await A.rpc("log_meal_action",{p_patient_id:u.id,p_meal_id:i,p_action:"delete",p_meal_type:t.meal_type,p_meal_date:t.meal_date,p_meal_time:t.meal_time,p_details:{total_calories:t.total_calories,total_protein:t.total_protein,total_carbs:t.total_carbs,total_fat:t.total_fat,items:(t.meal_items||[]).map(a=>({food_id:a.food_id,name:a.name,quantity:a.quantity,unit:a.unit,calories:a.calories,protein:a.protein,carbs:a.carbs,fat:a.fat})),deleted_at:new Date().toISOString()}}),x({title:"Sucesso",description:"Refeição excluída com sucesso."}),w()),F(null)},I=t=>{const n=T?.meal_plan_meals?.find(a=>a.meal_type===t);$("/patient/add-meal",{state:{mealType:t,mealTime:n?.meal_time||y(new Date,"HH:mm"),mealName:n?.name||"",recommendedFoods:n?.meal_plan_foods||[]}}),r(!1)};return e.jsxs("div",{className:"flex flex-col min-h-screen bg-background",children:[e.jsxs("div",{className:"max-w-7xl mx-auto w-full px-4 md:px-8 py-8 space-y-6",children:[e.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Diário Alimentar"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Registre suas refeições do dia"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[T&&e.jsxs(N,{variant:"ghost",size:"sm",onClick:()=>H(!0),className:"text-muted-foreground hover:text-foreground",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Ver Plano"})]}),e.jsxs(N,{variant:"ghost",size:"icon",onClick:()=>L(!0),className:"relative",children:[e.jsx(Ne,{className:"w-6 h-6 text-gray-700"}),q>0&&e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]})]})]}),e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(S,{className:"border-0 shadow-sm",children:e.jsxs(P,{className:"pt-6 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx(N,{variant:"ghost",size:"icon",onClick:ie,className:"flex-shrink-0",children:e.jsx(Xe,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1 text-center",children:e.jsxs(Le,{children:[e.jsx(qe,{asChild:!0,children:e.jsxs("button",{className:"hover:opacity-80 transition-opacity",children:[e.jsx("h2",{className:"text-2xl font-bold text-primary",children:ce(f)}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize mt-1",children:de(f)})]})}),e.jsx(Ie,{className:"w-auto p-0",align:"center",children:e.jsx(He,{mode:"single",selected:f,onSelect:t=>t&&D(t),initialFocus:!0,locale:k})})]})}),e.jsx(N,{variant:"ghost",size:"icon",onClick:ne,className:"flex-shrink-0",disabled:ss(f,new Date),children:e.jsx(ye,{className:"h-5 w-5"})})]}),!K(f)&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx(N,{variant:"ghost",size:"sm",onClick:oe,className:"text-primary hover:text-primary/80",children:"Ir para Hoje"})})]})})}),j&&e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(S,{className:"border-[#5f6f52]/20 shadow-sm",children:[e.jsxs(B,{className:"pb-4",children:[e.jsx(U,{className:"text-lg text-[#5f6f52]",children:"Progresso do Dia"}),e.jsx(ve,{children:"Consumido vs Meta"})]}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Calorias"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(m.calories)," / ",Math.round(j.calories)," kcal"]})]}),e.jsx(W,{value:Math.min(m.calories/j.calories*100,100),className:"h-3",indicatorClassName:"bg-gradient-to-r from-orange-500 to-red-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"w-4 h-4 text-sky-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Proteínas"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(m.protein)," / ",Math.round(j.protein),"g"]})]}),e.jsx(W,{value:Math.min(m.protein/j.protein*100,100),className:"h-3",indicatorClassName:"bg-sky-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Carboidratos"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(m.carbs)," / ",Math.round(j.carbs),"g"]})]}),e.jsx(W,{value:Math.min(m.carbs/j.carbs*100,100),className:"h-3",indicatorClassName:"bg-amber-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Gorduras"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(m.fat)," / ",Math.round(j.fat),"g"]})]}),e.jsx(W,{value:Math.min(m.fat/j.fat*100,100),className:"h-3",indicatorClassName:"bg-yellow-500"})]})]})]})}),e.jsx("div",{className:"space-y-4",children:c.map((t,n)=>{const a=Q[t]||[],xe=a.length>0;return e.jsx(G.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+n*.05},children:xe?e.jsxs(S,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(B,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-[#5f6f52]"}),e.jsx(U,{className:"text-base",children:R(t)})]}),e.jsxs(N,{size:"sm",variant:"outline",onClick:()=>I(t),className:"border-[#5f6f52]/30 text-[#5f6f52] hover:bg-[#5f6f52]/10",children:[e.jsx(Z,{className:"w-4 h-4 mr-1"}),"Adicionar mais"]})]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-3",children:a.map(b=>e.jsxs(G.div,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"border rounded-lg p-4 bg-background hover:bg-muted/30 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("h4",{className:"text-sm font-semibold text-foreground",children:R(t)})}),e.jsxs("p",{className:"text-lg font-bold text-[#5f6f52]",children:[b.total_calories?.toFixed(0)," kcal"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["P: ",b.total_protein?.toFixed(1),"g • C: ",b.total_carbs?.toFixed(1),"g • G: ",b.total_fat?.toFixed(1),"g"]})]}),e.jsxs(_e,{children:[e.jsx(we,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ee,{className:"w-4 h-4"})})}),e.jsxs(Me,{align:"end",children:[e.jsxs(J,{onClick:()=>$("/patient/add-meal",{state:{editMode:!0,mealId:b.id}}),children:[e.jsx(es,{className:"w-4 h-4 mr-2"}),"Editar"]}),e.jsxs(J,{onClick:()=>F(b.id),className:"text-destructive focus:text-destructive",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Excluir"]})]})]})]}),b.meal_items?.length>0&&e.jsx("div",{className:"space-y-2 mt-3 pt-3 border-t",children:b.meal_items.map((V,he)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-foreground",children:V.foods?.name||"Alimento desconhecido"}),e.jsxs("span",{className:"font-medium text-muted-foreground",children:[V.quantity," ",V.measure]})]},he))})]},b.id))})})]}):e.jsx(S,{className:"border-2 border-dashed border-muted-foreground/30 bg-muted/20 hover:bg-muted/30 hover:border-primary/40 transition-all cursor-pointer",onClick:()=>I(t),children:e.jsx(P,{className:"py-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:e.jsx(z,{className:"w-6 h-6 text-primary/60"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-base font-semibold text-muted-foreground",children:["Registrar ",R(t)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Clique para adicionar alimentos"})]}),e.jsxs(N,{size:"sm",className:"mt-2 bg-primary hover:bg-primary/90",onClick:b=>{b.stopPropagation(),I(t)},children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Adicionar"]})]})})})},t)})}),e.jsxs(se,{open:o,onOpenChange:r,children:[e.jsx(De,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:"w-full",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Registrar Outra Refeição"]})}),e.jsxs(te,{children:[e.jsxs(ae,{children:[e.jsx(re,{children:"Escolha o Tipo de Refeição"}),e.jsx(le,{children:"Selecione qual refeição deseja registrar"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 py-4",children:M.map(t=>e.jsxs(N,{variant:"outline",className:"justify-start",onClick:()=>I(t.key),children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),t.label]},t.key))})]})]})]}),e.jsx(rs,{open:l,onOpenChange:H,mealPlan:T,patientName:u?.profile?.name}),e.jsx(ke,{isOpen:Y,setIsOpen:L}),e.jsx(Se,{open:!!i,onOpenChange:()=>F(null),children:e.jsxs(Pe,{children:[e.jsxs(Te,{children:[e.jsx(Fe,{children:"Excluir Refeição"}),e.jsx(Ee,{children:"Deseja realmente excluir esta refeição? Esta ação não pode ser desfeita."})]}),e.jsxs(Oe,{children:[e.jsx(Ae,{children:"Cancelar"}),e.jsx(ze,{onClick:me,className:"bg-destructive hover:bg-destructive/90",children:"Excluir"})]})]})}),h&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})]})}export{ks as default};
