import{q as rt,ay as W,r as c,aC as xe,j as e,aA as st,aB as A,aw as T,aD as le,az as de,aH as at,ax as ge,aI as he,R as ue,ao as nt,aJ as B,a as ot,ai as it,aj as ct,ak as lt,al as dt,B as H,au as ut,C as Q,c as Z,d as ee,w as te,e as re,an as mt,X as pt}from"./index-8A5oU7H6.js";import{I as G}from"./input-o0NOJkdo.js";import{L as F}from"./label-DQiAuImi.js";import{u as _e}from"./index-BUAT_-LN.js";import{P as ft,a as gt,b as xt}from"./popover-BV9Q1F2u.js";import"./alert-Bq3bhyJq.js";import{getReferenceValues as ht,saveReferenceValues as _t}from"./meal-plan-queries-OSra25AJ.js";import{I as vt}from"./info-C7iZwLtP.js";import{S as bt}from"./save-C8PvBHCT.js";const jt=rt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);function V(t,r,{checkForDefaultPrevented:a=!0}={}){return function(i){if(t?.(i),a===!1||!i.defaultPrevented)return r?.(i)}}var se="rovingFocusGroup.onEntryFocus",wt={bubbles:!1,cancelable:!0},z="RovingFocusGroup",[ae,ve,Nt]=xe(z),[yt,be]=W(z,[Nt]),[kt,St]=yt(z),je=c.forwardRef((t,r)=>e.jsx(ae.Provider,{scope:t.__scopeRovingFocusGroup,children:e.jsx(ae.Slot,{scope:t.__scopeRovingFocusGroup,children:e.jsx(Rt,{...t,ref:r})})}));je.displayName=z;var Rt=c.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:a,orientation:n,loop:i=!1,dir:m,currentTabStopId:u,defaultCurrentTabStopId:p,onCurrentTabStopIdChange:s,onEntryFocus:f,preventScrollOnEntryFocus:l=!1,...d}=t,h=c.useRef(null),g=T(r,h),_=le(m),[v,x]=de({prop:u,defaultProp:p??null,onChange:s,caller:z}),[N,M]=c.useState(!1),y=at(f),k=ve(a),D=c.useRef(!1),[I,O]=c.useState(0);return c.useEffect(()=>{const o=h.current;if(o)return o.addEventListener(se,y),()=>o.removeEventListener(se,y)},[y]),e.jsx(kt,{scope:a,orientation:n,dir:_,loop:i,currentTabStopId:v,onItemFocus:c.useCallback(o=>x(o),[x]),onItemShiftTab:c.useCallback(()=>M(!0),[]),onFocusableItemAdd:c.useCallback(()=>O(o=>o+1),[]),onFocusableItemRemove:c.useCallback(()=>O(o=>o-1),[]),children:e.jsx(A.div,{tabIndex:N||I===0?-1:0,"data-orientation":n,...d,ref:g,style:{outline:"none",...t.style},onMouseDown:V(t.onMouseDown,()=>{D.current=!0}),onFocus:V(t.onFocus,o=>{const w=!D.current;if(o.target===o.currentTarget&&w&&!N){const b=new CustomEvent(se,wt);if(o.currentTarget.dispatchEvent(b),!b.defaultPrevented){const j=k().filter(E=>E.focusable),S=j.find(E=>E.active),R=j.find(E=>E.id===v),C=[S,R,...j].filter(Boolean).map(E=>E.ref.current);ye(C,l)}}D.current=!1}),onBlur:V(t.onBlur,()=>M(!1))})})}),we="RovingFocusGroupItem",Ne=c.forwardRef((t,r)=>{const{__scopeRovingFocusGroup:a,focusable:n=!0,active:i=!1,tabStopId:m,children:u,...p}=t,s=st(),f=m||s,l=St(we,a),d=l.currentTabStopId===f,h=ve(a),{onFocusableItemAdd:g,onFocusableItemRemove:_,currentTabStopId:v}=l;return c.useEffect(()=>{if(n)return g(),()=>_()},[n,g,_]),e.jsx(ae.ItemSlot,{scope:a,id:f,focusable:n,active:i,children:e.jsx(A.span,{tabIndex:d?0:-1,"data-orientation":l.orientation,...p,ref:r,onMouseDown:V(t.onMouseDown,x=>{n?l.onItemFocus(f):x.preventDefault()}),onFocus:V(t.onFocus,()=>l.onItemFocus(f)),onKeyDown:V(t.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){l.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const N=Pt(x,l.orientation,l.dir);if(N!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let y=h().filter(k=>k.focusable).map(k=>k.ref.current);if(N==="last")y.reverse();else if(N==="prev"||N==="next"){N==="prev"&&y.reverse();const k=y.indexOf(x.currentTarget);y=l.loop?It(y,k+1):y.slice(k+1)}setTimeout(()=>ye(y))}}),children:typeof u=="function"?u({isCurrentTabStop:d,hasTabStop:v!=null}):u})})});Ne.displayName=we;var Ct={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Et(t,r){return r!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Pt(t,r,a){const n=Et(t.key,a);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Ct[n]}function ye(t,r=!1){const a=document.activeElement;for(const n of t)if(n===a||(n.focus({preventScroll:r}),document.activeElement!==a))return}function It(t,r){return t.map((a,n)=>t[(r+n)%t.length])}var Ft=je,Mt=Ne;function Dt(t,r){return c.useReducer((a,n)=>r[a][n]??a,t)}var ke=t=>{const{present:r,children:a}=t,n=At(r),i=typeof a=="function"?a({present:n.isPresent}):c.Children.only(a),m=T(n.ref,Tt(i));return typeof a=="function"||n.isPresent?c.cloneElement(i,{ref:m}):null};ke.displayName="Presence";function At(t){const[r,a]=c.useState(),n=c.useRef(null),i=c.useRef(t),m=c.useRef("none"),u=t?"mounted":"unmounted",[p,s]=Dt(u,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return c.useEffect(()=>{const f=q(n.current);m.current=p==="mounted"?f:"none"},[p]),ge(()=>{const f=n.current,l=i.current;if(l!==t){const h=m.current,g=q(f);t?s("MOUNT"):g==="none"||f?.display==="none"?s("UNMOUNT"):s(l&&h!==g?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,s]),ge(()=>{if(r){let f;const l=r.ownerDocument.defaultView??window,d=g=>{const v=q(n.current).includes(CSS.escape(g.animationName));if(g.target===r&&v&&(s("ANIMATION_END"),!i.current)){const x=r.style.animationFillMode;r.style.animationFillMode="forwards",f=l.setTimeout(()=>{r.style.animationFillMode==="forwards"&&(r.style.animationFillMode=x)})}},h=g=>{g.target===r&&(m.current=q(n.current))};return r.addEventListener("animationstart",h),r.addEventListener("animationcancel",d),r.addEventListener("animationend",d),()=>{l.clearTimeout(f),r.removeEventListener("animationstart",h),r.removeEventListener("animationcancel",d),r.removeEventListener("animationend",d)}}else s("ANIMATION_END")},[r,s]),{isPresent:["mounted","unmountSuspended"].includes(p),ref:c.useCallback(f=>{n.current=f?getComputedStyle(f):null,a(f)},[])}}function q(t){return t?.animationName||"none"}function Tt(t){let r=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,a=r&&"isReactWarning"in r&&r.isReactWarning;return a?t.ref:(r=Object.getOwnPropertyDescriptor(t,"ref")?.get,a=r&&"isReactWarning"in r&&r.isReactWarning,a?t.props.ref:t.props.ref||t.ref)}var me="Radio",[Ot,Se]=W(me),[Vt,Gt]=Ot(me),Re=c.forwardRef((t,r)=>{const{__scopeRadio:a,name:n,checked:i=!1,required:m,disabled:u,value:p="on",onCheck:s,form:f,...l}=t,[d,h]=c.useState(null),g=T(r,x=>h(x)),_=c.useRef(!1),v=d?f||!!d.closest("form"):!0;return e.jsxs(Vt,{scope:a,checked:i,disabled:u,children:[e.jsx(A.button,{type:"button",role:"radio","aria-checked":i,"data-state":Ie(i),"data-disabled":u?"":void 0,disabled:u,value:p,...l,ref:g,onClick:V(t.onClick,x=>{i||s?.(),v&&(_.current=x.isPropagationStopped(),_.current||x.stopPropagation())})}),v&&e.jsx(Pe,{control:d,bubbles:!_.current,name:n,value:p,checked:i,required:m,disabled:u,form:f,style:{transform:"translateX(-100%)"}})]})});Re.displayName=me;var Ce="RadioIndicator",Ee=c.forwardRef((t,r)=>{const{__scopeRadio:a,forceMount:n,...i}=t,m=Gt(Ce,a);return e.jsx(ke,{present:n||m.checked,children:e.jsx(A.span,{"data-state":Ie(m.checked),"data-disabled":m.disabled?"":void 0,...i,ref:r})})});Ee.displayName=Ce;var Kt="RadioBubbleInput",Pe=c.forwardRef(({__scopeRadio:t,control:r,checked:a,bubbles:n=!0,...i},m)=>{const u=c.useRef(null),p=T(u,m),s=_e(a),f=he(r);return c.useEffect(()=>{const l=u.current;if(!l)return;const d=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(d,"checked").set;if(s!==a&&g){const _=new Event("click",{bubbles:n});g.call(l,a),l.dispatchEvent(_)}},[s,a,n]),e.jsx(A.input,{type:"radio","aria-hidden":!0,defaultChecked:a,...i,tabIndex:-1,ref:p,style:{...i.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Pe.displayName=Kt;function Ie(t){return t?"checked":"unchecked"}var Lt=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],X="RadioGroup",[Bt]=W(X,[be,Se]),Fe=be(),Me=Se(),[Ut,$t]=Bt(X),De=c.forwardRef((t,r)=>{const{__scopeRadioGroup:a,name:n,defaultValue:i,value:m,required:u=!1,disabled:p=!1,orientation:s,dir:f,loop:l=!0,onValueChange:d,...h}=t,g=Fe(a),_=le(f),[v,x]=de({prop:m,defaultProp:i??null,onChange:d,caller:X});return e.jsx(Ut,{scope:a,name:n,required:u,disabled:p,value:v,onValueChange:x,children:e.jsx(Ft,{asChild:!0,...g,orientation:s,dir:_,loop:l,children:e.jsx(A.div,{role:"radiogroup","aria-required":u,"aria-orientation":s,"data-disabled":p?"":void 0,dir:_,...h,ref:r})})})});De.displayName=X;var Ae="RadioGroupItem",Te=c.forwardRef((t,r)=>{const{__scopeRadioGroup:a,disabled:n,...i}=t,m=$t(Ae,a),u=m.disabled||n,p=Fe(a),s=Me(a),f=c.useRef(null),l=T(r,f),d=m.value===i.value,h=c.useRef(!1);return c.useEffect(()=>{const g=v=>{Lt.includes(v.key)&&(h.current=!0)},_=()=>h.current=!1;return document.addEventListener("keydown",g),document.addEventListener("keyup",_),()=>{document.removeEventListener("keydown",g),document.removeEventListener("keyup",_)}},[]),e.jsx(Mt,{asChild:!0,...p,focusable:!u,active:d,children:e.jsx(Re,{disabled:u,required:m.required,checked:d,...s,...i,name:m.name,ref:l,onCheck:()=>m.onValueChange(i.value),onKeyDown:V(g=>{g.key==="Enter"&&g.preventDefault()}),onFocus:V(i.onFocus,()=>{h.current&&f.current?.click()})})})});Te.displayName=Ae;var zt="RadioGroupIndicator",Oe=c.forwardRef((t,r)=>{const{__scopeRadioGroup:a,...n}=t,i=Me(a);return e.jsx(Ee,{...i,...n,ref:r})});Oe.displayName=zt;var Ve=De,Ge=Te,Ht=Oe;const ne=c.forwardRef(({className:t,...r},a)=>e.jsx(Ve,{className:ue("grid gap-2",t),...r,ref:a}));ne.displayName=Ve.displayName;const $=c.forwardRef(({className:t,...r},a)=>e.jsx(Ge,{ref:a,className:ue("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:e.jsx(Ht,{className:"flex items-center justify-center",children:e.jsx(nt,{className:"h-2.5 w-2.5 fill-current text-current"})})}));$.displayName=Ge.displayName;function Ke(t,[r,a]){return Math.min(a,Math.max(r,t))}var Le=["PageUp","PageDown"],Be=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ue={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},U="Slider",[oe,qt,Yt]=xe(U),[$e]=W(U,[Yt]),[Wt,J]=$e(U),ze=c.forwardRef((t,r)=>{const{name:a,min:n=0,max:i=100,step:m=1,orientation:u="horizontal",disabled:p=!1,minStepsBetweenThumbs:s=0,defaultValue:f=[n],value:l,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:g=!1,form:_,...v}=t,x=c.useRef(new Set),N=c.useRef(0),y=u==="horizontal"?Xt:Jt,[k=[],D]=de({prop:l,defaultProp:f,onChange:j=>{[...x.current][N.current]?.focus(),d(j)}}),I=c.useRef(k);function O(j){const S=rr(k,j);b(j,S)}function o(j){b(j,N.current)}function w(){const j=I.current[N.current];k[N.current]!==j&&h(k)}function b(j,S,{commit:R}={commit:!1}){const P=or(m),C=ir(Math.round((j-n)/m)*m+n,P),E=Ke(C,[n,i]);D((L=[])=>{const K=er(L,E,S);if(nr(K,s*m)){N.current=K.indexOf(E);const fe=String(K)!==String(L);return fe&&R&&h(K),fe?K:L}else return L})}return e.jsx(Wt,{scope:t.__scopeSlider,name:a,disabled:p,min:n,max:i,valueIndexToChangeRef:N,thumbs:x.current,values:k,orientation:u,form:_,children:e.jsx(oe.Provider,{scope:t.__scopeSlider,children:e.jsx(oe.Slot,{scope:t.__scopeSlider,children:e.jsx(y,{"aria-disabled":p,"data-disabled":p?"":void 0,...v,ref:r,onPointerDown:B(v.onPointerDown,()=>{p||(I.current=k)}),min:n,max:i,inverted:g,onSlideStart:p?void 0:O,onSlideMove:p?void 0:o,onSlideEnd:p?void 0:w,onHomeKeyDown:()=>!p&&b(n,0,{commit:!0}),onEndKeyDown:()=>!p&&b(i,k.length-1,{commit:!0}),onStepKeyDown:({event:j,direction:S})=>{if(!p){const C=Le.includes(j.key)||j.shiftKey&&Be.includes(j.key)?10:1,E=N.current,L=k[E],K=m*C*S;b(L+K,E,{commit:!0})}}})})})})});ze.displayName=U;var[He,qe]=$e(U,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Xt=c.forwardRef((t,r)=>{const{min:a,max:n,dir:i,inverted:m,onSlideStart:u,onSlideMove:p,onSlideEnd:s,onStepKeyDown:f,...l}=t,[d,h]=c.useState(null),g=T(r,y=>h(y)),_=c.useRef(void 0),v=le(i),x=v==="ltr",N=x&&!m||!x&&m;function M(y){const k=_.current||d.getBoundingClientRect(),D=[0,k.width],O=pe(D,N?[a,n]:[n,a]);return _.current=k,O(y-k.left)}return e.jsx(He,{scope:t.__scopeSlider,startEdge:N?"left":"right",endEdge:N?"right":"left",direction:N?1:-1,size:"width",children:e.jsx(Ye,{dir:v,"data-orientation":"horizontal",...l,ref:g,style:{...l.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:y=>{const k=M(y.clientX);u?.(k)},onSlideMove:y=>{const k=M(y.clientX);p?.(k)},onSlideEnd:()=>{_.current=void 0,s?.()},onStepKeyDown:y=>{const D=Ue[N?"from-left":"from-right"].includes(y.key);f?.({event:y,direction:D?-1:1})}})})}),Jt=c.forwardRef((t,r)=>{const{min:a,max:n,inverted:i,onSlideStart:m,onSlideMove:u,onSlideEnd:p,onStepKeyDown:s,...f}=t,l=c.useRef(null),d=T(r,l),h=c.useRef(void 0),g=!i;function _(v){const x=h.current||l.current.getBoundingClientRect(),N=[0,x.height],y=pe(N,g?[n,a]:[a,n]);return h.current=x,y(v-x.top)}return e.jsx(He,{scope:t.__scopeSlider,startEdge:g?"bottom":"top",endEdge:g?"top":"bottom",size:"height",direction:g?1:-1,children:e.jsx(Ye,{"data-orientation":"vertical",...f,ref:d,style:{...f.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:v=>{const x=_(v.clientY);m?.(x)},onSlideMove:v=>{const x=_(v.clientY);u?.(x)},onSlideEnd:()=>{h.current=void 0,p?.()},onStepKeyDown:v=>{const N=Ue[g?"from-bottom":"from-top"].includes(v.key);s?.({event:v,direction:N?-1:1})}})})}),Ye=c.forwardRef((t,r)=>{const{__scopeSlider:a,onSlideStart:n,onSlideMove:i,onSlideEnd:m,onHomeKeyDown:u,onEndKeyDown:p,onStepKeyDown:s,...f}=t,l=J(U,a);return e.jsx(A.span,{...f,ref:r,onKeyDown:B(t.onKeyDown,d=>{d.key==="Home"?(u(d),d.preventDefault()):d.key==="End"?(p(d),d.preventDefault()):Le.concat(Be).includes(d.key)&&(s(d),d.preventDefault())}),onPointerDown:B(t.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),l.thumbs.has(h)?h.focus():n(d)}),onPointerMove:B(t.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&i(d)}),onPointerUp:B(t.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),m(d))})})}),We="SliderTrack",Xe=c.forwardRef((t,r)=>{const{__scopeSlider:a,...n}=t,i=J(We,a);return e.jsx(A.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...n,ref:r})});Xe.displayName=We;var ie="SliderRange",Je=c.forwardRef((t,r)=>{const{__scopeSlider:a,...n}=t,i=J(ie,a),m=qe(ie,a),u=c.useRef(null),p=T(r,u),s=i.values.length,f=i.values.map(h=>et(h,i.min,i.max)),l=s>1?Math.min(...f):0,d=100-Math.max(...f);return e.jsx(A.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...n,ref:p,style:{...t.style,[m.startEdge]:l+"%",[m.endEdge]:d+"%"}})});Je.displayName=ie;var ce="SliderThumb",Qe=c.forwardRef((t,r)=>{const a=qt(t.__scopeSlider),[n,i]=c.useState(null),m=T(r,p=>i(p)),u=c.useMemo(()=>n?a().findIndex(p=>p.ref.current===n):-1,[a,n]);return e.jsx(Qt,{...t,ref:m,index:u})}),Qt=c.forwardRef((t,r)=>{const{__scopeSlider:a,index:n,name:i,...m}=t,u=J(ce,a),p=qe(ce,a),[s,f]=c.useState(null),l=T(r,M=>f(M)),d=s?u.form||!!s.closest("form"):!0,h=he(s),g=u.values[n],_=g===void 0?0:et(g,u.min,u.max),v=tr(n,u.values.length),x=h?.[p.size],N=x?sr(x,_,p.direction):0;return c.useEffect(()=>{if(s)return u.thumbs.add(s),()=>{u.thumbs.delete(s)}},[s,u.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[p.startEdge]:`calc(${_}% + ${N}px)`},children:[e.jsx(oe.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(A.span,{role:"slider","aria-label":t["aria-label"]||v,"aria-valuemin":u.min,"aria-valuenow":g,"aria-valuemax":u.max,"aria-orientation":u.orientation,"data-orientation":u.orientation,"data-disabled":u.disabled?"":void 0,tabIndex:u.disabled?void 0:0,...m,ref:l,style:g===void 0?{display:"none"}:t.style,onFocus:B(t.onFocus,()=>{u.valueIndexToChangeRef.current=n})})}),d&&e.jsx(Ze,{name:i??(u.name?u.name+(u.values.length>1?"[]":""):void 0),form:u.form,value:g},n)]})});Qe.displayName=ce;var Zt="RadioBubbleInput",Ze=c.forwardRef(({__scopeSlider:t,value:r,...a},n)=>{const i=c.useRef(null),m=T(i,n),u=_e(r);return c.useEffect(()=>{const p=i.current;if(!p)return;const s=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(s,"value").set;if(u!==r&&l){const d=new Event("input",{bubbles:!0});l.call(p,r),p.dispatchEvent(d)}},[u,r]),e.jsx(A.input,{style:{display:"none"},...a,ref:m,defaultValue:r})});Ze.displayName=Zt;function er(t=[],r,a){const n=[...t];return n[a]=r,n.sort((i,m)=>i-m)}function et(t,r,a){const m=100/(a-r)*(t-r);return Ke(m,[0,100])}function tr(t,r){return r>2?`Value ${t+1} of ${r}`:r===2?["Minimum","Maximum"][t]:void 0}function rr(t,r){if(t.length===1)return 0;const a=t.map(i=>Math.abs(i-r)),n=Math.min(...a);return a.indexOf(n)}function sr(t,r,a){const n=t/2,m=pe([0,50],[0,n]);return(n-m(r)*a)*a}function ar(t){return t.slice(0,-1).map((r,a)=>t[a+1]-r)}function nr(t,r){if(r>0){const a=ar(t);return Math.min(...a)>=r}return!0}function pe(t,r){return a=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const n=(r[1]-r[0])/(t[1]-t[0]);return r[0]+n*(a-t[0])}}function or(t){return(String(t).split(".")[1]||"").length}function ir(t,r){const a=Math.pow(10,r);return Math.round(t*a)/a}var tt=ze,cr=Xe,lr=Je,dr=Qe;const Y=c.forwardRef(({className:t,...r},a)=>e.jsxs(tt,{ref:a,className:ue("relative flex w-full touch-none select-none items-center",t),...r,children:[e.jsx(cr,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(lr,{className:"absolute h-full bg-primary"})}),e.jsx(dr,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Y.displayName=tt.displayName;const br=({isOpen:t,onClose:r,planId:a})=>{const{toast:n}=ot(),[i,m]=c.useState(!1),[u,p]=c.useState(null),[s,f]=c.useState({weight_kg:"",weight_type:"current",total_energy_kcal:"",macro_mode:"percentage",protein_pct:33.3,carbs_pct:33.3,fat_pct:33.3,protein_g_per_kg:"",carbs_g_per_kg:"",fat_g_per_kg:""}),[l,d]=c.useState({});c.useEffect(()=>{t&&a&&h()},[t,a]);const h=async()=>{m(!0);try{const{data:o}=await ht(a);o&&(f({weight_kg:o.weight_kg||"",weight_type:o.weight_type||"current",total_energy_kcal:o.total_energy_kcal||"",macro_mode:o.macro_mode||"percentage",protein_pct:o.protein_percentage?o.protein_percentage*100:33.3,carbs_pct:o.carbs_percentage?o.carbs_percentage*100:33.3,fat_pct:o.fat_percentage?o.fat_percentage*100:33.3,protein_g_per_kg:o.protein_g_per_kg||"",carbs_g_per_kg:o.carbs_g_per_kg||"",fat_g_per_kg:o.fat_g_per_kg||""}),p(o))}catch(o){console.error("Erro ao carregar valores:",o)}finally{m(!1)}},g=(o,w)=>{f(b=>({...b,[o]:w})),l[o]&&d(b=>({...b,[o]:null}))},_=o=>{const w=o[0],b=100-w,j=s.protein_pct,S=s.fat_pct,R=j+S;let P,C;R>0?(P=j/R*b,C=S/R*b):(P=b/2,C=b/2),f(E=>({...E,carbs_pct:w,protein_pct:Math.round(P*10)/10,fat_pct:Math.round(C*10)/10}))},v=o=>{const w=o[0],b=100-w,j=s.carbs_pct,S=s.fat_pct,R=j+S;let P,C;R>0?(P=j/R*b,C=S/R*b):(P=b/2,C=b/2),f(E=>({...E,protein_pct:w,carbs_pct:Math.round(P*10)/10,fat_pct:Math.round(C*10)/10}))},x=o=>{const w=o[0],b=100-w,j=s.protein_pct,S=s.carbs_pct,R=j+S;let P,C;R>0?(P=j/R*b,C=S/R*b):(P=b/2,C=b/2),f(E=>({...E,fat_pct:w,protein_pct:Math.round(P*10)/10,carbs_pct:Math.round(C*10)/10}))},N=()=>{const o=parseFloat(s.weight_kg),w=parseFloat(s.total_energy_kcal);if(!o||!w)return null;let b,j,S;if(s.macro_mode==="percentage"){const R=s.protein_pct/100,P=s.carbs_pct/100,C=s.fat_pct/100;b=w*R/4,j=w*P/4,S=w*C/9}else b=o*(parseFloat(s.protein_g_per_kg)||0),j=o*(parseFloat(s.carbs_g_per_kg)||0),S=o*(parseFloat(s.fat_g_per_kg)||0);return{protein:b.toFixed(1),carbs:j.toFixed(1),fat:S.toFixed(1),proteinCal:(b*4).toFixed(0),carbsCal:(j*4).toFixed(0),fatCal:(S*9).toFixed(0),totalCal:(b*4+j*4+S*9).toFixed(0)}},M=()=>{const o={};if((!s.weight_kg||parseFloat(s.weight_kg)<=0)&&(o.weight_kg="Peso é obrigatório e deve ser maior que zero"),(!s.total_energy_kcal||parseFloat(s.total_energy_kcal)<=0)&&(o.total_energy_kcal="Energia é obrigatória e deve ser maior que zero"),s.macro_mode==="percentage"){const w=s.protein_pct+s.carbs_pct+s.fat_pct;Math.abs(w-100)>.5&&(o.macro_sum=`Soma dos percentuais deve ser 100% (atual: ${w.toFixed(1)}%)`)}else s.protein_g_per_kg||(o.protein_g_per_kg="Obrigatório"),s.carbs_g_per_kg||(o.carbs_g_per_kg="Obrigatório"),s.fat_g_per_kg||(o.fat_g_per_kg="Obrigatório");return d(o),Object.keys(o).length===0},y=async()=>{if(M()){m(!0);try{const o={weight_kg:parseFloat(s.weight_kg),weight_type:s.weight_type,total_energy_kcal:parseFloat(s.total_energy_kcal),macro_mode:s.macro_mode,protein_percentage:s.macro_mode==="percentage"?s.protein_pct/100:null,carbs_percentage:s.macro_mode==="percentage"?s.carbs_pct/100:null,fat_percentage:s.macro_mode==="percentage"?s.fat_pct/100:null,protein_g_per_kg:s.macro_mode==="g_per_kg"?parseFloat(s.protein_g_per_kg):null,carbs_g_per_kg:s.macro_mode==="g_per_kg"?parseFloat(s.carbs_g_per_kg):null,fat_g_per_kg:s.macro_mode==="g_per_kg"?parseFloat(s.fat_g_per_kg):null},w=await _t(a,o);if(w.error)throw w.error;n({title:"Sucesso",description:"Valores de referência salvos com sucesso",variant:"success"}),p(w.data),r()}catch(o){console.error("Erro ao salvar:",o),n({title:"Erro",description:"Não foi possível salvar os valores",variant:"destructive"})}finally{m(!1)}}},k=()=>{f({weight_kg:"",weight_type:"current",total_energy_kcal:"",macro_mode:"percentage",protein_pct:33.3,carbs_pct:33.3,fat_pct:33.3,protein_g_per_kg:"",carbs_g_per_kg:"",fat_g_per_kg:""}),d({})},D=()=>{d({}),r()},I=N(),O=s.protein_pct+s.carbs_pct+s.fat_pct;return e.jsx(it,{open:t,onOpenChange:D,children:e.jsxs(ct,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(lt,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dt,{children:"Valores de Referência Nutricional"}),e.jsxs(ft,{children:[e.jsx(gt,{asChild:!0,children:e.jsx(H,{variant:"ghost",size:"icon",className:"h-6 w-6",children:e.jsx(vt,{className:"h-4 w-4 text-blue-600"})})}),e.jsx(xt,{className:"w-96",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Como funcionam os cálculos:"}),e.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-foreground",children:"Percentuais:"})," Distribuição da energia total.",e.jsx("br",{}),"Ex: 20% de proteínas em 2000kcal = 400kcal ÷ 4kcal/g = 100g"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-foreground",children:"Gramas/Kg:"})," Quantidade por peso corporal.",e.jsx("br",{}),"Ex: 2g/kg × 70kg = 140g de proteínas"]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-foreground",children:"Valores calóricos:"}),e.jsx("br",{}),"Proteínas e Carboidratos = 4kcal/g",e.jsx("br",{}),"Gorduras = 9kcal/g"]})]})]})})]})]}),e.jsx(ut,{children:"Configure os valores de referência para análise e comparação do plano alimentar"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(Q,{children:[e.jsxs(Z,{children:[e.jsx(ee,{className:"text-base",children:"Dados do Paciente"}),e.jsx(te,{children:"Informações básicas para o cálculo"})]}),e.jsxs(re,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{htmlFor:"weight",children:["Peso (kg) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(G,{id:"weight",type:"number",step:"0.1",placeholder:"Ex: 70.5",value:s.weight_kg,onChange:o=>g("weight_kg",o.target.value),className:l.weight_kg?"border-destructive":""}),l.weight_kg&&e.jsx("p",{className:"text-xs text-destructive",children:l.weight_kg})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Tipo de Peso"}),e.jsxs(ne,{value:s.weight_type,onValueChange:o=>g("weight_type",o),className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{value:"current",id:"current"}),e.jsx(F,{htmlFor:"current",className:"font-normal cursor-pointer",children:"Peso Atual"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{value:"desired",id:"desired"}),e.jsx(F,{htmlFor:"desired",className:"font-normal cursor-pointer",children:"Peso Desejado"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{htmlFor:"energy",children:["Energia Total Diária (kcal) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(G,{id:"energy",type:"number",placeholder:"Ex: 2000",value:s.total_energy_kcal,onChange:o=>g("total_energy_kcal",o.target.value),className:l.total_energy_kcal?"border-destructive":""}),l.total_energy_kcal&&e.jsx("p",{className:"text-xs text-destructive",children:l.total_energy_kcal}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gasto energético total estimado (TEE) do paciente"})]})]})]}),e.jsxs(Q,{children:[e.jsxs(Z,{children:[e.jsx(ee,{className:"text-base",children:"Distribuição de Macronutrientes"}),e.jsx(te,{children:"Escolha como deseja configurar os macronutrientes"})]}),e.jsxs(re,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(F,{children:"Modo de Configuração"}),e.jsxs(ne,{value:s.macro_mode,onValueChange:o=>g("macro_mode",o),className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-muted/50 cursor-pointer",children:[e.jsx($,{value:"percentage",id:"percentage",className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(F,{htmlFor:"percentage",className:"font-semibold cursor-pointer",children:"Percentuais da Energia Total"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Distribua a energia em porcentagens (recomendado para maioria dos casos)"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg hover:bg-muted/50 cursor-pointer",children:[e.jsx($,{value:"g_per_kg",id:"g_per_kg",className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(F,{htmlFor:"g_per_kg",className:"font-semibold cursor-pointer",children:"Gramas por Kg de Peso"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Configure baseado no peso corporal (ideal para atletas e hipertrofia)"})]})]})]})]}),s.macro_mode==="percentage"&&e.jsxs("div",{className:"space-y-6 pt-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx(F,{className:"flex-1",children:"Proteínas"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{type:"number",min:"5",max:"50",step:"0.1",value:s.protein_pct,onChange:o=>{const w=parseFloat(o.target.value)||0;v([Math.max(5,Math.min(50,w))])},className:"w-20 text-center"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:"%"})]})]}),e.jsx(Y,{value:[s.protein_pct],onValueChange:v,min:5,max:50,step:.1,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Arraste ou digite o valor. Os outros macros ajustam automaticamente."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx(F,{className:"flex-1",children:"Carboidratos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{type:"number",min:"5",max:"75",step:"0.1",value:s.carbs_pct,onChange:o=>{const w=parseFloat(o.target.value)||0;_([Math.max(5,Math.min(75,w))])},className:"w-20 text-center"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:"%"})]})]}),e.jsx(Y,{value:[s.carbs_pct],onValueChange:_,min:5,max:75,step:.1,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Arraste ou digite o valor. Os outros macros ajustam automaticamente."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx(F,{className:"flex-1",children:"Gorduras"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{type:"number",min:"5",max:"50",step:"0.1",value:s.fat_pct,onChange:o=>{const w=parseFloat(o.target.value)||0;x([Math.max(5,Math.min(50,w))])},className:"w-20 text-center"}),e.jsx("span",{className:"text-sm font-medium text-orange-600",children:"%"})]})]}),e.jsx(Y,{value:[s.fat_pct],onValueChange:x,min:5,max:50,step:.1,className:"w-full"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Arraste ou digite o valor. Os outros macros ajustam automaticamente."})]}),e.jsxs("div",{className:`p-3 rounded-lg ${Math.abs(O-100)<=.5?"bg-green-50 border border-green-200":"bg-yellow-50 border border-yellow-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total:"}),e.jsxs("span",{className:"text-lg font-bold",children:[O.toFixed(1),"%"]})]}),l.macro_sum&&e.jsx("p",{className:"text-xs text-destructive mt-1",children:l.macro_sum})]})]}),s.macro_mode==="g_per_kg"&&e.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{htmlFor:"protein_gkg",children:["Proteínas (g/kg) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(G,{id:"protein_gkg",type:"number",step:"0.1",placeholder:"Ex: 2.0",value:s.protein_g_per_kg,onChange:o=>g("protein_g_per_kg",o.target.value),className:l.protein_g_per_kg?"border-destructive":""}),l.protein_g_per_kg&&e.jsx("p",{className:"text-xs text-destructive",children:l.protein_g_per_kg})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{htmlFor:"carbs_gkg",children:["Carboidratos (g/kg) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(G,{id:"carbs_gkg",type:"number",step:"0.1",placeholder:"Ex: 4.0",value:s.carbs_g_per_kg,onChange:o=>g("carbs_g_per_kg",o.target.value),className:l.carbs_g_per_kg?"border-destructive":""}),l.carbs_g_per_kg&&e.jsx("p",{className:"text-xs text-destructive",children:l.carbs_g_per_kg})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{htmlFor:"fat_gkg",children:["Gorduras (g/kg) ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(G,{id:"fat_gkg",type:"number",step:"0.1",placeholder:"Ex: 1.0",value:s.fat_g_per_kg,onChange:o=>g("fat_g_per_kg",o.target.value),className:l.fat_g_per_kg?"border-destructive":""}),l.fat_g_per_kg&&e.jsx("p",{className:"text-xs text-destructive",children:l.fat_g_per_kg})]})]})]})]}),I&&e.jsxs(Q,{className:"bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20",children:[e.jsxs(Z,{children:[e.jsx(ee,{className:"text-base",children:"Metas Calculadas"}),e.jsx(te,{children:"Valores alvo diários em gramas"})]}),e.jsxs(re,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 mb-4",children:[e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-white rounded-lg border",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Proteínas"}),e.jsxs("div",{className:"text-2xl sm:text-3xl font-bold text-blue-600 break-words",children:[I.protein,"g"]}),e.jsxs("div",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1 break-words",children:[I.proteinCal," kcal (",s.macro_mode==="percentage"?`${s.protein_pct.toFixed(1)}%`:`${s.protein_g_per_kg}g/kg`,")"]})]}),e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-white rounded-lg border",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Carboidratos"}),e.jsxs("div",{className:"text-2xl sm:text-3xl font-bold text-green-600 break-words",children:[I.carbs,"g"]}),e.jsxs("div",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1 break-words",children:[I.carbsCal," kcal (",s.macro_mode==="percentage"?`${s.carbs_pct.toFixed(1)}%`:`${s.carbs_g_per_kg}g/kg`,")"]})]}),e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-white rounded-lg border",children:[e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mb-1",children:"Gorduras"}),e.jsxs("div",{className:"text-2xl sm:text-3xl font-bold text-orange-600 break-words",children:[I.fat,"g"]}),e.jsxs("div",{className:"text-[10px] sm:text-xs text-muted-foreground mt-1 break-words",children:[I.fatCal," kcal (",s.macro_mode==="percentage"?`${s.fat_pct.toFixed(1)}%`:`${s.fat_g_per_kg}g/kg`,")"]})]})]}),e.jsxs("div",{className:"text-center text-xs sm:text-sm text-muted-foreground",children:["Total energético calculado: ",e.jsxs("strong",{children:[I.totalCal," kcal"]})]})]})]})]}),e.jsxs(mt,{className:"gap-2",children:[e.jsxs(H,{variant:"outline",onClick:k,disabled:i,children:[e.jsx(jt,{className:"h-4 w-4 mr-2"}),"Limpar"]}),e.jsxs(H,{variant:"outline",onClick:D,disabled:i,children:[e.jsx(pt,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),e.jsxs(H,{onClick:y,disabled:i,children:[e.jsx(bt,{className:"h-4 w-4 mr-2"}),i?"Salvando...":"Salvar"]})]})]})})};export{br as R};
