import{a5 as _e,b as Ce,a as De,r as i,s as $,j as e,B as c,C as J,c as K,d as X,w as te,X as Z,e as Q,$ as E,J as Pe,K as Se,M as Fe,N as Me,ad as ke,O as Ae,A as Ee,h as ze,i as Ge,k as Ie,l as Te,n as Re,o as Ve,p as Be,t as Le}from"./index-BvWB-6Y-.js";import{I as W}from"./input-OBodSLFw.js";import{D as ae}from"./date-input-NufpG6-F.js";import{L as b}from"./label-Dds-NHUC.js";import{S as qe,a as Oe,b as Ue,c as He,d as D}from"./select-CHitR1r5.js";import{T as $e}from"./textarea-DCWQIVw9.js";import{B as z}from"./badge-CCK5Bs0D.js";import{P as We}from"./progress-Di_AUcQX.js";import{A as le,a as oe}from"./alert-BZscs13a.js";import{g as Je,c as Ke,d as Xe,e as Qe,f as Ye,h as Ze,a as es,b as ss,p as ts,i as as,u as rs,j as is}from"./goals-queries-C9WNr4yF.js";import{g as re,f as ie}from"./date-C2sroe8F.js";import{A as ls}from"./arrow-left-c5Ho3YFj.js";import{T as x}from"./target-Bs9FM_-p.js";import{S as N}from"./scale-B02K6JBe.js";import{C as Y}from"./calendar-BxLBJTLY.js";import{F as ne}from"./flame-DbwLYwhx.js";import{C as P}from"./check-circle-2-DqvAHxH6.js";import{A as j}from"./activity-CbrTkNiD.js";import{A as ce}from"./alert-circle-HzKGSyQg.js";import{T as de}from"./trending-down-Be-17Tpn.js";import{P as me}from"./pause-CX5zjuYV.js";import{T as os}from"./trending-up-DCN4wKoA.js";import"./calendar-rgGv7qqU.js";import"./endOfMonth-Ca9QmV5D.js";import"./addMonths-hOFFPW3g.js";import"./isSameDay-CSO39H9U.js";import"./chevron-left-FDyjizdT.js";import"./popover-BK70NwGK.js";import"./extends-CF3RwP-h.js";import"./pt-BR-BMtVLtF7.js";import"./parseISO-DtrTOw4I.js";import"./query-helpers-mbysFH2_.js";import"./patient-queries-DNM8Wnzg.js";import"./mealTranslations-B1KHhmEq.js";import"./lab-results-queries-B3ZMjFH4.js";import"./observability-queries-BxbsnaqH.js";const $s=()=>{const{patientId:t}=_e(),w=Ce(),{toast:l}=De(),[m,v]=i.useState(!0),[u,p]=i.useState(!1),[_,G]=i.useState(""),[S,I]=i.useState(null),[o,he]=i.useState(null),[T,ge]=i.useState([]),[R,C]=i.useState(!1),[a,F]=i.useState({goal_type:"weight_loss",title:"",description:"",initial_weight:"",target_weight:"",start_date:re(),target_date:""}),[d,V]=i.useState(null),[B,ee]=i.useState(!1),[h,L]=i.useState(null),[fe,M]=i.useState(!1),[k,q]=i.useState(""),[ue,O]=i.useState(!1);i.useEffect(()=>{(async()=>{const{data:{user:r}}=await $.auth.getUser();r&&I(r.id)})()},[]),i.useEffect(()=>{y()},[t]);const y=async()=>{v(!0);try{const{data:s}=await $.from("user_profiles").select("name").eq("id",t).single();s&&G(s.name);const{data:r}=await Je(t);he(r);const{data:n}=await Ke(t,{status:["completed","cancelled","paused"]});if(ge(n||[]),!r){const{data:f}=await $.from("growth_records").select("weight").eq("patient_id",t).order("record_date",{ascending:!1}).limit(1).maybeSingle();f&&f.weight&&F(A=>({...A,initial_weight:f.weight.toString()})),C(!0)}}catch(s){console.error("Erro ao carregar dados:",s),l({title:"Erro",description:"NÃ£o foi possÃ­vel carregar os dados das metas.",variant:"destructive"})}finally{v(!1)}};i.useEffect(()=>{const r=setTimeout(async()=>{if(!a.initial_weight||!a.target_weight||!a.start_date||!a.target_date){V(null);return}ee(!0);try{const n=await Ye(a,t);V(n)}catch(n){console.error("Erro ao calcular viabilidade:",n)}finally{ee(!1)}},500);return()=>clearTimeout(r)},[a,t]),i.useEffect(()=>{if(a.goal_type&&a.initial_weight&&a.target_weight){const s=Math.abs(parseFloat(a.target_weight)-parseFloat(a.initial_weight)),r=a.goal_type;let n="";r==="weight_loss"?n=`Perder ${s.toFixed(1)}kg`:r==="weight_gain"?n=`Ganhar ${s.toFixed(1)}kg`:r==="weight_maintenance"?n=`Manter ${a.initial_weight}kg`:n="Meta personalizada",F(f=>({...f,title:n}))}},[a.goal_type,a.initial_weight,a.target_weight]),i.useEffect(()=>{if(a.initial_weight&&a.target_weight){const s=parseFloat(a.initial_weight),r=parseFloat(a.target_weight),n=r-s;if(!isNaN(s)&&!isNaN(r)&&n!==0){const f=Qe(n),A=Xe(n),se=new Date(a.start_date),U=new Date(se);U.setDate(U.getDate()+f);const H=new Date(se);H.setDate(H.getDate()+A),L({minDays:f,idealDays:A,minDate:ie(U),idealDate:ie(H),weightChange:Math.abs(n)})}else L(null)}else L(null)},[a.initial_weight,a.target_weight,a.start_date]);const g=(s,r)=>{F(n=>({...n,[s]:r}))},pe=async()=>{if(!S){l({title:"Erro",description:"UsuÃ¡rio nÃ£o autenticado.",variant:"destructive"});return}if(!a.title||!a.initial_weight||!a.target_weight||!a.target_date){l({title:"Campos obrigatÃ³rios",description:"Preencha todos os campos obrigatÃ³rios.",variant:"destructive"});return}p(!0);try{const{data:s,error:r}=await Ze({...a,initial_weight:parseFloat(a.initial_weight),target_weight:parseFloat(a.target_weight)},t,S);if(r)throw r;l({title:"Meta criada!",description:"Meta criada com sucesso.",variant:"success"}),C(!1),F({goal_type:"weight_loss",title:"",description:"",initial_weight:"",target_weight:"",start_date:re(),target_date:""}),V(null),await y()}catch(s){console.error("Erro ao criar meta:",s),l({title:"Erro",description:Le(s,"NÃ£o foi possÃ­vel criar a meta."),variant:"destructive"})}finally{p(!1)}},be=async()=>{if(!(!k||!o)){p(!0);try{const{error:s}=await rs(o.id,parseFloat(k));if(s)throw s;l({title:"Progresso atualizado!",description:"Peso atualizado com sucesso.",variant:"success"}),M(!1),q(""),await y()}catch(s){console.error("Erro ao atualizar progresso:",s),l({title:"Erro",description:"NÃ£o foi possÃ­vel atualizar o progresso.",variant:"destructive"})}finally{p(!1)}}},je=async()=>{if(o&&window.confirm("Tem certeza que deseja marcar esta meta como concluÃ­da?"))try{const{error:s}=await as(o.id);if(s)throw s;l({title:"Meta concluÃ­da!",description:"ParabÃ©ns! Meta foi marcada como concluÃ­da.",variant:"success"}),await y()}catch(s){console.error("Erro ao completar meta:",s),l({title:"Erro",description:"NÃ£o foi possÃ­vel completar a meta.",variant:"destructive"})}},Ne=async()=>{if(o)try{const{error:s}=await ts(o.id);if(s)throw s;l({title:"Meta pausada",description:"Meta foi pausada com sucesso.",variant:"success"}),await y()}catch(s){console.error("Erro ao pausar meta:",s),l({title:"Erro",description:"NÃ£o foi possÃ­vel pausar a meta.",variant:"destructive"})}},we=async()=>{if(o)try{const{error:s}=await is(o.id,null);if(s)throw s;l({title:"Meta cancelada",description:"Meta foi cancelada com sucesso.",variant:"success"}),O(!1),await y()}catch(s){console.error("Erro ao cancelar meta:",s),l({title:"Erro",description:"NÃ£o foi possÃ­vel cancelar a meta.",variant:"destructive"})}},ve=s=>s>=4?"text-green-600 bg-green-50 border-green-200":s>=3?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-red-600 bg-red-50 border-red-200",ye=s=>s>=4?"Ã“tima viabilidade":s>=3?"Viabilidade moderada":"Baixa viabilidade";return m?null:e.jsx("div",{className:"flex flex-col min-h-screen bg-background overflow-x-hidden",children:e.jsxs("div",{className:"max-w-7xl mx-auto w-full px-4 md:px-8 py-4 md:py-8 min-w-0",children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>w(`/nutritionist/patients/${t}/hub?tab=adherence`),className:"-ml-2 w-fit text-[#5f6f52] hover:text-[#5f6f52] hover:bg-[#5f6f52]/10",children:[e.jsx(ls,{className:"w-4 h-4 mr-1"}),"Voltar"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(x,{className:"w-6 h-6 md:w-8 md:h-8 text-[#5f6f52]"}),e.jsx("span",{className:"truncate",children:"Metas Nutricionais"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 truncate",children:["Paciente: ",e.jsx("span",{className:"font-medium text-foreground",children:_})]})]}),!o&&!R&&e.jsxs(c,{onClick:()=>C(!0),className:"gap-2 w-full sm:w-auto",children:[e.jsx(x,{className:"w-4 h-4"}),"Nova Meta"]})]})]}),R&&e.jsxs(J,{className:"mb-6 shadow-md",children:[e.jsx(K,{className:"bg-[#fefae0]/50 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-[#5f6f52] flex items-center justify-center",children:e.jsx(x,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx(X,{className:"text-lg",children:"Criar Nova Meta"}),e.jsx(te,{className:"text-sm",children:"Defina uma meta nutricional realista e sustentÃ¡vel"})]})]})}),!o&&e.jsx(c,{variant:"ghost",size:"sm",onClick:()=>C(!1),className:"hover:bg-red-50 hover:text-red-600",children:e.jsx(Z,{className:"w-4 h-4"})})]})}),e.jsxs(Q,{className:"space-y-6 pt-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-[#a9b388]/30",children:[e.jsx(x,{className:"w-4 h-4 text-[#5f6f52]"}),e.jsx("h3",{className:"font-semibold text-[#5f6f52]",children:"InformaÃ§Ãµes BÃ¡sicas"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"goal_type",className:"text-sm font-medium",children:"Tipo de Meta"}),e.jsxs(qe,{value:a.goal_type,onValueChange:s=>g("goal_type",s),children:[e.jsx(Oe,{id:"goal_type",className:"h-10",children:e.jsx(Ue,{})}),e.jsxs(He,{children:[e.jsx(D,{value:"weight_loss",children:"Perda de Peso"}),e.jsx(D,{value:"weight_gain",children:"Ganho de Peso"}),e.jsx(D,{value:"weight_maintenance",children:"ManutenÃ§Ã£o de Peso"}),e.jsx(D,{value:"body_composition",children:"ComposiÃ§Ã£o Corporal"}),e.jsx(D,{value:"custom",children:"Personalizada"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(b,{htmlFor:"initial_weight",className:"text-sm font-medium flex items-center gap-1.5",children:[e.jsx(N,{className:"w-3.5 h-3.5 text-[#5f6f52]"}),"Peso Inicial (kg)"]}),e.jsx(W,{id:"initial_weight",type:"number",step:"0.1",value:a.initial_weight,onChange:s=>g("initial_weight",s.target.value),placeholder:"70.0",className:"h-11 font-semibold bg-[#fefae0]/20"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Peso atual do paciente"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(b,{htmlFor:"target_weight",className:"text-sm font-medium flex items-center gap-1.5",children:[e.jsx(x,{className:"w-3.5 h-3.5 text-[#c4661f]"}),"Peso Meta (kg)"]}),e.jsx(W,{id:"target_weight",type:"number",step:"0.1",value:a.target_weight,onChange:s=>g("target_weight",s.target.value),placeholder:"65.0",className:"h-11 font-semibold bg-[#fefae0]/20"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Peso que deseja atingir"})]})]})]}),h&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-[#a9b388]/30",children:[e.jsx(Y,{className:"w-4 h-4 text-[#5f6f52]"}),e.jsx("h3",{className:"font-semibold text-[#5f6f52]",children:"RecomendaÃ§Ã£o de Prazo"})]}),e.jsxs("div",{className:"bg-[#fefae0]/30 border border-[#a9b388]/40 rounded-lg p-4",children:[e.jsxs("div",{className:"text-sm text-foreground mb-3",children:["Para ",a.goal_type==="weight_loss"?"perder":"ganhar"," ",e.jsxs("strong",{children:[h.weightChange.toFixed(1),"kg"]})," de forma saudÃ¡vel:"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white p-3 rounded border border-[#c4661f]/30 hover:border-[#c4661f]/60 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ne,{className:"w-4 h-4 text-[#c4661f]"}),e.jsx("div",{className:"text-xs font-semibold text-[#c4661f] uppercase",children:"Prazo MÃ­nimo"})]}),e.jsxs("div",{className:"text-xl font-bold text-foreground mb-1",children:[h.minDays," dias"]}),e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:["atÃ© ",new Date(h.minDate).toLocaleDateString("pt-BR")]}),e.jsx(c,{variant:"outline",size:"sm",className:"w-full text-xs h-8",onClick:()=>g("target_date",h.minDate),children:"Usar este prazo"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1.5",children:"Agressivo"})]}),e.jsxs("div",{className:"bg-[#5f6f52]/5 p-3 rounded border border-[#5f6f52]/40 hover:border-[#5f6f52] transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{className:"w-4 h-4 text-[#5f6f52]"}),e.jsx("div",{className:"text-xs font-semibold text-[#5f6f52] uppercase",children:"Prazo Ideal"})]}),e.jsxs("div",{className:"text-xl font-bold text-foreground mb-1",children:[h.idealDays," dias"]}),e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:["atÃ© ",new Date(h.idealDate).toLocaleDateString("pt-BR")]}),e.jsx(c,{size:"sm",className:"w-full bg-[#5f6f52] hover:bg-[#5f6f52]/90 text-white text-xs h-8",onClick:()=>g("target_date",h.idealDate),children:"Usar este prazo (Recomendado)"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1.5",children:"SustentÃ¡vel"})]})]}),e.jsx("div",{className:"bg-[#5f6f52]/10 rounded p-2.5 mt-3",children:e.jsxs("p",{className:"text-xs text-foreground/80",children:[e.jsx("strong",{children:"ðŸ’¡ Dica:"})," O prazo ideal considera um dÃ©ficit moderado e seguro para resultados sustentÃ¡veis."]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-[#a9b388]/30",children:[e.jsx(Y,{className:"w-4 h-4 text-[#5f6f52]"}),e.jsx("h3",{className:"font-semibold text-[#5f6f52]",children:"Cronograma"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"start_date",className:"text-sm font-medium",children:"Data de InÃ­cio"}),e.jsx(ae,{id:"start_date",value:a.start_date,onChange:s=>g("start_date",s),className:"h-10"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"target_date",className:"text-sm font-medium",children:"Data Meta"}),e.jsx(ae,{id:"target_date",value:a.target_date,onChange:s=>g("target_date",s),min:a.start_date,className:"h-10"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-[#a9b388]/30",children:[e.jsx(j,{className:"w-4 h-4 text-[#5f6f52]"}),e.jsx("h3",{className:"font-semibold text-[#5f6f52]",children:"ObservaÃ§Ãµes"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"description",className:"text-sm font-medium",children:"ObservaÃ§Ãµes (Opcional)"}),e.jsx($e,{id:"description",value:a.description,onChange:s=>g("description",s.target.value),placeholder:"Ex: RestriÃ§Ãµes alimentares, preferÃªncias de exercÃ­cios...",rows:3,className:"resize-none"})]})]}),(B||d)&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b border-[#a9b388]/30",children:[e.jsx(j,{className:"w-4 h-4 text-[#5f6f52]"}),e.jsx("h3",{className:"font-semibold text-[#5f6f52]",children:"AnÃ¡lise de Viabilidade"})]}),B&&e.jsxs("div",{className:"text-center py-6 bg-[#fefae0]/30 rounded-lg border border-[#a9b388]/40",children:[e.jsx(j,{className:"w-6 h-6 animate-spin text-[#5f6f52] mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Calculando viabilidade da meta..."})]}),d&&!B&&e.jsxs(le,{className:E("shadow-sm",ve(d.viability_score)),children:[e.jsx(ce,{className:"h-4 w-4"}),e.jsx(oe,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"font-semibold",children:ye(d.viability_score)}),e.jsxs(z,{variant:"outline",className:"text-xs",children:[d.viability_score,"/5"]})]}),d.warnings&&d.warnings.length>0&&e.jsx("div",{className:"space-y-1 mt-2",children:d.warnings.map((s,r)=>e.jsxs("div",{className:"flex items-start gap-1.5 text-sm",children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:s.message})]},r))}),d.viability_notes&&e.jsx("div",{className:"text-xs whitespace-pre-line mt-2 pt-2 border-t opacity-80",children:d.viability_notes})]})})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end pt-4 border-t",children:[!o&&e.jsx(c,{variant:"outline",onClick:()=>C(!1),children:"Cancelar"}),e.jsx(c,{onClick:pe,disabled:u||!d,className:"bg-[#5f6f52] hover:bg-[#5f6f52]/90 text-white",children:u?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Criando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),"Criar Meta"]})})]})]})]}),o&&!R&&e.jsx(ns,{goal:o,onUpdateProgress:()=>M(!0),onComplete:je,onPause:Ne,onCancel:()=>O(!0)}),T&&T.length>0&&e.jsxs(J,{className:"mt-6 shadow-md",children:[e.jsx(K,{className:"bg-[#fefae0]/30 border-b",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4 text-[#5f6f52]"}),e.jsxs("div",{children:[e.jsx(X,{children:"HistÃ³rico de Metas"}),e.jsx(te,{className:"text-sm",children:"Metas anteriores do paciente"})]})]})}),e.jsx(Q,{className:"pt-4",children:e.jsx("div",{className:"space-y-2",children:T.map(s=>e.jsx(cs,{goal:s},s.id))})})]}),e.jsx(Pe,{open:fe,onOpenChange:M,children:e.jsxs(Se,{className:"sm:max-w-md",children:[e.jsx(Fe,{className:"pb-3 border-b",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-[#5f6f52] flex items-center justify-center",children:e.jsx(N,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx(Me,{children:"Atualizar Progresso"}),e.jsx(ke,{className:"text-sm",children:"Registre o peso atual do paciente"})]})]})}),e.jsxs("div",{className:"space-y-4 py-4",children:[o&&e.jsxs("div",{className:"bg-[#fefae0]/40 p-3 rounded-lg border border-[#a9b388]/40",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1.5",children:[e.jsx("span",{className:"text-muted-foreground",children:"Peso anterior:"}),e.jsxs("span",{className:"font-bold text-[#5f6f52]",children:[o.current_weight?.toFixed(1)," kg"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Meta:"}),e.jsxs("span",{className:"font-semibold text-[#c4661f]",children:[o.target_weight?.toFixed(1)," kg"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(b,{htmlFor:"new_weight",className:"text-sm font-medium flex items-center gap-1.5",children:[e.jsx(N,{className:"w-3.5 h-3.5 text-[#5f6f52]"}),"Novo Peso (kg)"]}),e.jsx(W,{id:"new_weight",type:"number",step:"0.1",value:k,onChange:s=>q(s.target.value),placeholder:"Ex: 68.5",className:"h-12 text-lg font-semibold text-center",autoFocus:!0}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Digite o peso medido hoje"})]})]}),e.jsxs(Ae,{className:"gap-2",children:[e.jsx(c,{variant:"outline",onClick:()=>{M(!1),q("")},disabled:u,children:"Cancelar"}),e.jsx(c,{onClick:be,disabled:u||!k,className:"bg-[#5f6f52] hover:bg-[#5f6f52]/90 text-white",children:u?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Salvar"]})})]})]})}),e.jsx(Ee,{open:ue,onOpenChange:O,children:e.jsxs(ze,{children:[e.jsxs(Ge,{children:[e.jsx(Ie,{children:"Cancelar meta?"}),e.jsx(Te,{children:"Tem certeza que deseja cancelar esta meta? Esta aÃ§Ã£o nÃ£o pode ser desfeita."})]}),e.jsxs(Re,{children:[e.jsx(Ve,{children:"NÃ£o, manter meta"}),e.jsx(Be,{onClick:we,className:"bg-red-600 hover:bg-red-700",children:"Sim, cancelar meta"})]})]})})]})})},ns=({goal:t,onUpdateProgress:w,onComplete:l,onPause:m,onCancel:v})=>{const u=xe(t.goal_type),p=es(t.target_date),_=ss(t),G=t.current_weight-t.target_weight,S=Math.abs(G);return e.jsxs(J,{className:"shadow-md bg-gradient-to-br from-[#fefae0]/30 to-white",children:[e.jsx(K,{className:"bg-[#5f6f52] text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-white/10 flex items-center justify-center",children:e.jsx(u,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(X,{className:"text-lg font-bold mb-1",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(z,{className:"bg-white/20 text-white border-0 text-xs",children:[e.jsx(j,{className:"w-3 h-3 mr-1"}),"Em Andamento"]}),e.jsx("span",{className:"text-xs text-white/70",children:new Date(t.start_date).toLocaleDateString("pt-BR")})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(c,{variant:"secondary",size:"sm",onClick:w,className:"bg-white/90 text-[#5f6f52] hover:bg-white text-xs h-8",children:[e.jsx(N,{className:"w-3.5 h-3.5 mr-1.5"}),"Atualizar"]}),e.jsx(c,{variant:"secondary",size:"sm",onClick:l,className:"bg-[#a9b388] text-white hover:bg-[#a9b388]/90 h-8 px-2",children:e.jsx(P,{className:"w-4 h-4"})})]})]})}),e.jsxs(Q,{className:"space-y-4 pt-4",children:[e.jsxs("div",{className:"bg-[#fefae0]/40 p-4 rounded-lg border border-[#a9b388]/40",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-semibold text-muted-foreground uppercase",children:"Progresso"}),e.jsxs("span",{className:"text-2xl font-bold text-[#5f6f52]",children:[t.progress_percentage?.toFixed(1)||0,"%"]})]}),e.jsx(We,{value:t.progress_percentage||0,className:"h-3 mb-2"}),_&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(z,{variant:"outline",className:E("text-xs",_.color),children:_.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.progress_percentage>=100?"ConcluÃ­da!":"Em progresso"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border border-[#a9b388]/30 hover:border-[#5f6f52]/50 transition-colors",children:[e.jsx(N,{className:"w-4 h-4 text-[#5f6f52] mx-auto mb-1"}),e.jsx("div",{className:"text-xl font-bold text-foreground",children:t.current_weight?.toFixed(1)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Peso Atual"})]}),e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border border-[#5f6f52]/40 hover:border-[#5f6f52] transition-colors",children:[e.jsx(x,{className:"w-4 h-4 text-[#5f6f52] mx-auto mb-1"}),e.jsx("div",{className:"text-xl font-bold text-[#5f6f52]",children:t.target_weight?.toFixed(1)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Meta"})]}),e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border border-[#c4661f]/30 hover:border-[#c4661f]/50 transition-colors",children:[e.jsx(de,{className:"w-4 h-4 text-[#c4661f] mx-auto mb-1"}),e.jsx("div",{className:"text-xl font-bold text-[#c4661f]",children:S.toFixed(1)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Faltam"})]}),e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border border-[#a9b388]/40 hover:border-[#a9b388] transition-colors",children:[e.jsx(Y,{className:"w-4 h-4 text-[#a9b388] mx-auto mb-1"}),e.jsx("div",{className:"text-xl font-bold text-foreground",children:p>0?p:0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Dias"})]})]}),(t.daily_calorie_goal||t.required_daily_deficit)&&e.jsxs("div",{className:"bg-[#fefae0]/30 border border-[#a9b388]/40 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ne,{className:"w-4 h-4 text-[#c4661f]"}),e.jsx("h3",{className:"font-semibold text-foreground",children:"Plano Nutricional"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[t.daily_calorie_goal&&e.jsxs("div",{className:"bg-white/60 p-2.5 rounded border border-[#a9b388]/30",children:[e.jsx("span",{className:"text-xs text-muted-foreground block mb-0.5",children:"Meta CalÃ³rica DiÃ¡ria"}),e.jsx("span",{className:"text-lg font-bold text-foreground",children:Math.round(t.daily_calorie_goal)}),e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"kcal"})]}),t.required_daily_deficit&&e.jsxs("div",{className:"bg-white/60 p-2.5 rounded border border-[#a9b388]/30",children:[e.jsx("span",{className:"text-xs text-muted-foreground block mb-0.5",children:"DÃ©ficit NecessÃ¡rio"}),e.jsx("span",{className:"text-lg font-bold text-foreground",children:Math.round(Math.abs(t.required_daily_deficit))}),e.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"kcal/dia"})]})]})]}),t.warnings&&t.warnings.length>0&&e.jsxs(le,{className:"bg-yellow-50/50 border-yellow-300",children:[e.jsx(ce,{className:"h-4 w-4 text-yellow-700"}),e.jsxs(oe,{children:[e.jsx("div",{className:"font-semibold text-yellow-900 mb-1.5 text-sm",children:"Pontos de AtenÃ§Ã£o"}),t.warnings.map((I,o)=>e.jsxs("div",{className:"flex items-start gap-1.5 text-sm text-yellow-900 mb-1",children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:I.message})]},o))]})]}),e.jsxs("div",{className:"flex gap-2 pt-3 border-t border-[#a9b388]/30",children:[e.jsxs(c,{variant:"outline",size:"sm",onClick:m,className:"flex-1 text-xs h-9",children:[e.jsx(me,{className:"w-3.5 h-3.5 mr-1.5"}),"Pausar"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:v,className:"flex-1 text-xs h-9 text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(Z,{className:"w-3.5 h-3.5 mr-1.5"}),"Cancelar"]})]})]})]})},cs=({goal:t})=>{const w=xe(t.goal_type),l={completed:{label:"ConcluÃ­da",badgeColor:"bg-[#a9b388] text-white",borderColor:"border-[#a9b388]/40",bgColor:"bg-[#a9b388]/5",icon:P},cancelled:{label:"Cancelada",badgeColor:"bg-red-100 text-red-800",borderColor:"border-red-200",bgColor:"bg-red-50/30",icon:Z},paused:{label:"Pausada",badgeColor:"bg-yellow-100 text-yellow-800",borderColor:"border-yellow-200",bgColor:"bg-yellow-50/30",icon:me}},m=l[t.status]||l.completed,v=m.icon;return e.jsxs("div",{className:E("flex items-center gap-3 p-3 rounded-lg border hover:border-[#5f6f52]/50 transition-colors",m.bgColor,m.borderColor),children:[e.jsx("div",{className:"w-9 h-9 rounded bg-[#fefae0] flex items-center justify-center flex-shrink-0 border border-[#a9b388]/30",children:e.jsx(w,{className:"w-4 h-4 text-[#5f6f52]"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold text-sm text-foreground truncate",children:t.title}),e.jsxs(z,{className:E("text-xs border-0",m.badgeColor),children:[e.jsx(v,{className:"w-3 h-3 mr-1"}),m.label]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-2 gap-y-1 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(N,{className:"w-3 h-3"}),t.initial_weight,"kg â†’ ",t.target_weight,"kg"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[t.progress_percentage?.toFixed(1)||0,"%"]}),t.completion_date&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:new Date(t.completion_date).toLocaleDateString("pt-BR")})]})]})]})]})},xe=t=>({weight_loss:de,weight_gain:os,weight_maintenance:N,body_composition:j,custom:x})[t]||x;export{$s as default};
