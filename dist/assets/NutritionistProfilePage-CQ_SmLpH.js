import{q as ee,u as je,a as Y,r as c,j as e,C as y,c as S,d as b,w,e as D,U as Z,B as j,L as z,s as L,I as ae,T as ie,J as re,K as te,M as le,N as ne,O as ce,A as Te,h as ke,i as _e,k as Ae,l as Re,n as ze,o as Ge,p as Me,m as qe,S as Le}from"./index-BvWB-6Y-.js";import{T as Ue,a as Ke,b as H,c as I}from"./tabs-CA5k0aJI.js";import{I as x}from"./input-OBodSLFw.js";import{L as o}from"./label-Dds-NHUC.js";import{T as Oe}from"./textarea-DCWQIVw9.js";import{S as J,a as Q,b as W,c as X,d as V}from"./select-CHitR1r5.js";import{U as Ve}from"./upload-r4K88bxr.js";import{P as $e,M as He}from"./phone-BA7HxFMm.js";import{I as Ie}from"./info-Cibi8VF-.js";import{T as oe}from"./date-input-NufpG6-F.js";import{C as Be}from"./checkbox-CP0b09Ss.js";import{g as ge,u as ve,a as Je,s as Qe,d as We}from"./profile-queries-CdHimGjG.js";import{C as Xe}from"./clock-BDxmKYor.js";import{C as se}from"./calendar-BxLBJTLY.js";import{T as de,a as me,b as B,c as P,d as he,e as T}from"./table-C34wbah6.js";import{g as Ye,s as Ze,d as es}from"./financial-queries-Co2vDJmL.js";import{C as ss,D as fe}from"./dollar-sign-D-vf70ug.js";import{P as ue}from"./plus-BWNKYoo4.js";import{P as xe}from"./pen-square-OCV3PTXs.js";import"./extends-CF3RwP-h.js";import"./calendar-rgGv7qqU.js";import"./endOfMonth-Ca9QmV5D.js";import"./addMonths-hOFFPW3g.js";import"./isSameDay-CSO39H9U.js";import"./chevron-left-FDyjizdT.js";import"./popover-BK70NwGK.js";import"./pt-BR-BMtVLtF7.js";import"./parseISO-DtrTOw4I.js";import"./index-DQp_4bzJ.js";import"./query-helpers-mbysFH2_.js";const as=ee("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]),is=ee("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),rs=ee("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ts=["Nutrição Clínica","Nutrição Esportiva","Nutrição Materno-Infantil","Saúde Pública","Comportamento Alimentar"];function ls({profile:i,onUpdate:C}){const{user:n,updateUserProfile:k}=je(),{toast:g}=Y(),[v,f]=c.useState(!1),[d,h]=c.useState(!1),R=c.useRef(null),[m,u]=c.useState({name:i?.name||"",crn:i?.crn||"",phone:i?.phone||"",education:i?.education||"",bio:i?.bio||"",address:i?.address||{street:"",city:"",state:"",zip:""},specialties:i?.specialties||[],avatar_url:i?.avatar_url||""}),r=async a=>{const t=a.target.files[0];if(t){h(!0);try{const{data:F}=await L.storage.from("avatars").list(n.id);if(F&&F.length>0){const E=F.map(N=>`${n.id}/${N.name}`);await L.storage.from("avatars").remove(E)}const G=`${n.id}/${Date.now()}_${t.name}`,{error:U}=await L.storage.from("avatars").upload(G,t);if(U)throw U;const{data:{publicUrl:M}}=L.storage.from("avatars").getPublicUrl(G),{data:$,error:_}=await L.from("user_profiles").update({avatar_url:M}).eq("id",n.id).select().single();if(_)throw _;k($),u(E=>({...E,avatar_url:M})),g({title:"Foto de perfil atualizada!"})}catch{g({title:"Erro",description:"Não foi possível fazer upload da foto.",variant:"destructive"})}finally{h(!1)}}},p=async()=>{f(!0);try{const{data:a,error:t}=await L.from("user_profiles").update({name:m.name,crn:m.crn,phone:m.phone,education:m.education,bio:m.bio,address:m.address,specialties:m.specialties}).eq("id",n.id).select().single();if(t)throw t;k(a),C&&C(a),g({title:"Perfil atualizado!",description:"Suas informações foram salvas com sucesso."})}catch{g({title:"Erro",description:"Não foi possível salvar as alterações.",variant:"destructive"})}finally{f(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsxs(S,{children:[e.jsx(b,{children:"Foto de Perfil / Logo"}),e.jsx(w,{children:"Faça upload da sua foto ou logo do consultório"})]}),e.jsx(D,{children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-primary/20 bg-secondary flex items-center justify-center overflow-hidden",children:m.avatar_url?e.jsx("img",{src:m.avatar_url,alt:"Foto de perfil",className:"w-full h-full object-cover"}):e.jsx(Z,{className:"w-16 h-16 text-muted-foreground"})}),e.jsx("input",{type:"file",ref:R,onChange:r,accept:"image/*",className:"hidden",disabled:d}),e.jsx(j,{size:"icon",className:"absolute bottom-0 right-0 rounded-full h-10 w-10",onClick:()=>R.current?.click(),disabled:d,children:d?e.jsx(z,{className:"w-4 h-4 animate-spin"}):e.jsx(Ve,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Clique no ícone de upload para alterar sua foto. Formatos aceitos: JPG, PNG (máx. 5MB)"})})]})})]}),e.jsxs(y,{children:[e.jsxs(S,{children:[e.jsx(b,{children:"Informações Pessoais"}),e.jsx(w,{children:"Dados básicos do nutricionista"})]}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"name",children:"Nome Completo *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(x,{id:"name",value:m.name,onChange:a=>u(t=>({...t,name:a.target.value})),placeholder:"Seu nome completo"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"crn",children:"CRN *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(x,{id:"crn",value:m.crn,onChange:a=>u(t=>({...t,crn:a.target.value})),placeholder:"Ex: CRN-3 12345"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"phone",children:"Telefone"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(x,{id:"phone",value:m.phone,onChange:a=>u(t=>({...t,phone:a.target.value})),placeholder:"(00) 00000-0000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"education",children:"Formação Acadêmica"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(x,{id:"education",value:m.education,onChange:a=>u(t=>({...t,education:a.target.value})),placeholder:"Ex: Graduação em Nutrição - UFMG"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Especialidades"}),e.jsxs(J,{value:m.specialties[0]||"none",onValueChange:a=>{u(t=>({...t,specialties:a&&a!=="none"?[a]:[]}))},children:[e.jsx(Q,{children:e.jsx(W,{placeholder:"Selecione uma especialidade"})}),e.jsxs(X,{children:[e.jsx(V,{value:"none",children:"Nenhuma"}),ts.map(a=>e.jsx(V,{value:a,children:a},a))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"bio",children:"Biografia Profissional"}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ie,{className:"w-4 h-4 text-muted-foreground mt-2 flex-shrink-0"}),e.jsx(Oe,{id:"bio",value:m.bio,onChange:a=>u(t=>({...t,bio:a.target.value})),placeholder:"Descreva sua experiência profissional...",rows:4})]})]})]})]}),e.jsxs(y,{children:[e.jsxs(S,{children:[e.jsx(b,{children:"Endereço Completo do Consultório"}),e.jsx(w,{children:"Usado em recibos e documentos oficiais"})]}),e.jsx(D,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(o,{htmlFor:"street",children:"Rua / Avenida"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(x,{id:"street",value:m.address.street,onChange:a=>u(t=>({...t,address:{...t.address,street:a.target.value}})),placeholder:"Rua, número, complemento"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"city",children:"Cidade"}),e.jsx(x,{id:"city",value:m.address.city,onChange:a=>u(t=>({...t,address:{...t.address,city:a.target.value}})),placeholder:"Cidade"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"state",children:"Estado"}),e.jsx(x,{id:"state",value:m.address.state,onChange:a=>u(t=>({...t,address:{...t.address,state:a.target.value}})),placeholder:"UF",maxLength:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"zip",children:"CEP"}),e.jsx(x,{id:"zip",value:m.address.zip,onChange:a=>u(t=>({...t,address:{...t.address,zip:a.target.value}})),placeholder:"00000-000"})]})]})})]}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(j,{onClick:p,disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar Alterações"})})]})}const ns=[{value:"monday",label:"Segunda-feira"},{value:"tuesday",label:"Terça-feira"},{value:"wednesday",label:"Quarta-feira"},{value:"thursday",label:"Quinta-feira"},{value:"friday",label:"Sexta-feira"},{value:"saturday",label:"Sábado"},{value:"sunday",label:"Domingo"}],cs=[{value:30,label:"30 minutos"},{value:45,label:"45 minutos"},{value:60,label:"1 hora"},{value:90,label:"1 hora e 30 minutos"}];function os({userId:i,onUpdate:C}){const{toast:n}=Y(),[k,g]=c.useState(!1),[v,f]=c.useState(!1),[d,h]=c.useState({startTime:"08:00",endTime:"18:00",workingDays:["monday","tuesday","wednesday","thursday","friday"],slotDuration:60});c.useEffect(()=>{R()},[i]);const R=async()=>{if(i){g(!0);try{const r=await ge(i);r.agenda&&h({startTime:r.agenda.startTime||"08:00",endTime:r.agenda.endTime||"18:00",workingDays:r.agenda.workingDays||["monday","tuesday","wednesday","thursday","friday"],slotDuration:r.agenda.slotDuration||60})}catch(r){console.error("Error loading agenda settings:",r)}finally{g(!1)}}},m=r=>{h(p=>({...p,workingDays:p.workingDays.includes(r)?p.workingDays.filter(a=>a!==r):[...p.workingDays,r]}))},u=async()=>{if(i){f(!0);try{await ve(i,{agenda:{startTime:d.startTime,endTime:d.endTime,workingDays:d.workingDays,slotDuration:d.slotDuration}}),n({title:"Configurações salvas!",description:"As configurações de agenda foram atualizadas com sucesso."}),C&&C()}catch{n({title:"Erro",description:"Não foi possível salvar as configurações.",variant:"destructive"})}finally{f(!1)}}};return k?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(z,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsxs(S,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5"}),"Horário de Funcionamento"]}),e.jsx(w,{children:"Defina os horários de atendimento do seu consultório"})]}),e.jsx(D,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"startTime",children:"Horário de Início"}),e.jsx(oe,{id:"startTime",value:d.startTime,onChange:r=>h(p=>({...p,startTime:r}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"endTime",children:"Horário de Término"}),e.jsx(oe,{id:"endTime",value:d.endTime,onChange:r=>h(p=>({...p,endTime:r}))})]})]})})]}),e.jsxs(y,{children:[e.jsxs(S,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Dias da Semana"]}),e.jsx(w,{children:"Selecione os dias em que você atende"})]}),e.jsx(D,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:ns.map(r=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{id:r.value,checked:d.workingDays.includes(r.value),onCheckedChange:()=>m(r.value)}),e.jsx(o,{htmlFor:r.value,className:"text-sm font-normal cursor-pointer",children:r.label})]},r.value))})})]}),e.jsxs(y,{children:[e.jsxs(S,{children:[e.jsx(b,{children:"Duração dos Slots"}),e.jsx(w,{children:"Tempo padrão de cada consulta/agendamento"})]}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"slotDuration",children:"Duração (minutos)"}),e.jsxs(J,{value:d.slotDuration.toString(),onValueChange:r=>h(p=>({...p,slotDuration:parseInt(r)})),children:[e.jsx(Q,{children:e.jsx(W,{})}),e.jsx(X,{children:cs.map(r=>e.jsx(V,{value:r.value.toString(),children:r.label},r.value))})]})]})})]}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(j,{onClick:u,disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar Configurações"})})]})}const pe=[{value:"consulta",label:"Consulta"},{value:"plano_mensal",label:"Plano Mensal"},{value:"outros",label:"Outros"}];function ds({userId:i,onUpdate:C}){const{toast:n}=Y(),[k,g]=c.useState(!1),[v,f]=c.useState(!1),[d,h]=c.useState({defaultPixKey:"",defaultFeePercentage:"",monthlyFinancialGoal:1e4}),[R,m]=c.useState([]),[u,r]=c.useState([]),[p,a]=c.useState(!1),[t,F]=c.useState(!1),[G,U]=c.useState(null),[M,$]=c.useState(null),[_,E]=c.useState({type:null,id:null}),[N,q]=c.useState({name:"",description:"",price:"",category:"consulta"}),[A,K]=c.useState({description:"",value:"",day_of_month:"1"});c.useEffect(()=>{i&&O()},[i]);const O=async()=>{if(i){g(!0);try{const[s,l,Pe]=await Promise.all([ge(i),Ye(i),Je(i)]);h({defaultPixKey:s.defaultPixKey||"",defaultFeePercentage:s.defaultFeePercentage||"",monthlyFinancialGoal:s.monthlyFinancialGoal||1e4}),m(l),r(Pe)}catch(s){console.error("Error loading financial data:",s),n({title:"Erro",description:"Não foi possível carregar os dados.",variant:"destructive"})}finally{g(!1)}}},Ne=async()=>{if(i){f(!0);try{await ve(i,{defaultPixKey:d.defaultPixKey,defaultFeePercentage:d.defaultFeePercentage?parseFloat(d.defaultFeePercentage):null,monthlyFinancialGoal:d.monthlyFinancialGoal?parseFloat(d.monthlyFinancialGoal):1e4}),n({title:"Configurações salvas!",description:"As configurações financeiras foram atualizadas."}),C&&C()}catch{n({title:"Erro",description:"Não foi possível salvar as configurações.",variant:"destructive"})}finally{f(!1)}}},ye=()=>{U(null),q({name:"",description:"",price:"",category:"consulta"}),a(!0)},Ce=s=>{U(s),q({name:s.name,description:s.description||"",price:s.price.toString(),category:s.category||"consulta"}),a(!0)},Se=async s=>{if(s.preventDefault(),!N.name||!N.price){n({title:"Erro",description:"Preencha todos os campos obrigatórios.",variant:"destructive"});return}try{await Ze({id:G?.id,nutritionist_id:i,name:N.name,description:N.description,price:parseFloat(N.price),category:N.category}),n({title:"Sucesso!",description:`Serviço ${G?"atualizado":"criado"} com sucesso.`}),a(!1),O()}catch{n({title:"Erro",description:"Não foi possível salvar o serviço.",variant:"destructive"})}},be=async s=>{try{await es(s),n({title:"Sucesso!",description:"Serviço excluído com sucesso."}),E({type:null,id:null}),O()}catch{n({title:"Erro",description:"Não foi possível excluir o serviço.",variant:"destructive"})}},we=()=>{$(null),K({description:"",value:"",day_of_month:"1"}),F(!0)},De=s=>{$(s),K({description:s.description,value:s.value.toString(),day_of_month:s.day_of_month.toString()}),F(!0)},Fe=async s=>{if(s.preventDefault(),!A.description||!A.value){n({title:"Erro",description:"Preencha todos os campos obrigatórios.",variant:"destructive"});return}try{await Qe(i,{id:M?.id,description:A.description,value:parseFloat(A.value),day_of_month:parseInt(A.day_of_month)}),n({title:"Sucesso!",description:`Despesa recorrente ${M?"atualizada":"criada"} com sucesso.`}),F(!1),O()}catch{n({title:"Erro",description:"Não foi possível salvar a despesa.",variant:"destructive"})}},Ee=async s=>{try{await We(i,s),n({title:"Sucesso!",description:"Despesa excluída com sucesso."}),E({type:null,id:null}),O()}catch{n({title:"Erro",description:"Não foi possível excluir a despesa.",variant:"destructive"})}};return k?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(z,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{children:[e.jsxs(S,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(ss,{className:"w-5 h-5"}),"Configurações Gerais"]}),e.jsx(w,{children:"Configurações padrão para transações financeiras"})]}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"defaultPixKey",children:"Chave PIX Padrão"}),e.jsx(x,{id:"defaultPixKey",value:d.defaultPixKey,onChange:s=>h(l=>({...l,defaultPixKey:s.target.value})),placeholder:"CPF, E-mail, Telefone ou Chave Aleatória"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"defaultFeePercentage",children:"Taxa Padrão de Maquininha (%)"}),e.jsx(x,{id:"defaultFeePercentage",type:"number",step:"0.01",min:"0",max:"100",value:d.defaultFeePercentage,onChange:s=>h(l=>({...l,defaultFeePercentage:s.target.value})),placeholder:"Ex: 2.5"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"monthlyFinancialGoal",children:"Meta Financeira Mensal (R$)"}),e.jsx(x,{id:"monthlyFinancialGoal",type:"number",step:"100",min:"0",value:d.monthlyFinancialGoal,onChange:s=>h(l=>({...l,monthlyFinancialGoal:parseFloat(s.target.value)||0})),placeholder:"Ex: 10000"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Meta de receita mensal para acompanhamento no dashboard financeiro"})]}),e.jsx(j,{onClick:Ne,disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar Configurações"})]})]}),e.jsxs(y,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"}),"Meus Serviços"]}),e.jsx(w,{children:"Gerencie seus serviços e preços padrão"})]}),e.jsxs(j,{onClick:ye,children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Novo Serviço"]})]})}),e.jsx(D,{children:R.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'Nenhum serviço cadastrado. Clique em "Novo Serviço" para começar.'}):e.jsxs(de,{children:[e.jsx(me,{children:e.jsxs(B,{children:[e.jsx(P,{children:"Nome"}),e.jsx(P,{children:"Descrição"}),e.jsx(P,{children:"Categoria"}),e.jsx(P,{className:"text-right",children:"Preço"}),e.jsx(P,{className:"text-right",children:"Ações"})]})}),e.jsx(he,{children:R.map(s=>e.jsxs(B,{children:[e.jsx(T,{className:"font-medium",children:s.name}),e.jsx(T,{className:"max-w-[300px] truncate",children:s.description||"-"}),e.jsx(T,{children:pe.find(l=>l.value===s.category)?.label||s.category}),e.jsx(T,{className:"text-right font-semibold",children:ae(s.price)}),e.jsx(T,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>Ce(s),className:"h-8 w-8",children:e.jsx(xe,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>E({type:"service",id:s.id}),className:"h-8 w-8 text-destructive hover:text-destructive",children:e.jsx(ie,{className:"h-4 w-4"})})]})})]},s.id))})]})})]}),e.jsxs(y,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Despesas Fixas (Recorrência)"]}),e.jsx(w,{children:"Despesas que se repetem mensalmente"})]}),e.jsxs(j,{onClick:we,children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Nova Despesa"]})]})}),e.jsx(D,{children:u.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhuma despesa recorrente cadastrada."}):e.jsxs(de,{children:[e.jsx(me,{children:e.jsxs(B,{children:[e.jsx(P,{children:"Descrição"}),e.jsx(P,{className:"text-right",children:"Valor"}),e.jsx(P,{className:"text-right",children:"Dia do Mês"}),e.jsx(P,{className:"text-right",children:"Ações"})]})}),e.jsx(he,{children:u.map(s=>e.jsxs(B,{children:[e.jsx(T,{className:"font-medium",children:s.description}),e.jsx(T,{className:"text-right font-semibold",children:ae(s.value)}),e.jsxs(T,{className:"text-right",children:["Dia ",s.day_of_month]}),e.jsx(T,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>De(s),className:"h-8 w-8",children:e.jsx(xe,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>E({type:"expense",id:s.id}),className:"h-8 w-8 text-destructive hover:text-destructive",children:e.jsx(ie,{className:"h-4 w-4"})})]})})]},s.id))})]})})]}),e.jsx(re,{open:p,onOpenChange:a,children:e.jsxs(te,{children:[e.jsx(le,{children:e.jsx(ne,{children:G?"Editar Serviço":"Novo Serviço"})}),e.jsxs("form",{onSubmit:Se,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"serviceName",children:"Nome do Serviço *"}),e.jsx(x,{id:"serviceName",required:!0,value:N.name,onChange:s=>q(l=>({...l,name:s.target.value})),placeholder:"Ex: Consulta Individual"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"serviceDescription",children:"Descrição"}),e.jsx(x,{id:"serviceDescription",value:N.description,onChange:s=>q(l=>({...l,description:s.target.value})),placeholder:"Descrição opcional"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"serviceCategory",children:"Categoria *"}),e.jsxs(J,{required:!0,value:N.category,onValueChange:s=>q(l=>({...l,category:s})),children:[e.jsx(Q,{children:e.jsx(W,{})}),e.jsx(X,{children:pe.map(s=>e.jsx(V,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"servicePrice",children:"Preço (R$) *"}),e.jsx(x,{id:"servicePrice",type:"number",step:"0.01",min:"0",required:!0,value:N.price,onChange:s=>q(l=>({...l,price:s.target.value})),placeholder:"0.00"})]})]}),e.jsxs(ce,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancelar"}),e.jsx(j,{type:"submit",children:"Salvar"})]})]})]})}),e.jsx(re,{open:t,onOpenChange:F,children:e.jsxs(te,{children:[e.jsx(le,{children:e.jsx(ne,{children:M?"Editar Despesa Recorrente":"Nova Despesa Recorrente"})}),e.jsxs("form",{onSubmit:Fe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"expenseDescription",children:"Descrição *"}),e.jsx(x,{id:"expenseDescription",required:!0,value:A.description,onChange:s=>K(l=>({...l,description:s.target.value})),placeholder:"Ex: Aluguel do Consultório"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"expenseValue",children:"Valor (R$) *"}),e.jsx(x,{id:"expenseValue",type:"number",step:"0.01",min:"0",required:!0,value:A.value,onChange:s=>K(l=>({...l,value:s.target.value})),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"expenseDay",children:"Dia do Mês *"}),e.jsxs(J,{required:!0,value:A.day_of_month,onValueChange:s=>K(l=>({...l,day_of_month:s})),children:[e.jsx(Q,{children:e.jsx(W,{})}),e.jsx(X,{children:Array.from({length:31},(s,l)=>l+1).map(s=>e.jsxs(V,{value:s.toString(),children:["Dia ",s]},s))})]})]})]}),e.jsxs(ce,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>F(!1),children:"Cancelar"}),e.jsx(j,{type:"submit",children:"Salvar"})]})]})]})}),e.jsx(Te,{open:!!_.type,onOpenChange:s=>!s&&E({type:null,id:null}),children:e.jsxs(ke,{children:[e.jsxs(_e,{children:[e.jsx(Ae,{children:"Confirmar Exclusão"}),e.jsxs(Re,{children:["Tem certeza que deseja excluir este ",_.type==="service"?"serviço":"despesa","? Esta ação não pode ser desfeita."]})]}),e.jsxs(ze,{children:[e.jsx(Ge,{children:"Cancelar"}),e.jsx(Me,{onClick:()=>{_.type==="service"?be(_.id):Ee(_.id)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})})]})}const Ks=()=>{const{user:i,updateUserProfile:C}=je();Y();const[n,k]=c.useState(!0),[g,v]=c.useState(null);c.useEffect(()=>{i&&(i.profile?v(i.profile):v({}),k(!1))},[i]);const f=h=>{v(h),C&&C(h)};if(n||!i)return e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx(z,{className:"w-8 h-8 animate-spin text-muted-foreground"})});const d=g||{};return e.jsx("div",{className:"min-h-screen bg-background overflow-x-hidden",children:e.jsx("main",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4 md:py-8 min-w-0",children:e.jsxs(qe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6 min-w-0",children:[e.jsx(y,{className:"overflow-hidden",children:e.jsx(S,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 min-w-0",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/10 shrink-0",children:e.jsx(Le,{className:"w-7 h-7 md:w-8 md:h-8 text-primary"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx(b,{className:"text-2xl md:text-3xl break-words",children:"Ajustes do Consultório"}),e.jsx(w,{className:"text-sm md:text-base mt-1",children:"Configure todas as informações e preferências do seu consultório em um só lugar"})]})]})})}),e.jsx(y,{children:e.jsx(D,{className:"p-0",children:e.jsxs(Ue,{defaultValue:"personal",className:"w-full",children:[e.jsxs(Ke,{className:"grid w-full grid-cols-4 h-auto p-1",children:[e.jsxs(H,{value:"personal",className:"flex items-center gap-2 py-3",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Dados & Branding"}),e.jsx("span",{className:"sm:hidden",children:"Dados"})]}),e.jsxs(H,{value:"agenda",className:"flex items-center gap-2 py-3",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Agenda & Horários"}),e.jsx("span",{className:"sm:hidden",children:"Agenda"})]}),e.jsxs(H,{value:"financial",className:"flex items-center gap-2 py-3",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Financeiro & Serviços"}),e.jsx("span",{className:"sm:hidden",children:"Financeiro"})]}),e.jsxs(H,{value:"account",className:"flex items-center gap-2 py-3",children:[e.jsx(is,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Conta"}),e.jsx("span",{className:"sm:hidden",children:"Conta"})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx(I,{value:"personal",className:"mt-0",children:e.jsx(ls,{profile:d,onUpdate:f})}),e.jsx(I,{value:"agenda",className:"mt-0",children:e.jsx(os,{userId:i.id,onUpdate:f})}),e.jsx(I,{value:"financial",className:"mt-0",children:e.jsx(ds,{userId:i.id,onUpdate:f})}),e.jsx(I,{value:"account",className:"mt-0",children:e.jsxs(y,{children:[e.jsxs(S,{children:[e.jsx(b,{children:"Configurações da Conta"}),e.jsx(w,{children:"Gerencie sua senha e preferências de conta"})]}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"E-mail"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:i.email})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Para alterar sua senha, entre em contato com o suporte ou use a funcionalidade de recuperação de senha na página de login."})})]})]})})]})]})})})]})})})};export{Ks as default};
