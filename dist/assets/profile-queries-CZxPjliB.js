import{s as c}from"./index-DL6VMzkS.js";import{l as g}from"./query-helpers-mbysFH2_.js";async function u(e,s){const{data:n,error:i}=await c.from("user_profiles").select("preferences, clinic_settings").eq("id",e).single();if(i)throw g("Error fetching current settings",i),i;const t={...n.clinic_settings||n.preferences?.clinic_settings||{},...s},o={},{error:f}=await c.from("user_profiles").update({clinic_settings:t}).eq("id",e);if(f){const d=n.preferences||{};o.preferences={...d,clinic_settings:t}}else o.clinic_settings=t;const{data:l,error:a}=await c.from("user_profiles").update(o).eq("id",e).select().single();if(a)throw g("Error updating clinic settings",a),a;return l}async function p(e){const{data:s,error:n}=await c.from("user_profiles").select("clinic_settings, preferences").eq("id",e).single();if(n)throw g("Error fetching clinic settings",n),n;return s.clinic_settings||s.preferences?.clinic_settings||{}}async function E(e){return(await p(e)).recurring_expenses||[]}async function x(e,s){const i=(await p(e)).recurring_expenses||[];let r;if(s.id)r=i.map(t=>t.id===s.id?{...s}:t);else{const t={id:Date.now().toString(),...s};r=[...i,t]}return await u(e,{recurring_expenses:r}),r}async function m(e,s){const r=((await p(e)).recurring_expenses||[]).filter(t=>t.id!==s);return await u(e,{recurring_expenses:r}),r}export{E as a,m as d,p as g,x as s,u};
