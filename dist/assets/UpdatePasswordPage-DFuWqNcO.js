import{q as C,r as t,a as E,b as P,s as n,j as e,C as D,c as L,d as A,w as I,e as R,B as k}from"./index-DGgtqe62.js";import{I as h}from"./input-C1Ic9mBe.js";import{L as f}from"./label-ByZ_-J2k.js";import{E as x}from"./eye-off-pZMJcL7T.js";import{E as p}from"./eye-C6RVoRY3.js";const q=C("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);function B(){const[i,w]=t.useState(""),[d,j]=t.useState(""),[u,r]=t.useState(!1),[l,v]=t.useState(!1),[c,g]=t.useState(!1),[S,m]=t.useState(null),{toast:o}=E(),N=P();t.useEffect(()=>{n.auth.getSession().then(({data:{session:s}})=>{s&&m(s)});const{data:a}=n.auth.onAuthStateChange(async(s,b)=>{(s==="PASSWORD_RECOVERY"||s==="SIGNED_IN"||s==="USER_UPDATED")&&m(b)});return()=>{a.subscription.unsubscribe()}},[]);const y=async a=>{if(a.preventDefault(),r(!0),i!==d){o({title:"Erro",description:"As senhas não coincidem.",variant:"destructive"}),r(!1);return}if(!S){o({title:"Erro",description:"Sessão inválida ou expirada. Tente novamente.",variant:"destructive"}),r(!1);return}const{error:s}=await n.auth.updateUser({password:i});r(!1),s?o({title:"Erro ao atualizar senha",description:s.message,variant:"destructive"}):(o({title:"Sucesso!",description:"Sua senha foi definida. Você já pode fazer o login."}),await n.auth.signOut(),N("/login"))};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs(D,{className:"w-full max-w-md glass-card shadow-xl",children:[e.jsxs(L,{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center",children:e.jsx(q,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx(A,{className:"text-3xl font-bold gradient-text",children:"HipoZero"}),e.jsx(I,{className:"text-gray-600 mt-2",children:"Defina sua nova senha"})]})]}),e.jsx(R,{children:e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"password",children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"password",type:l?"text":"password",placeholder:"••••••••",value:i,onChange:a=>w(a.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>v(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:l?e.jsx(x,{className:"w-4 h-4"}):e.jsx(p,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"confirmPassword",children:"Confirmar nova senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"confirmPassword",type:c?"text":"password",placeholder:"••••••••",value:d,onChange:a=>j(a.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>g(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:c?e.jsx(x,{className:"w-4 h-4"}):e.jsx(p,{className:"w-4 h-4"})})]})]}),e.jsx(k,{type:"submit",className:"w-full bg-gradient-to-r from-emerald-500 to-teal-600 text-white",disabled:u,children:u?"Salvando...":"Salvar Senha"})]})})]})})}export{B as default};
