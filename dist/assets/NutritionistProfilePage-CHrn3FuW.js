import{q as ae,u as ge,a as Z,r as o,j as e,C as S,c as b,d as D,w as E,e as F,U as se,B as y,L as z,s as T,v as ie,R as re,F as te,V as ne,W as le,Y as ce,Z as oe,_ as de,A as Pe,h as Te,i as _e,k as ke,l as Ae,n as Re,o as qe,p as ze,m as Le,$ as Ue}from"./index-Cl9S2_vK.js";import{T as Me,a as Ve,b as B,c as I}from"./tabs-C2iurRVm.js";import{I as p}from"./input-J8T_OYAP.js";import{L as u}from"./label-B6xwKmAy.js";import{T as Ke}from"./textarea-Ck-wLz_m.js";import{S as W,a as Y,b as J,c as X,d as G}from"./select-DVIkm2mv.js";import{U as Oe}from"./upload-DPPQuvoF.js";import{P as Ge,M as $e}from"./phone-D5gWdrRV.js";import{I as He}from"./info-D4I_a0zH.js";import{C as Be}from"./checkbox-Bd5XEerF.js";import{C as Ie}from"./clock-DpFyvVKk.js";import{T as me,a as ue,b as Q,c as k,d as he,e as A}from"./table-D_f1KBqs.js";import{g as Qe,s as We,d as Ye}from"./financial-queries-Cn-8WYGq.js";import{C as Je,D as fe}from"./dollar-sign-DtfV39BE.js";import{P as xe}from"./plus-2SV3Jemc.js";import{P as pe}from"./pen-square-BteyrFgO.js";import"./extends-CF3RwP-h.js";import"./index-cNXYI7Zo.js";import"./startOfMonth-BPzLXFQb.js";import"./parseISO-1naG7898.js";const Xe=ae("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]),Ze=ae("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),es=ae("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ss=["Nutrição Clínica","Nutrição Esportiva","Nutrição Materno-Infantil","Saúde Pública","Comportamento Alimentar"];function as({profile:a,onUpdate:d}){const{user:r,updateUserProfile:j}=ge(),{toast:x}=Z(),[h,g]=o.useState(!1),[m,v]=o.useState(!1),w=o.useRef(null),[c,f]=o.useState({name:a?.name||"",crn:a?.crn||"",phone:a?.phone||"",education:a?.education||"",bio:a?.bio||"",address:a?.address||{street:"",city:"",state:"",zip:""},specialties:a?.specialties||[],avatar_url:a?.avatar_url||""}),t=async i=>{const n=i.target.files[0];if(n){v(!0);try{const{data:P}=await T.storage.from("avatars").list(r.id);if(P&&P.length>0){const _=P.map(C=>`${r.id}/${C.name}`);await T.storage.from("avatars").remove(_)}const L=`${r.id}/${Date.now()}_${n.name}`,{error:V}=await T.storage.from("avatars").upload(L,n);if(V)throw V;const{data:{publicUrl:U}}=T.storage.from("avatars").getPublicUrl(L),{data:H,error:R}=await T.from("user_profiles").update({avatar_url:U}).eq("id",r.id).select().single();if(R)throw R;j(H),f(_=>({..._,avatar_url:U})),x({title:"Foto de perfil atualizada!"})}catch{x({title:"Erro",description:"Não foi possível fazer upload da foto.",variant:"destructive"})}finally{v(!1)}}},N=async()=>{g(!0);try{const{data:i,error:n}=await T.from("user_profiles").update({name:c.name,crn:c.crn,phone:c.phone,education:c.education,bio:c.bio,address:c.address,specialties:c.specialties}).eq("id",r.id).select().single();if(n)throw n;j(i),d&&d(i),x({title:"Perfil atualizado!",description:"Suas informações foram salvas com sucesso."})}catch{x({title:"Erro",description:"Não foi possível salvar as alterações.",variant:"destructive"})}finally{g(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsx(D,{children:"Foto de Perfil / Logo"}),e.jsx(E,{children:"Faça upload da sua foto ou logo do consultório"})]}),e.jsx(F,{children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-32 h-32 rounded-full border-4 border-primary/20 bg-secondary flex items-center justify-center overflow-hidden",children:c.avatar_url?e.jsx("img",{src:c.avatar_url,alt:"Foto de perfil",className:"w-full h-full object-cover"}):e.jsx(se,{className:"w-16 h-16 text-muted-foreground"})}),e.jsx("input",{type:"file",ref:w,onChange:t,accept:"image/*",className:"hidden",disabled:m}),e.jsx(y,{size:"icon",className:"absolute bottom-0 right-0 rounded-full h-10 w-10",onClick:()=>w.current?.click(),disabled:m,children:m?e.jsx(z,{className:"w-4 h-4 animate-spin"}):e.jsx(Oe,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Clique no ícone de upload para alterar sua foto. Formatos aceitos: JPG, PNG (máx. 5MB)"})})]})})]}),e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsx(D,{children:"Informações Pessoais"}),e.jsx(E,{children:"Dados básicos do nutricionista"})]}),e.jsxs(F,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"name",children:"Nome Completo *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(p,{id:"name",value:c.name,onChange:i=>f(n=>({...n,name:i.target.value})),placeholder:"Seu nome completo"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"crn",children:"CRN *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(es,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(p,{id:"crn",value:c.crn,onChange:i=>f(n=>({...n,crn:i.target.value})),placeholder:"Ex: CRN-3 12345"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"phone",children:"Telefone"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(p,{id:"phone",value:c.phone,onChange:i=>f(n=>({...n,phone:i.target.value})),placeholder:"(00) 00000-0000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"education",children:"Formação Acadêmica"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(p,{id:"education",value:c.education,onChange:i=>f(n=>({...n,education:i.target.value})),placeholder:"Ex: Graduação em Nutrição - UFMG"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Especialidades"}),e.jsxs(W,{value:c.specialties[0]||"",onValueChange:i=>{f(n=>({...n,specialties:i?[i]:[]}))},children:[e.jsx(Y,{children:e.jsx(J,{placeholder:"Selecione uma especialidade"})}),e.jsxs(X,{children:[e.jsx(G,{value:"",children:"Nenhuma"}),ss.map(i=>e.jsx(G,{value:i,children:i},i))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"bio",children:"Biografia Profissional"}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-muted-foreground mt-2 flex-shrink-0"}),e.jsx(Ke,{id:"bio",value:c.bio,onChange:i=>f(n=>({...n,bio:i.target.value})),placeholder:"Descreva sua experiência profissional...",rows:4})]})]})]})]}),e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsx(D,{children:"Endereço Completo do Consultório"}),e.jsx(E,{children:"Usado em recibos e documentos oficiais"})]}),e.jsx(F,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsx(u,{htmlFor:"street",children:"Rua / Avenida"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(p,{id:"street",value:c.address.street,onChange:i=>f(n=>({...n,address:{...n.address,street:i.target.value}})),placeholder:"Rua, número, complemento"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"city",children:"Cidade"}),e.jsx(p,{id:"city",value:c.address.city,onChange:i=>f(n=>({...n,address:{...n.address,city:i.target.value}})),placeholder:"Cidade"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"state",children:"Estado"}),e.jsx(p,{id:"state",value:c.address.state,onChange:i=>f(n=>({...n,address:{...n.address,state:i.target.value}})),placeholder:"UF",maxLength:2})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"zip",children:"CEP"}),e.jsx(p,{id:"zip",value:c.address.zip,onChange:i=>f(n=>({...n,address:{...n.address,zip:i.target.value}})),placeholder:"00000-000"})]})]})})]}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(y,{onClick:N,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar Alterações"})})]})}async function ee(a,d){const{data:r,error:j}=await T.from("user_profiles").select("preferences, clinic_settings").eq("id",a).single();if(j)throw console.error("Error fetching current settings:",j),j;const h={...r.clinic_settings||r.preferences?.clinic_settings||{},...d},g={},{error:m}=await T.from("user_profiles").update({clinic_settings:h}).eq("id",a);if(m){const c=r.preferences||{};g.preferences={...c,clinic_settings:h}}else g.clinic_settings=h;const{data:v,error:w}=await T.from("user_profiles").update(g).eq("id",a).select().single();if(w)throw console.error("Error updating clinic settings:",w),w;return v}async function $(a){const{data:d,error:r}=await T.from("user_profiles").select("clinic_settings, preferences").eq("id",a).single();if(r)throw console.error("Error fetching clinic settings:",r),r;return d.clinic_settings||d.preferences?.clinic_settings||{}}async function is(a){return(await $(a)).recurring_expenses||[]}async function rs(a,d){const j=(await $(a)).recurring_expenses||[];let x;if(d.id)x=j.map(h=>h.id===d.id?{...d}:h);else{const h={id:Date.now().toString(),...d};x=[...j,h]}return await ee(a,{recurring_expenses:x}),x}async function ts(a,d){const x=((await $(a)).recurring_expenses||[]).filter(h=>h.id!==d);return await ee(a,{recurring_expenses:x}),x}const ns=[{value:"monday",label:"Segunda-feira"},{value:"tuesday",label:"Terça-feira"},{value:"wednesday",label:"Quarta-feira"},{value:"thursday",label:"Quinta-feira"},{value:"friday",label:"Sexta-feira"},{value:"saturday",label:"Sábado"},{value:"sunday",label:"Domingo"}],ls=[{value:30,label:"30 minutos"},{value:45,label:"45 minutos"},{value:60,label:"1 hora"},{value:90,label:"1 hora e 30 minutos"}];function cs({userId:a,onUpdate:d}){const{toast:r}=Z(),[j,x]=o.useState(!1),[h,g]=o.useState(!1),[m,v]=o.useState({startTime:"08:00",endTime:"18:00",workingDays:["monday","tuesday","wednesday","thursday","friday"],slotDuration:60});o.useEffect(()=>{w()},[a]);const w=async()=>{if(a){x(!0);try{const t=await $(a);t.agenda&&v({startTime:t.agenda.startTime||"08:00",endTime:t.agenda.endTime||"18:00",workingDays:t.agenda.workingDays||["monday","tuesday","wednesday","thursday","friday"],slotDuration:t.agenda.slotDuration||60})}catch(t){console.error("Error loading agenda settings:",t)}finally{x(!1)}}},c=t=>{v(N=>({...N,workingDays:N.workingDays.includes(t)?N.workingDays.filter(i=>i!==t):[...N.workingDays,t]}))},f=async()=>{if(a){g(!0);try{await ee(a,{agenda:{startTime:m.startTime,endTime:m.endTime,workingDays:m.workingDays,slotDuration:m.slotDuration}}),r({title:"Configurações salvas!",description:"As configurações de agenda foram atualizadas com sucesso."}),d&&d()}catch{r({title:"Erro",description:"Não foi possível salvar as configurações.",variant:"destructive"})}finally{g(!1)}}};return j?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(z,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-5 h-5"}),"Horário de Funcionamento"]}),e.jsx(E,{children:"Defina os horários de atendimento do seu consultório"})]}),e.jsx(F,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"startTime",children:"Horário de Início"}),e.jsx(p,{id:"startTime",type:"time",value:m.startTime,onChange:t=>v(N=>({...N,startTime:t.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"endTime",children:"Horário de Término"}),e.jsx(p,{id:"endTime",type:"time",value:m.endTime,onChange:t=>v(N=>({...N,endTime:t.target.value}))})]})]})})]}),e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5"}),"Dias da Semana"]}),e.jsx(E,{children:"Selecione os dias em que você atende"})]}),e.jsx(F,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:ns.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{id:t.value,checked:m.workingDays.includes(t.value),onCheckedChange:()=>c(t.value)}),e.jsx(u,{htmlFor:t.value,className:"text-sm font-normal cursor-pointer",children:t.label})]},t.value))})})]}),e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsx(D,{children:"Duração dos Slots"}),e.jsx(E,{children:"Tempo padrão de cada consulta/agendamento"})]}),e.jsx(F,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"slotDuration",children:"Duração (minutos)"}),e.jsxs(W,{value:m.slotDuration.toString(),onValueChange:t=>v(N=>({...N,slotDuration:parseInt(t)})),children:[e.jsx(Y,{children:e.jsx(J,{})}),e.jsx(X,{children:ls.map(t=>e.jsx(G,{value:t.value.toString(),children:t.label},t.value))})]})]})})]}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(y,{onClick:f,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar Configurações"})})]})}const je=[{value:"consulta",label:"Consulta"},{value:"plano_mensal",label:"Plano Mensal"},{value:"outros",label:"Outros"}];function os({userId:a,onUpdate:d}){const{toast:r}=Z(),[j,x]=o.useState(!1),[h,g]=o.useState(!1),[m,v]=o.useState({defaultPixKey:"",defaultFeePercentage:""}),[w,c]=o.useState([]),[f,t]=o.useState([]),[N,i]=o.useState(!1),[n,P]=o.useState(!1),[L,V]=o.useState(null),[U,H]=o.useState(null),[R,_]=o.useState({type:null,id:null}),[C,M]=o.useState({name:"",description:"",price:"",category:"consulta"}),[q,K]=o.useState({description:"",value:"",day_of_month:"1"});o.useEffect(()=>{a&&O()},[a]);const O=async()=>{if(a){x(!0);try{const[s,l,Fe]=await Promise.all([$(a),Qe(a),is(a)]);v({defaultPixKey:s.defaultPixKey||"",defaultFeePercentage:s.defaultFeePercentage||""}),c(l),t(Fe)}catch(s){console.error("Error loading financial data:",s),r({title:"Erro",description:"Não foi possível carregar os dados.",variant:"destructive"})}finally{x(!1)}}},ve=async()=>{if(a){g(!0);try{await ee(a,{defaultPixKey:m.defaultPixKey,defaultFeePercentage:m.defaultFeePercentage?parseFloat(m.defaultFeePercentage):null}),r({title:"Configurações salvas!",description:"As configurações financeiras foram atualizadas."}),d&&d()}catch{r({title:"Erro",description:"Não foi possível salvar as configurações.",variant:"destructive"})}finally{g(!1)}}},Ne=()=>{V(null),M({name:"",description:"",price:"",category:"consulta"}),i(!0)},ye=s=>{V(s),M({name:s.name,description:s.description||"",price:s.price.toString(),category:s.category||"consulta"}),i(!0)},Ce=async s=>{if(s.preventDefault(),!C.name||!C.price){r({title:"Erro",description:"Preencha todos os campos obrigatórios.",variant:"destructive"});return}try{await We({id:L?.id,nutritionist_id:a,name:C.name,description:C.description,price:parseFloat(C.price),category:C.category}),r({title:"Sucesso!",description:`Serviço ${L?"atualizado":"criado"} com sucesso.`}),i(!1),O()}catch{r({title:"Erro",description:"Não foi possível salvar o serviço.",variant:"destructive"})}},Se=async s=>{try{await Ye(s),r({title:"Sucesso!",description:"Serviço excluído com sucesso."}),_({type:null,id:null}),O()}catch{r({title:"Erro",description:"Não foi possível excluir o serviço.",variant:"destructive"})}},we=()=>{H(null),K({description:"",value:"",day_of_month:"1"}),P(!0)},be=s=>{H(s),K({description:s.description,value:s.value.toString(),day_of_month:s.day_of_month.toString()}),P(!0)},De=async s=>{if(s.preventDefault(),!q.description||!q.value){r({title:"Erro",description:"Preencha todos os campos obrigatórios.",variant:"destructive"});return}try{await rs(a,{id:U?.id,description:q.description,value:parseFloat(q.value),day_of_month:parseInt(q.day_of_month)}),r({title:"Sucesso!",description:`Despesa recorrente ${U?"atualizada":"criada"} com sucesso.`}),P(!1),O()}catch{r({title:"Erro",description:"Não foi possível salvar a despesa.",variant:"destructive"})}},Ee=async s=>{try{await ts(a,s),r({title:"Sucesso!",description:"Despesa excluída com sucesso."}),_({type:null,id:null}),O()}catch{r({title:"Erro",description:"Não foi possível excluir a despesa.",variant:"destructive"})}};return j?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(z,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5"}),"Configurações Gerais"]}),e.jsx(E,{children:"Configurações padrão para transações financeiras"})]}),e.jsxs(F,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"defaultPixKey",children:"Chave PIX Padrão"}),e.jsx(p,{id:"defaultPixKey",value:m.defaultPixKey,onChange:s=>v(l=>({...l,defaultPixKey:s.target.value})),placeholder:"CPF, E-mail, Telefone ou Chave Aleatória"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"defaultFeePercentage",children:"Taxa Padrão de Maquininha (%)"}),e.jsx(p,{id:"defaultFeePercentage",type:"number",step:"0.01",min:"0",max:"100",value:m.defaultFeePercentage,onChange:s=>v(l=>({...l,defaultFeePercentage:s.target.value})),placeholder:"Ex: 2.5"})]}),e.jsx(y,{onClick:ve,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar Configurações"})]})]}),e.jsxs(S,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5"}),"Meus Serviços"]}),e.jsx(E,{children:"Gerencie seus serviços e preços padrão"})]}),e.jsxs(y,{onClick:Ne,children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Novo Serviço"]})]})}),e.jsx(F,{children:w.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'Nenhum serviço cadastrado. Clique em "Novo Serviço" para começar.'}):e.jsxs(me,{children:[e.jsx(ue,{children:e.jsxs(Q,{children:[e.jsx(k,{children:"Nome"}),e.jsx(k,{children:"Descrição"}),e.jsx(k,{children:"Categoria"}),e.jsx(k,{className:"text-right",children:"Preço"}),e.jsx(k,{className:"text-right",children:"Ações"})]})}),e.jsx(he,{children:w.map(s=>e.jsxs(Q,{children:[e.jsx(A,{className:"font-medium",children:s.name}),e.jsx(A,{className:"max-w-[300px] truncate",children:s.description||"-"}),e.jsx(A,{children:je.find(l=>l.value===s.category)?.label||s.category}),e.jsx(A,{className:"text-right font-semibold",children:re(s.price)}),e.jsx(A,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(y,{variant:"ghost",size:"icon",onClick:()=>ye(s),className:"h-8 w-8",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(y,{variant:"ghost",size:"icon",onClick:()=>_({type:"service",id:s.id}),className:"h-8 w-8 text-destructive hover:text-destructive",children:e.jsx(te,{className:"h-4 w-4"})})]})})]},s.id))})]})})]}),e.jsxs(S,{children:[e.jsx(b,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(D,{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-5 h-5"}),"Despesas Fixas (Recorrência)"]}),e.jsx(E,{children:"Despesas que se repetem mensalmente"})]}),e.jsxs(y,{onClick:we,children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Nova Despesa"]})]})}),e.jsx(F,{children:f.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhuma despesa recorrente cadastrada."}):e.jsxs(me,{children:[e.jsx(ue,{children:e.jsxs(Q,{children:[e.jsx(k,{children:"Descrição"}),e.jsx(k,{className:"text-right",children:"Valor"}),e.jsx(k,{className:"text-right",children:"Dia do Mês"}),e.jsx(k,{className:"text-right",children:"Ações"})]})}),e.jsx(he,{children:f.map(s=>e.jsxs(Q,{children:[e.jsx(A,{className:"font-medium",children:s.description}),e.jsx(A,{className:"text-right font-semibold",children:re(s.value)}),e.jsxs(A,{className:"text-right",children:["Dia ",s.day_of_month]}),e.jsx(A,{children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(y,{variant:"ghost",size:"icon",onClick:()=>be(s),className:"h-8 w-8",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(y,{variant:"ghost",size:"icon",onClick:()=>_({type:"expense",id:s.id}),className:"h-8 w-8 text-destructive hover:text-destructive",children:e.jsx(te,{className:"h-4 w-4"})})]})})]},s.id))})]})})]}),e.jsx(ne,{open:N,onOpenChange:i,children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsx(oe,{children:L?"Editar Serviço":"Novo Serviço"})}),e.jsxs("form",{onSubmit:Ce,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"serviceName",children:"Nome do Serviço *"}),e.jsx(p,{id:"serviceName",required:!0,value:C.name,onChange:s=>M(l=>({...l,name:s.target.value})),placeholder:"Ex: Consulta Individual"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"serviceDescription",children:"Descrição"}),e.jsx(p,{id:"serviceDescription",value:C.description,onChange:s=>M(l=>({...l,description:s.target.value})),placeholder:"Descrição opcional"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"serviceCategory",children:"Categoria *"}),e.jsxs(W,{required:!0,value:C.category,onValueChange:s=>M(l=>({...l,category:s})),children:[e.jsx(Y,{children:e.jsx(J,{})}),e.jsx(X,{children:je.map(s=>e.jsx(G,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"servicePrice",children:"Preço (R$) *"}),e.jsx(p,{id:"servicePrice",type:"number",step:"0.01",min:"0",required:!0,value:C.price,onChange:s=>M(l=>({...l,price:s.target.value})),placeholder:"0.00"})]})]}),e.jsxs(de,{children:[e.jsx(y,{type:"button",variant:"outline",onClick:()=>i(!1),children:"Cancelar"}),e.jsx(y,{type:"submit",children:"Salvar"})]})]})]})}),e.jsx(ne,{open:n,onOpenChange:P,children:e.jsxs(le,{children:[e.jsx(ce,{children:e.jsx(oe,{children:U?"Editar Despesa Recorrente":"Nova Despesa Recorrente"})}),e.jsxs("form",{onSubmit:De,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"expenseDescription",children:"Descrição *"}),e.jsx(p,{id:"expenseDescription",required:!0,value:q.description,onChange:s=>K(l=>({...l,description:s.target.value})),placeholder:"Ex: Aluguel do Consultório"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(u,{htmlFor:"expenseValue",children:"Valor (R$) *"}),e.jsx(p,{id:"expenseValue",type:"number",step:"0.01",min:"0",required:!0,value:q.value,onChange:s=>K(l=>({...l,value:s.target.value})),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx(u,{htmlFor:"expenseDay",children:"Dia do Mês *"}),e.jsxs(W,{required:!0,value:q.day_of_month,onValueChange:s=>K(l=>({...l,day_of_month:s})),children:[e.jsx(Y,{children:e.jsx(J,{})}),e.jsx(X,{children:Array.from({length:31},(s,l)=>l+1).map(s=>e.jsxs(G,{value:s.toString(),children:["Dia ",s]},s))})]})]})]}),e.jsxs(de,{children:[e.jsx(y,{type:"button",variant:"outline",onClick:()=>P(!1),children:"Cancelar"}),e.jsx(y,{type:"submit",children:"Salvar"})]})]})]})}),e.jsx(Pe,{open:!!R.type,onOpenChange:s=>!s&&_({type:null,id:null}),children:e.jsxs(Te,{children:[e.jsxs(_e,{children:[e.jsx(ke,{children:"Confirmar Exclusão"}),e.jsxs(Ae,{children:["Tem certeza que deseja excluir este ",R.type==="service"?"serviço":"despesa","? Esta ação não pode ser desfeita."]})]}),e.jsxs(Re,{children:[e.jsx(qe,{children:"Cancelar"}),e.jsx(ze,{onClick:()=>{R.type==="service"?Se(R.id):Ee(R.id)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})})]})}const Ts=()=>{const{user:a,updateUserProfile:d}=ge();Z();const[r,j]=o.useState(!0),[x,h]=o.useState(null);o.useEffect(()=>{a&&a.profile&&(h(a.profile),j(!1))},[a]);const g=m=>{h(m),d(m)};return r||!a||!a.profile?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx(z,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("main",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsx(S,{children:e.jsx(b,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-primary/10",children:e.jsx(Ue,{className:"w-8 h-8 text-primary"})}),e.jsxs("div",{children:[e.jsx(D,{className:"text-3xl",children:"Ajustes do Consultório"}),e.jsx(E,{className:"text-base mt-1",children:"Configure todas as informações e preferências do seu consultório em um só lugar"})]})]})})}),e.jsx(S,{children:e.jsx(F,{className:"p-0",children:e.jsxs(Me,{defaultValue:"personal",className:"w-full",children:[e.jsxs(Ve,{className:"grid w-full grid-cols-4 h-auto p-1",children:[e.jsxs(B,{value:"personal",className:"flex items-center gap-2 py-3",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Dados & Branding"}),e.jsx("span",{className:"sm:hidden",children:"Dados"})]}),e.jsxs(B,{value:"agenda",className:"flex items-center gap-2 py-3",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Agenda & Horários"}),e.jsx("span",{className:"sm:hidden",children:"Agenda"})]}),e.jsxs(B,{value:"financial",className:"flex items-center gap-2 py-3",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Financeiro & Serviços"}),e.jsx("span",{className:"sm:hidden",children:"Financeiro"})]}),e.jsxs(B,{value:"account",className:"flex items-center gap-2 py-3",children:[e.jsx(Ze,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Conta"}),e.jsx("span",{className:"sm:hidden",children:"Conta"})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx(I,{value:"personal",className:"mt-0",children:e.jsx(as,{profile:x,onUpdate:g})}),e.jsx(I,{value:"agenda",className:"mt-0",children:e.jsx(cs,{userId:a.id,onUpdate:g})}),e.jsx(I,{value:"financial",className:"mt-0",children:e.jsx(os,{userId:a.id,onUpdate:g})}),e.jsx(I,{value:"account",className:"mt-0",children:e.jsxs(S,{children:[e.jsxs(b,{children:[e.jsx(D,{children:"Configurações da Conta"}),e.jsx(E,{children:"Gerencie sua senha e preferências de conta"})]}),e.jsxs(F,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"E-mail"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.email})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Para alterar sua senha, entre em contato com o suporte ou use a funcionalidade de recuperação de senha na página de login."})})]})]})})]})]})})})]})})})};export{Ts as default};
