import{q as We,b as zs,as as Ps,u as Ms,a as Os,r as a,s as qs,ae as Z,j as e,ai as F,aj as k,ak as E,al as A,au as O,B as i,F as q,L as v,an as R,C as Be,e as He,I as Ve,R as me,M as Rs,v as Is,D as $s,x as Bs,y as Hs,z as Vs,av as Gs,A as ue,h as xe,i as he,k as pe,l as fe,n as ge,o as je,p as ve}from"./index-DGgtqe62.js";import{I as be}from"./input-C1Ic9mBe.js";import{T as Ks}from"./textarea-CBcJgsLM.js";import{L as b}from"./label-ByZ_-J2k.js";import{B as Ne}from"./badge-DGVDmpcG.js";import{A as Qs,a as Us}from"./alert-CXf0xPB7.js";import{S as Ge,a as Ke,b as Qe,c as Ue,d as u}from"./select-D8SYYGjz.js";import{C as Zs}from"./checkbox-CqUe7DNy.js";import{a as Js,b as Ws,c as Xs,d as Ys,e as ea,u as sa,f as aa,h as ta,i as ra,j as la,k as ia,l as oa,m as na,n as ca}from"./anamnesis-queries-B86s8gfB.js";import{P as N}from"./plus-DLJbgUL_.js";import{A as da}from"./arrow-left-Dh54ORp5.js";import{C as Ze}from"./clipboard-list-DBXMmtvm.js";import{A as ma}from"./alert-circle-DxwQXhkG.js";import{M as ua}from"./more-vertical-CWkyer9S.js";import"./extends-CF3RwP-h.js";import"./index-zv1rXw9e.js";const xa=We("FolderCog",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["path",{d:"M10.3 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v3.3",key:"1k8050"}],["path",{d:"m21.7 19.4-.9-.3",key:"1qgwi9"}],["path",{d:"m15.2 16.9-.9-.3",key:"1t7mvx"}],["path",{d:"m16.6 21.7.3-.9",key:"1j67ps"}],["path",{d:"m19.1 15.2.3-.9",key:"18r7jp"}],["path",{d:"m19.6 21.7-.4-1",key:"z2vh2"}],["path",{d:"m16.8 15.3-.4-1",key:"1ei7r6"}],["path",{d:"m14.3 19.6 1-.4",key:"11sv9r"}],["path",{d:"m20.7 16.8 1-.4",key:"19m87a"}]]),Je=We("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),_a=()=>{const _=zs(),{patientId:x}=Ps(),{user:h}=Ms(),{toast:o}=Os(),[we,Xe]=a.useState(null),[J,ye]=a.useState([]),[Ye,Ce]=a.useState(!0),[Se,Te]=a.useState(null),[I,es]=a.useState([]),[p,ss]=a.useState([]),[as,W]=a.useState(!1),[ts,w]=a.useState(!1),[L,rs]=a.useState(null),[g,ls]=a.useState(null),[is,y]=a.useState(!1),[ha,pa]=a.useState({title:"",description:""}),[X,De]=a.useState(!1),[os,z]=a.useState(!1),[C,$]=a.useState(null),[B,H]=a.useState([]),[ns,Fe]=a.useState(!1),[Y,P]=a.useState(!1),[m,ee]=a.useState(null),[V,se]=a.useState({fieldLabel:"",fieldType:"texto_curto",category:"geral",isRequired:!1,optionsArray:""}),[cs,ae]=a.useState(!1),[S,ke]=a.useState(null),[te,Ee]=a.useState(!1),[ds,G]=a.useState(!1),[re,le]=a.useState(null),[ie,Ae]=a.useState(!1),[ms,oe]=a.useState(!1),[K,_e]=a.useState(null),[ne,Le]=a.useState(!1),ze=a.useCallback(async()=>{if(!(!x||!h?.id)){Ce(!0),Te(null);try{const{data:s,error:t}=await qs.from("user_profiles").select("id, name").eq("id",x).single();if(t)throw t;Xe(s);const{data:l,error:c}=await Js(x);if(c)throw c;ye(l||[]);const{data:n,error:f}=await Ws(h.id);if(f)throw f;const M=(n||[]).filter(Q=>Q.is_system_default===!0);es(M),await ce()}catch(s){console.error("Erro ao carregar dados:",s),Te(s.message||"Erro ao carregar dados")}finally{Ce(!1)}}},[x,h?.id]),ce=async()=>{if(h?.id)try{const{data:s,error:t}=await Xs(h.id);if(t)throw t;ss(s||[])}catch(s){console.error("Erro ao carregar templates personalizados:",s)}};a.useEffect(()=>{ze()},[ze]);const Pe=()=>{W(!0)},Me=s=>{if(rs(s),W(!1),s==="standard"){if(I.length===0){o({title:"Atenção",description:"Nenhum template padrão disponível.",variant:"destructive"});return}if(I.length===1){_(`/nutritionist/patients/${x}/anamnesis/new?templateId=${I[0].id}`);return}w(!0)}else if(s==="custom"){if(p.length===0){y(!0);return}w(!0)}},us=()=>{g&&(w(!1),L==="standard"?_(`/nutritionist/patients/${x}/anamnesis/new?templateId=${g}`):L==="custom"&&_(`/nutritionist/patients/${x}/anamnesis/new?customTemplateId=${g}`))},Oe=a.useCallback(async s=>{$(s),Fe(!0);try{const{data:t,error:l}=await Ys(h.id,s.id);if(l)throw l;H(t||[])}catch(t){console.error("Erro ao carregar campos:",t),o({title:"Erro",description:"Erro ao carregar campos do formulário.",variant:"destructive"})}finally{Fe(!1)}},[h?.id,o]),qe=a.useCallback(()=>{ee(null),se({fieldLabel:"",fieldType:"texto_curto",category:"geral",isRequired:!1,optionsArray:""}),P(!0)},[]),xs=a.useCallback(s=>{ee(s),se({fieldLabel:s.field_label,fieldType:s.field_type,category:s.category||"geral",isRequired:s.is_required||!1,optionsArray:""}),P(!0)},[]),hs=async()=>{if(K){Le(!0);try{const{error:s}=await ca(K.id);if(s)throw s;H(t=>t.filter(l=>l.id!==K.id)),oe(!1),_e(null),o({title:"Sucesso!",description:"Pergunta excluída com sucesso."})}catch(s){console.error("Erro ao excluir campo:",s),o({title:"Erro",description:"Erro ao excluir pergunta.",variant:"destructive"})}finally{Le(!1)}}},ps=async()=>{if(re){Ae(!0);try{const{error:s}=await na(re.id);if(s)throw s;await ce(),G(!1),le(null),$(null),o({title:"Sucesso!",description:"Formulário excluído com sucesso."})}catch(s){console.error("Erro ao excluir formulário:",s),o({title:"Erro",description:"Erro ao excluir formulário.",variant:"destructive"})}finally{Ae(!1)}}},fs=s=>{_(`/nutritionist/patients/${x}/anamnesis/${s}/edit`)},gs=(s,t)=>{t.stopPropagation(),ke(s),ae(!0)},js=async()=>{if(S){Ee(!0);try{const{error:s}=await oa(S.id);if(s)throw s;ye(t=>t.filter(l=>l.id!==S.id)),ae(!1),ke(null),o({title:"Sucesso!",description:"Anamnese excluída com sucesso."})}catch(s){console.error("Erro ao excluir anamnese:",s),o({title:"Erro ao excluir anamnese",description:s.message,variant:"destructive"})}finally{Ee(!1)}}},vs=()=>e.jsx(Be,{className:"border-dashed border-2 border-[#a9b388] bg-[#fefae0]/30",children:e.jsxs(He,{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-[#fefae0] flex items-center justify-center mb-6",children:e.jsx(Ze,{className:"w-10 h-10 text-[#5f6f52]"})}),e.jsx("h3",{className:"text-xl font-semibold text-foreground mb-3",children:"Nenhuma Anamnese Preenchida"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-8 max-w-md",children:"Inicie a primeira anamnese usando um formulário padrão ou crie seu próprio formulário personalizado."}),e.jsxs(i,{onClick:Pe,size:"lg",className:"gap-2",children:[e.jsx(N,{className:"w-5 h-5"}),"Iniciar Anamnese"]})]})}),bs=({anamnesis:s})=>{const t={draft:{label:"Rascunho",color:"bg-yellow-100 text-yellow-800 border-yellow-300"},completed:{label:"Completa",color:"bg-green-100 text-green-800 border-green-300"}},l=t[s.status]||t.draft;return e.jsx(Be,{className:"hover:shadow-md transition-all hover:border-[#5f6f52]",children:e.jsx(He,{className:"p-0",children:e.jsxs("div",{className:"flex items-start gap-4 p-6 group",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 rounded-lg bg-[#5f6f52]/10 flex items-center justify-center",children:e.jsx(Ve,{className:"w-6 h-6 text-[#5f6f52]"})})}),e.jsxs("button",{onClick:()=>fs(s.id),className:"flex-1 min-w-0 text-left hover:bg-[#fefae0]/30 -mx-4 -my-6 px-4 py-6 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h4",{className:"font-semibold text-base text-foreground",children:s.template?.title||"Anamnese"}),e.jsx(Ne,{variant:"outline",className:me("text-xs",l.color),children:l.label})]}),e.jsx(Rs,{className:"w-5 h-5 text-muted-foreground flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground",children:[e.jsx(Is,{className:"w-4 h-4"}),new Date(s.date).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"})]}),s.updated_at&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Última modificação: ",new Date(s.updated_at).toLocaleDateString("pt-BR")," às"," ",new Date(s.updated_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]}),s.notes&&e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:s.notes})]}),e.jsxs($s,{children:[e.jsx(Bs,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:c=>c.stopPropagation(),children:e.jsx(ua,{className:"h-4 w-4"})})}),e.jsx(Hs,{align:"end",children:e.jsxs(Vs,{onClick:c=>gs(s,c),className:"text-red-600 focus:text-red-600 focus:bg-red-50",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Excluir"]})})]})]})})})},Ns=()=>e.jsx(F,{open:as,onOpenChange:W,children:e.jsxs(k,{className:"max-w-2xl",children:[e.jsxs(E,{children:[e.jsx(A,{children:"Como deseja preencher a anamnese?"}),e.jsx(O,{children:"Escolha entre um formulário padrão ou crie seu próprio formulário personalizado"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 py-4",children:[e.jsxs("button",{onClick:()=>Me("standard"),className:"p-6 rounded-lg border-2 border-gray-200 hover:border-[#5f6f52] hover:bg-[#fefae0]/30 transition-all text-left group",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-[#5f6f52]/10 flex items-center justify-center mb-4 group-hover:bg-[#5f6f52]/20 transition-colors",children:e.jsx(Ve,{className:"w-6 h-6 text-[#5f6f52]"})}),e.jsx("h3",{className:"font-semibold text-base mb-2",children:"Formulário Padrão"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Use o template completo de anamnese nutricional com perguntas pré-definidas."})]}),e.jsxs("button",{onClick:()=>Me("custom"),className:"p-6 rounded-lg border-2 border-gray-200 hover:border-[#5f6f52] hover:bg-[#fefae0]/30 transition-all text-left group",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-[#a9b388]/10 flex items-center justify-center mb-4 group-hover:bg-[#a9b388]/20 transition-colors",children:e.jsx(Gs,{className:"w-6 h-6 text-[#5f6f52]"})}),e.jsxs("h3",{className:"font-semibold text-base mb-2",children:["Formulários Personalizados",p.length>0&&e.jsx(Ne,{className:"ml-2 bg-[#5f6f52]",children:p.length})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:p.length>0?"Escolha um dos seus formulários personalizados ou crie um novo.":"Crie seu primeiro formulário personalizado com perguntas sob medida."})]})]})]})}),ws=()=>{const s=L==="standard"?I:p;return e.jsx(F,{open:ts,onOpenChange:w,children:e.jsxs(k,{className:"max-w-md",children:[e.jsxs(E,{children:[e.jsx(A,{children:L==="standard"?"Escolher Formulário Padrão":"Escolher Formulário Personalizado"}),e.jsx(O,{children:"Selecione o formulário que deseja utilizar"})]}),e.jsxs("div",{className:"space-y-2 py-4 max-h-[400px] overflow-y-auto",children:[s.map(t=>e.jsx("button",{onClick:()=>ls(t.id),className:me("w-full text-left p-4 rounded-lg border-2 transition-all",g===t.id?"border-[#5f6f52] bg-[#5f6f52]/5":"border-gray-200 hover:border-[#5f6f52]/50"),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:me("w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 mt-0.5",g===t.id?"border-[#5f6f52] bg-[#5f6f52]":"border-gray-300"),children:g===t.id&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold text-sm",children:t.title}),t.is_system_default&&e.jsx(Ne,{variant:"outline",className:"text-xs bg-[#5f6f52]/10 text-[#5f6f52] border-[#5f6f52]",children:"Padrão"})]}),t.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:t.description})]})]})},t.id)),L==="custom"&&e.jsx("button",{onClick:()=>{w(!1),y(!0)},className:"w-full text-left p-4 rounded-lg border-2 border-dashed border-gray-300 hover:border-[#5f6f52] hover:bg-[#fefae0]/30 transition-all",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-[#fefae0] flex items-center justify-center",children:e.jsx(N,{className:"w-5 h-5 text-[#5f6f52]"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Criar Novo Formulário"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Monte um formulário personalizado do zero"})]})]})})]}),e.jsxs(R,{children:[e.jsx(i,{variant:"outline",onClick:()=>w(!1),children:"Cancelar"}),e.jsx(i,{onClick:us,disabled:!g,children:"Continuar"})]})]})})},ys=()=>{const[s,t]=a.useState(""),[l,c]=a.useState("");return e.jsx(F,{open:is,onOpenChange:y,children:e.jsxs(k,{className:"max-w-md",children:[e.jsxs(E,{children:[e.jsx(A,{children:"Criar Formulário Personalizado"}),e.jsx(O,{children:"Dê um nome ao seu formulário. Você poderá adicionar perguntas na próxima etapa."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"custom-title",children:"Nome do Formulário *"}),e.jsx(be,{id:"custom-title",value:s,onChange:n=>t(n.target.value),placeholder:"Ex: Anamnese para Emagrecimento",maxLength:100})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"custom-description",children:"Descrição (opcional)"}),e.jsx(Ks,{id:"custom-description",value:l,onChange:n=>c(n.target.value),placeholder:"Descreva o objetivo deste formulário...",rows:3,maxLength:500})]})]}),e.jsxs(R,{children:[e.jsx(i,{variant:"outline",onClick:()=>{y(!1),t(""),c("")},disabled:X,children:"Cancelar"}),e.jsx(i,{onClick:async()=>{if(!s.trim()){o({title:"Atenção",description:"Digite um nome para o formulário personalizado.",variant:"destructive"});return}De(!0);try{const{data:n,error:f}=await ia({nutritionistId:h.id,title:s,description:l});if(f)throw f;o({title:"Sucesso!",description:"Formulário personalizado criado. Agora adicione suas perguntas."}),y(!1),t(""),c(""),await ce(),Oe(n)}catch(n){console.error("Erro ao criar formulário personalizado:",n),o({title:"Erro ao criar formulário",description:n.message,variant:"destructive"})}finally{De(!1)}},disabled:X||!s.trim(),children:X?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):"Criar e Adicionar Perguntas"})]})]})})},Cs=Z.memo(()=>C?e.jsx(F,{open:!!C,onOpenChange:()=>$(null),children:e.jsxs(k,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(E,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(A,{children:["Editar Formulário: ",C?.title]}),e.jsx(O,{children:"Adicione, edite ou remova perguntas do formulário"})]}),e.jsxs(i,{variant:"ghost",size:"sm",onClick:()=>{le(C),G(!0)},className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[e.jsx(q,{className:"w-4 h-4 mr-2"}),"Excluir Formulário"]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold",children:["Perguntas (",B.length,")"]}),e.jsxs(i,{onClick:qe,size:"sm",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Adicionar Pergunta"]})]}),ns?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(v,{className:"w-6 h-6 animate-spin text-[#5f6f52]"})}):B.length===0?e.jsxs("div",{className:"text-center py-8 border-2 border-dashed rounded-lg",children:[e.jsx("p",{className:"text-muted-foreground",children:"Nenhuma pergunta adicionada ainda."}),e.jsxs(i,{onClick:qe,size:"sm",className:"mt-4",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Adicionar Primeira Pergunta"]})]}):e.jsx("div",{className:"space-y-2",children:B.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["#",t+1]}),e.jsx("p",{className:"font-medium",children:s.field_label})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Tipo: ",s.field_type.replace("_"," ")]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>xs(s),children:e.jsx(Je,{className:"w-4 h-4"})}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>{_e(s),oe(!0)},children:e.jsx(q,{className:"w-4 h-4 text-destructive"})})]})]},s.id))})]}),e.jsx(R,{children:e.jsx(i,{onClick:()=>$(null),children:"Concluir"})})]})}):null),Ss=Z.memo(()=>{const[s,t]=a.useState(""),[l,c]=a.useState("texto_curto"),[n,f]=a.useState("geral"),[M,Q]=a.useState(!1),[T,j]=a.useState([]),[de,Re]=a.useState(""),[ks,Ie]=a.useState(!1),Es=Z.useCallback(async()=>{if(m){Ie(!0);try{const{data:r,error:d}=await ea(m.id);if(d)throw d;j((r||[]).map(D=>D.option_text))}catch(r){console.error("Erro ao carregar opções:",r)}finally{Ie(!1)}}},[m?.id]);Z.useEffect(()=>{Y&&(t(V.fieldLabel),c(V.fieldType),f(V.category),Q(V.isRequired),m&&(m.field_type==="selecao_unica"||m.field_type==="selecao_multipla")?Es():j([]))},[Y]);const $e=()=>{de.trim()&&(j(r=>[...r,de.trim()]),Re(""))},As=r=>{j(d=>d.filter((D,U)=>U!==r))},_s=async()=>{if(!s.trim()){o({title:"Atenção",description:"Digite o nome da pergunta.",variant:"destructive"});return}if((l==="selecao_unica"||l==="selecao_multipla")&&T.length===0){o({title:"Atenção",description:"Adicione pelo menos uma opção para campos de seleção.",variant:"destructive"});return}try{if(m){const{data:r,error:d}=await sa(m.id,{fieldLabel:s,fieldType:l,category:n,isRequired:M});if(d)throw d;(l==="selecao_unica"||l==="selecao_multipla")&&await aa(m.id,T),H(D=>D.map(U=>U.id===r.id?r:U)),o({title:"Sucesso!",description:"Pergunta atualizada com sucesso."})}else{const{data:r,error:d}=await ta({nutritionistId:h.id,fieldLabel:s,fieldType:l,category:n,isRequired:M});if(d)throw d;(l==="selecao_unica"||l==="selecao_multipla")&&await ra(r.id,T),C&&await la(C.id,r.id,B.length),H(D=>[...D,r]),o({title:"Sucesso!",description:"Pergunta adicionada com sucesso."})}P(!1),ee(null),se({fieldLabel:"",fieldType:"texto_curto",category:"geral",isRequired:!1,optionsArray:""}),j([])}catch(r){console.error("Erro ao salvar campo:",r),o({title:"Erro ao salvar pergunta",description:r.message,variant:"destructive"})}},Ls=l==="selecao_unica"||l==="selecao_multipla";return e.jsx(F,{open:Y,onOpenChange:P,children:e.jsxs(k,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(E,{children:e.jsx(A,{children:m?"Editar Pergunta":"Nova Pergunta"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"field-label",children:"Nome da Pergunta"}),e.jsx(be,{id:"field-label",value:s,onChange:r=>t(r.target.value),placeholder:"Ex: Qual seu objetivo com a consulta?"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"field-type",children:"Tipo de Campo"}),e.jsxs(Ge,{value:l,onValueChange:r=>{c(r),r!=="selecao_unica"&&r!=="selecao_multipla"&&j([])},children:[e.jsx(Ke,{id:"field-type",children:e.jsx(Qe,{})}),e.jsxs(Ue,{children:[e.jsx(u,{value:"texto_curto",children:"Texto Curto"}),e.jsx(u,{value:"texto_longo",children:"Texto Longo"}),e.jsx(u,{value:"selecao_unica",children:"Seleção Única"}),e.jsx(u,{value:"selecao_multipla",children:"Seleção Múltipla"})]})]})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"field-category",children:"Categoria"}),e.jsxs(Ge,{value:n,onValueChange:f,children:[e.jsx(Ke,{id:"field-category",children:e.jsx(Qe,{})}),e.jsxs(Ue,{children:[e.jsx(u,{value:"geral",children:"Geral"}),e.jsx(u,{value:"identificacao",children:"Identificação"}),e.jsx(u,{value:"historico_clinico",children:"Histórico Clínico"}),e.jsx(u,{value:"historico_familiar",children:"Histórico Familiar"}),e.jsx(u,{value:"habitos_vida",children:"Hábitos de Vida"}),e.jsx(u,{value:"objetivos",children:"Objetivos"}),e.jsx(u,{value:"habitos_alimentares",children:"Hábitos Alimentares"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Zs,{id:"field-required",checked:M,onCheckedChange:Q}),e.jsx(b,{htmlFor:"field-required",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:"Campo obrigatório"})]}),Ls&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(b,{children:"Opções de Resposta"}),ks?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(v,{className:"w-4 h-4 animate-spin"})}):e.jsxs(e.Fragment,{children:[T.length>0&&e.jsx("div",{className:"space-y-2 mb-3",children:T.map((r,d)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-muted rounded-md",children:[e.jsx("span",{className:"flex-1 text-sm",children:r}),e.jsx(i,{type:"button",size:"sm",variant:"ghost",onClick:()=>As(d),children:e.jsx(q,{className:"w-4 h-4 text-red-500"})})]},d))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(be,{value:de,onChange:r=>Re(r.target.value),placeholder:"Digite uma opção...",onKeyPress:r=>{r.key==="Enter"&&(r.preventDefault(),$e())}}),e.jsx(i,{type:"button",onClick:$e,variant:"outline",children:e.jsx(N,{className:"w-4 h-4"})})]}),T.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"Adicione pelo menos uma opção de resposta"})]})]})]}),e.jsxs(R,{children:[e.jsx(i,{variant:"outline",onClick:()=>{P(!1),j([])},children:"Cancelar"}),e.jsx(i,{onClick:_s,children:m?"Salvar":"Adicionar"})]})]})})}),Ts=()=>e.jsx(ue,{open:cs,onOpenChange:ae,children:e.jsxs(xe,{children:[e.jsxs(he,{children:[e.jsx(pe,{children:"Confirmar Exclusão"}),e.jsxs(fe,{children:["Tem certeza que deseja excluir esta anamnese? Esta ação não pode ser desfeita.",S&&e.jsxs("div",{className:"mt-3 p-3 bg-[#fefae0] rounded-lg border border-[#a9b388]",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:S.template?.title||"Anamnese"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Data: ",new Date(S.date).toLocaleDateString("pt-BR")]})]})]})]}),e.jsxs(ge,{children:[e.jsx(je,{disabled:te,children:"Cancelar"}),e.jsx(ve,{onClick:js,disabled:te,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:te?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mr-2 h-4 w-4 animate-spin"}),"Excluindo..."]}):"Excluir"})]})]})}),Ds=()=>e.jsx(ue,{open:ds,onOpenChange:G,children:e.jsxs(xe,{children:[e.jsxs(he,{children:[e.jsx(pe,{children:"Confirmar Exclusão do Formulário"}),e.jsxs(fe,{children:['Tem certeza que deseja excluir o formulário "',re?.title,'"? Todas as perguntas associadas serão excluídas permanentemente.']})]}),e.jsxs(ge,{children:[e.jsx(je,{disabled:ie,children:"Cancelar"}),e.jsx(ve,{onClick:ps,disabled:ie,className:"bg-red-600 hover:bg-red-700",children:ie?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mr-2 h-4 w-4 animate-spin"}),"Excluindo..."]}):"Excluir"})]})]})}),Fs=()=>e.jsx(ue,{open:ms,onOpenChange:oe,children:e.jsxs(xe,{children:[e.jsxs(he,{children:[e.jsx(pe,{children:"Confirmar Exclusão da Pergunta"}),e.jsxs(fe,{children:['Tem certeza que deseja excluir a pergunta "',K?.field_label,'"?']})]}),e.jsxs(ge,{children:[e.jsx(je,{disabled:ne,children:"Cancelar"}),e.jsx(ve,{onClick:hs,disabled:ne,className:"bg-red-600 hover:bg-red-700",children:ne?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mr-2 h-4 w-4 animate-spin"}),"Excluindo..."]}):"Excluir"})]})]})});return Ye?e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx(v,{className:"w-8 h-8 animate-spin text-[#5f6f52] mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando..."})]})}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("div",{className:"max-w-5xl mx-auto p-4 sm:p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs(i,{variant:"ghost",size:"sm",onClick:()=>_(`/nutritionist/patients/${x}/hub`),className:"mb-3 -ml-2 text-[#5f6f52] hover:text-[#5f6f52] hover:bg-[#5f6f52]/10",children:[e.jsx(da,{className:"w-4 h-4 mr-1"}),"Voltar"]}),e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground flex items-center gap-2 sm:gap-3",children:[e.jsx(Ze,{className:"w-6 h-6 sm:w-8 sm:h-8 text-[#5f6f52]"}),e.jsx("span",{className:"truncate",children:"Anamnese"})]}),we&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 truncate",children:["Paciente: ",e.jsx("span",{className:"font-medium text-foreground",children:we.name})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[p.length>0&&e.jsxs(i,{variant:"outline",onClick:()=>z(!0),className:"flex-1 sm:flex-none",children:[e.jsx(xa,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Gerenciar Formulários"}),e.jsx("span",{className:"sm:hidden",children:"Gerenciar"})]}),J.length>0&&e.jsxs(i,{onClick:Pe,size:"lg",className:"gap-2 flex-1 sm:flex-none",children:[e.jsx(N,{className:"w-5 h-5"}),"Nova Anamnese"]})]})]}),Se&&e.jsxs(Qs,{variant:"destructive",children:[e.jsx(ma,{className:"h-4 w-4"}),e.jsx(Us,{children:Se})]}),J.length===0?e.jsx(vs,{}):e.jsx("div",{className:"space-y-4",children:J.map(s=>e.jsx(bs,{anamnesis:s},s.id))})]}),e.jsx(Ns,{}),e.jsx(ws,{}),e.jsx(ys,{}),e.jsx(Cs,{}),e.jsx(Ss,{}),e.jsx(Ts,{}),e.jsx(Ds,{}),e.jsx(Fs,{}),e.jsx(F,{open:os,onOpenChange:z,children:e.jsxs(k,{className:"max-w-2xl",children:[e.jsxs(E,{children:[e.jsx(A,{children:"Meus Formulários Personalizados"}),e.jsx(O,{children:"Gerencie seus formulários de anamnese personalizados"})]}),e.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:p.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Nenhum formulário personalizado criado ainda."}):p.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>{z(!1),Oe(s)},children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Editar Campos"]}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>{le(s),G(!0)},children:e.jsx(q,{className:"w-4 h-4 text-destructive"})})]})]},s.id))}),e.jsxs(R,{children:[e.jsx(i,{variant:"outline",onClick:()=>z(!1),children:"Fechar"}),e.jsxs(i,{onClick:()=>{z(!1),y(!0)},children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Novo Formulário"]})]})]})})]})};export{_a as default};
