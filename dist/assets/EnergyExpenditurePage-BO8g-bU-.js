import{q as xe,as as Ye,b as $e,a as Xe,r as x,s as D,j as e,B as v,C as A,c as S,d as M,w as k,e as E,F as Ue,ar as Je,ai as ge,aj as pe,ak as fe,al as ve,au as je,an as be}from"./index-tlGv3_XP.js";import{I as O}from"./input-LGp_IBjh.js";import{L as N}from"./label-VXhiBOq2.js";import{S as K,a as Y,b as $,c as X,d as y}from"./select-0mldc7nn.js";import{C as Qe}from"./checkbox-CmDWcyhg.js";import{B as q}from"./badge-C6tqPbcd.js";import{A as Ze}from"./arrow-left-BjB0YXx2.js";import{F as de}from"./flame-BXEHpETp.js";import{P as et}from"./plus-DnrmLjkx.js";import{P as tt}from"./pen-square-CnNmr5nf.js";import{C as Z}from"./calculator-c36F5aER.js";import{R as st}from"./refresh-cw-CPYBkQ6g.js";import{S as at}from"./save-3SR3qEUM.js";import{H as me}from"./history-CKuqGi3I.js";import{A as he}from"./activity-v2uZOt3K.js";import{R as it,T as rt,p as ot}from"./generateCategoricalChart-BNfhPBao.js";import{a as lt,L as ue}from"./LineChart-B-1yvkPh.js";import{C as nt}from"./CartesianGrid-CM6rNJ3K.js";import{X as ct,Y as dt}from"./YAxis-BU7kdzca.js";import"./extends-CF3RwP-h.js";import"./index-D9YzHVDx.js";const ye=xe("GitCompare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]),mt=xe("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),ee=[{value:"walking-light",label:"Caminhada Leve",met:3.5},{value:"walking-moderate",label:"Caminhada Moderada",met:4.5},{value:"running-light",label:"Corrida Leve",met:7},{value:"running-moderate",label:"Corrida Moderada",met:9},{value:"swimming",label:"NataÃ§Ã£o",met:6},{value:"cycling-light",label:"Ciclismo Leve",met:5},{value:"cycling-moderate",label:"Ciclismo Moderado",met:8},{value:"weight-training",label:"MusculaÃ§Ã£o",met:5},{value:"yoga",label:"Yoga",met:2.5},{value:"pilates",label:"Pilates",met:3},{value:"dance",label:"DanÃ§a",met:4.5},{value:"soccer",label:"Futebol",met:7},{value:"basketball",label:"Basquete",met:6.5},{value:"tennis",label:"TÃªnis",met:7},{value:"volleyball",label:"VÃ´lei",met:4},{value:"other",label:"Outra Atividade",met:5}],ht=({isOpen:g,onClose:j,onSave:d,activity:m,patientWeight:F})=>{const[l,w]=x.useState({activity_type:"",duration:"",frequency:"",custom_name:""});x.useEffect(()=>{w(m?{activity_type:m.activity_type,duration:m.duration?.toString()||"",frequency:m.frequency?.toString()||"",custom_name:m.custom_name||""}:{activity_type:"",duration:"",frequency:"",custom_name:""})},[m,g]);const R=ee.find(c=>c.value===l.activity_type),P=()=>{if(!R||!l.duration||!l.frequency||!F)return 0;const c=parseFloat(l.duration)/60,p=R.met,_=parseFloat(F),U=parseInt(l.frequency),J=p*_*c*U/7;return Math.round(J)},r=()=>{!l.activity_type||!l.duration||!l.frequency||(d({...m,activity_type:l.activity_type,duration:parseInt(l.duration),frequency:parseInt(l.frequency),custom_name:l.custom_name,calories:P()}),j())};return e.jsx(ge,{open:g,onOpenChange:j,children:e.jsxs(pe,{className:"sm:max-w-[500px]",children:[e.jsxs(fe,{children:[e.jsx(ve,{children:m?"Editar Atividade":"Adicionar Atividade FÃ­sica"}),e.jsx(je,{children:"Adicione as atividades fÃ­sicas praticadas pelo paciente para um cÃ¡lculo mais preciso."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"activity-type",children:"Atividade"}),e.jsxs(K,{value:l.activity_type,onValueChange:c=>w({...l,activity_type:c}),children:[e.jsx(Y,{id:"activity-type",children:e.jsx($,{placeholder:"Selecione a atividade..."})}),e.jsx(X,{children:ee.map(c=>e.jsxs(y,{value:c.value,children:[c.label," (",c.met," MET)"]},c.value))})]})]}),l.activity_type==="other"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"custom-name",children:"Nome da Atividade"}),e.jsx(O,{id:"custom-name",value:l.custom_name,onChange:c=>w({...l,custom_name:c.target.value}),placeholder:"Ex: Crossfit"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"duration",children:"DuraÃ§Ã£o por SessÃ£o (minutos)"}),e.jsx(O,{id:"duration",type:"number",min:"1",max:"360",value:l.duration,onChange:c=>w({...l,duration:c.target.value}),placeholder:"60"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"frequency",children:"FrequÃªncia (vezes por semana)"}),e.jsx(O,{id:"frequency",type:"number",min:"1",max:"7",value:l.frequency,onChange:c=>w({...l,frequency:c.target.value}),placeholder:"3"})]}),l.activity_type&&l.duration&&l.frequency&&e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Gasto estimado:"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:["+",P()," ",e.jsx("span",{className:"text-sm font-normal",children:"kcal/dia"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["(mÃ©dia diÃ¡ria considerando ",l.frequency,"x por semana)"]})]})]}),e.jsxs(be,{children:[e.jsx(v,{variant:"outline",onClick:j,children:"Cancelar"}),e.jsx(v,{onClick:r,disabled:!l.activity_type||!l.duration||!l.frequency,children:"Salvar"})]})]})})},ut=({isOpen:g,onClose:j,comparisons:d})=>!d||d.length===0?null:e.jsx(ge,{open:g,onOpenChange:j,children:e.jsxs(pe,{className:"sm:max-w-[700px] max-h-[80vh] overflow-y-auto",children:[e.jsxs(fe,{children:[e.jsxs(ve,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-primary"}),"ComparaÃ§Ã£o de Protocolos"]}),e.jsxs(je,{children:["Comparando ",d.length," protocolos diferentes com os mesmos dados antropomÃ©tricos"]})]}),e.jsx("div",{className:"space-y-3",children:d.map((m,F)=>e.jsxs("div",{className:"p-4 rounded-lg border border-border bg-muted/30 hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-foreground",children:m.protocolName}),e.jsx("p",{className:"text-xs text-muted-foreground",children:m.protocol})]}),F===0&&e.jsx(q,{variant:"outline",className:"text-xs",children:"Mais utilizado"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[!m.protocol.startsWith("eer-iom")&&e.jsxs("div",{className:"text-center p-2 bg-background rounded border border-[#c4661f]/30",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"TMB"}),e.jsx("div",{className:"text-xl font-bold text-[#c4661f]",children:m.tmb}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"kcal/dia"})]}),e.jsxs("div",{className:`text-center p-2 bg-gradient-to-br from-[#5f6f52]/10 to-[#a9b388]/10 rounded border border-[#5f6f52]/30 ${m.protocol.startsWith("eer-iom")?"col-span-2":""}`,children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:m.protocol.startsWith("eer-iom")?"EER":"GET"}),e.jsx("div",{className:"text-xl font-bold text-[#5f6f52]",children:m.get}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"kcal/dia"})]})]})]},m.protocol))}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-xs text-blue-900",children:[e.jsx("strong",{children:"Nota:"})," As diferenÃ§as entre protocolos sÃ£o normais. Escolha o protocolo mais adequado ao perfil do paciente e suas necessidades clÃ­nicas."]})}),e.jsx(be,{children:e.jsx(v,{onClick:j,variant:"outline",children:"Fechar"})})]})}),xt=({historyData:g})=>{if(!g||g.length===0)return null;const j=g.slice(0,10).reverse().map(d=>({date:new Date(d.created_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),GET:Math.round(d.get_with_activities||d.get||0),TMB:Math.round(d.tmb||0),fullDate:new Date(d.created_at).toLocaleDateString("pt-BR")}));return e.jsxs(A,{className:"mt-6",children:[e.jsxs(S,{children:[e.jsxs(M,{className:"flex items-center gap-2 text-base",children:[e.jsx(Je,{className:"w-5 h-5 text-primary"}),"EvoluÃ§Ã£o do Gasto EnergÃ©tico"]}),e.jsxs(k,{children:["HistÃ³rico dos Ãºltimos ",j.length," cÃ¡lculos realizados"]})]}),e.jsx(E,{children:e.jsx(it,{width:"100%",height:300,children:e.jsxs(lt,{data:j,children:[e.jsx(nt,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(ct,{dataKey:"date",stroke:"#6b7280",fontSize:12}),e.jsx(dt,{stroke:"#6b7280",fontSize:12,label:{value:"kcal/dia",angle:-90,position:"insideLeft",style:{fontSize:12}}}),e.jsx(rt,{contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px",fontSize:"12px"}}),e.jsx(ot,{wrapperStyle:{fontSize:"12px"}}),e.jsx(ue,{type:"monotone",dataKey:"TMB",stroke:"#c4661f",strokeWidth:2,dot:{r:4},name:"TMB (kcal)"}),e.jsx(ue,{type:"monotone",dataKey:"GET",stroke:"#5f6f52",strokeWidth:2,dot:{r:4},name:"GET (kcal)"})]})})})]})},Dt=()=>{const{patientId:g}=Ye(),j=$e(),{toast:d}=Xe(),[m,F]=x.useState(!0),[l,w]=x.useState(!1),[R,P]=x.useState(""),[r,c]=x.useState({weight:"",height:"",age:"",gender:"",birth_date:"",protocol:"harris-benedict",activity_level:"1.55"}),[p,_]=x.useState([]),[U,B]=x.useState(!1),[J,te]=x.useState(null),[b,W]=x.useState(!1),[f,H]=x.useState(""),[h,G]=x.useState({tmb:0,get:0,getWithActivities:0,ventaAdjusted:0}),[z,Ne]=x.useState([]),[se,ae]=x.useState(!1),[we,ie]=x.useState(!1),[_e,Ce]=x.useState([]);x.useEffect(()=>{Ae(),Me()},[g]),x.useEffect(()=>{if(r.weight&&r.height&&r.age&&r.gender&&r.protocol){const t=Q(),a=le(t,r.activity_level),o=V(),i=a+o;let s=0;b&&f&&r.weight&&(s=ne(i,r.weight,f)),G({tmb:t,get:a,getWithActivities:i,ventaAdjusted:s})}},[r,p,b,f]);const Ae=async()=>{F(!0);try{const{data:t,error:a}=await D.from("user_profiles").select("name, birth_date, gender, weight, height").eq("id",g).single();if(a)throw a;P(t.name);const{data:o}=await D.from("growth_records").select("weight, height, record_date").eq("patient_id",g).order("record_date",{ascending:!1}).limit(1).maybeSingle(),i=Se(t.birth_date);c({weight:(o?.weight||t.weight||"").toString(),height:(o?.height||t.height||"").toString(),age:i?.toString()||"",gender:t.gender||"",birth_date:t.birth_date||"",protocol:"harris-benedict",activity_level:"1.55"});const{data:s}=await D.from("energy_expenditure_calculations").select("*").eq("patient_id",g).order("created_at",{ascending:!1}).limit(1).maybeSingle();s&&(c({weight:s.weight?.toString()||"",height:s.height?.toString()||"",age:s.age?.toString()||"",gender:s.gender||"",birth_date:t.birth_date||"",protocol:s.protocol||"harris-benedict",activity_level:s.activity_level||"1.55"}),G({tmb:s.tmb||0,get:s.get||0,getWithActivities:s.get_with_activities||s.get||0,ventaAdjusted:s.venta_adjusted||0}),s.activities&&Array.isArray(s.activities)&&_(s.activities),s.target_weight&&(W(!0),H(s.target_weight.toString())))}catch(t){console.error("Erro ao carregar dados:",t),d({title:"Erro",description:"NÃ£o foi possÃ­vel carregar os dados do paciente.",variant:"destructive"})}finally{F(!1)}},Se=t=>{if(!t)return null;const a=new Date,o=new Date(t);let i=a.getFullYear()-o.getFullYear();const s=a.getMonth()-o.getMonth();return(s<0||s===0&&a.getDate()<o.getDate())&&i--,i},Me=async()=>{try{const{data:t,error:a}=await D.from("energy_expenditure_calculations").select("*").eq("patient_id",g).order("created_at",{ascending:!1}).limit(10);if(a)throw a;Ne(t||[])}catch(t){console.error("Erro ao carregar histÃ³rico:",t)}},Ee=()=>{window.print()},Fe=t=>{c({weight:t.weight?.toString()||"",height:t.height?.toString()||"",age:t.age?.toString()||"",gender:t.gender||"",birth_date:r.birth_date,protocol:t.protocol||"harris-benedict",activity_level:t.activity_level||"1.55"}),G({tmb:t.tmb||0,get:t.get||0,getWithActivities:t.get_with_activities||t.get||0,ventaAdjusted:t.venta_adjusted||0}),t.activities&&Array.isArray(t.activities)?_(t.activities):_([]),t.target_weight?(W(!0),H(t.target_weight.toString())):(W(!1),H("")),ae(!1),d({title:"CÃ¡lculo carregado",description:`CÃ¡lculo de ${new Date(t.created_at).toLocaleDateString("pt-BR")}`})},ke=()=>{if(!r.weight||!r.height||!r.age||!r.gender){d({title:"Dados incompletos",description:"Preencha todos os campos bÃ¡sicos para comparar protocolos.",variant:"destructive"});return}const t=["harris-benedict","schofield","fao-oms-2001","fao-oms-1985","eer-iom-2023","eer-iom-2005"],a=[];t.forEach(o=>{const i=Q(r.weight,r.height,r.age,r.gender),s=o.startsWith("eer-iom")?i:i*parseFloat(r.activity_level);a.push({protocol:o,protocolName:re(o),tmb:Math.round(i),get:Math.round(s)})}),Ce(a),ie(!0)},re=t=>({"harris-benedict":"Harris-Benedict",schofield:"Schofield (1985)","fao-oms-2001":"FAO/OMS (2001)","fao-oms-1985":"FAO/OMS (1985)","eer-iom-2023":"EER/IOM (2023)","eer-iom-2005":"EER/IOM (2005)","eer-iom-2005-sobrepeso":"EER/IOM (2005) Sobrepeso"})[t]||t,Oe=(t,a,o,i)=>{const s=parseFloat(t),n=parseFloat(a),u=parseInt(o);return i.toLowerCase()==="masculino"||i.toLowerCase()==="male"||i.toLowerCase()==="m"?88.362+13.397*s+4.799*n-5.677*u:447.593+9.247*s+3.098*n-4.33*u},Te=(t,a,o)=>{const i=parseFloat(t),s=parseInt(a);return o.toLowerCase()==="masculino"||o.toLowerCase()==="male"||o.toLowerCase()==="m"?s<3?59.512*i-30.4:s>=3&&s<10?22.706*i+504.3:s>=10&&s<18?17.686*i+658.2:s>=18&&s<30?15.057*i+692.2:s>=30&&s<60?11.472*i+873.1:11.711*i+587.7:s<3?58.317*i-31.1:s>=3&&s<10?20.315*i+485.9:s>=10&&s<18?13.384*i+692.6:s>=18&&s<30?14.818*i+486.6:s>=30&&s<60?8.126*i+845.6:9.082*i+658.5},Le=(t,a,o,i)=>{const s=parseFloat(t),n=parseFloat(a)/100,u=parseInt(o);return i.toLowerCase()==="masculino"||i.toLowerCase()==="male"||i.toLowerCase()==="m"?u>=18&&u<30?15.4*s-27*n+717:u>=30&&u<60?11.3*s+16*n+901:8.8*s+1128*n-1071:u>=18&&u<30?13.3*s+334*n+35:u>=30&&u<60?8.7*s-25*n+865:9.2*s+637*n-302},Ie=(t,a,o,i)=>{const s=parseFloat(t),n=parseInt(o);return i.toLowerCase()==="masculino"||i.toLowerCase()==="male"||i.toLowerCase()==="m"?n>=18&&n<30?15.3*s+679:n>=30&&n<60?11.6*s+879:13.5*s+487:n>=18&&n<30?14.7*s+496:n>=30&&n<60?8.7*s+829:10.5*s+596},oe=(t,a,o,i,s)=>{const n=parseFloat(t),u=parseFloat(a)/100,C=parseInt(o),I=parseFloat(s);return i.toLowerCase()==="masculino"||i.toLowerCase()==="male"||i.toLowerCase()==="m"?662-9.53*C+I*(15.91*n+539.6*u):354-6.91*C+I*(9.36*n+726*u)},De=(t,a,o,i,s)=>oe(t,a,o,i,s)*.9,qe=(t,a,o,i,s)=>{const n=parseFloat(t),u=parseFloat(a)/100,C=parseInt(o),I=parseFloat(s);return i.toLowerCase()==="masculino"||i.toLowerCase()==="male"||i.toLowerCase()==="m"?693-9.8*C+I*(16.2*n+545*u):378-7.1*C+I*(9.5*n+732*u)},Q=()=>{const{weight:t,height:a,age:o,gender:i,protocol:s,activity_level:n}=r;if(!t||!a||!o||!i)return 0;if(s.startsWith("eer-iom"))switch(s){case"eer-iom-2023":return qe(t,a,o,i,n);case"eer-iom-2005":return oe(t,a,o,i,n);case"eer-iom-2005-overweight":return De(t,a,o,i,n);default:return 0}switch(s){case"harris-benedict":return Oe(t,a,o,i);case"schofield":return Te(t,o,i);case"fao-oms-2001":return Le(t,a,o,i);case"fao-oms-1985":return Ie(t,a,o,i);default:return 0}},le=(t,a)=>r.protocol.startsWith("eer-iom")?t:t*parseFloat(a),V=()=>p.reduce((t,a)=>t+(a.calories||0),0),ne=(t,a,o)=>{const i=parseFloat(a),s=parseFloat(o),C=(i-s)*7700/90;return t-C},Re=()=>{const t=Q(),a=le(t,r.activity_level),o=V(),i=a+o;let s=0;b&&f&&r.weight&&(s=ne(i,r.weight,f)),G({tmb:t,get:a,getWithActivities:i,ventaAdjusted:s}),d({title:"Sucesso",description:"Gasto energÃ©tico calculado!"})},Pe=async()=>{w(!0);try{const t={patient_id:g,weight:parseFloat(r.weight),height:parseFloat(r.height),age:parseInt(r.age),gender:r.gender,protocol:r.protocol,activity_level:r.activity_level,tmb:r.protocol.startsWith("eer-iom")?0:h.tmb,get:h.get,get_with_activities:h.getWithActivities,activities:p,target_weight:b&&f?parseFloat(f):null,venta_adjusted:b?h.ventaAdjusted:null,created_at:new Date().toISOString()},{error:a}=await D.from("energy_expenditure_calculations").insert(t);if(a)throw a;d({title:"Salvo!",description:"CÃ¡lculo salvo com sucesso."})}catch(t){console.error("Erro ao salvar:",t),d({title:"Erro",description:"NÃ£o foi possÃ­vel salvar o cÃ¡lculo.",variant:"destructive"})}finally{w(!1)}},T=(t,a)=>{c(o=>({...o,[t]:a}))},Be=()=>{te(null),B(!0)},We=(t,a)=>{te({...t,index:a}),B(!0)},He=t=>{_(p.filter((a,o)=>o!==t))},Ge=t=>{if(t.index!==void 0){const a=[...p];a[t.index]={activity_type:t.activity_type,duration:t.duration,frequency:t.frequency,custom_name:t.custom_name,calories:t.calories},_(a)}else _([...p,{activity_type:t.activity_type,duration:t.duration,frequency:t.frequency,custom_name:t.custom_name,calories:t.calories}])},ze={"harris-benedict":"Harris-Benedict (1984)",schofield:"Schofield (1985)","fao-oms-2001":"FAO/OMS (2001)","fao-oms-1985":"FAO/OMS (1985)","eer-iom-2023":"EER/IOM (2023)","eer-iom-2005":"EER/IOM (2005)","eer-iom-2005-overweight":"EER/IOM (2005) Sobrepeso"},Ve=[{value:"1.2",label:"SedentÃ¡rio",description:"Pouco ou nenhum exercÃ­cio"},{value:"1.375",label:"Levemente Ativo",description:"ExercÃ­cio leve 1-3 dias/semana"},{value:"1.55",label:"Moderadamente Ativo",description:"ExercÃ­cio moderado 3-5 dias/semana"},{value:"1.725",label:"Muito Ativo",description:"ExercÃ­cio intenso 6-7 dias/semana"}],ce=r.weight&&r.height&&r.age&&r.gender,L=r.protocol.startsWith("eer-iom");return m?null:e.jsxs("div",{className:"flex flex-col min-h-screen bg-background",children:[e.jsxs("div",{className:"max-w-6xl mx-auto w-full px-4 md:px-8 py-6 md:py-8",children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>j(`/nutritionist/patients/${g}/hub`),className:"-ml-2 w-fit text-[#5f6f52] hover:text-[#5f6f52] hover:bg-[#5f6f52]/10",children:[e.jsx(Ze,{className:"w-4 h-4 mr-1"}),"Voltar"]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(de,{className:"w-6 h-6 md:w-8 md:h-8 text-[#c4661f]"}),e.jsx("span",{className:"truncate",children:"Gasto EnergÃ©tico"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 truncate",children:["Paciente: ",e.jsx("span",{className:"font-medium text-foreground",children:R})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(A,{children:[e.jsxs(S,{children:[e.jsx(M,{className:"text-lg",children:"Dados AntropomÃ©tricos"}),e.jsx(k,{children:"InformaÃ§Ãµes bÃ¡sicas para o cÃ¡lculo"})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"weight",children:"Peso (kg)"}),e.jsx(O,{id:"weight",type:"number",step:"0.1",min:"1",max:"300",value:r.weight,onChange:t=>T("weight",t.target.value),placeholder:"70.0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"height",children:"Altura (cm)"}),e.jsx(O,{id:"height",type:"number",step:"0.1",min:"50",max:"255",value:r.height,onChange:t=>T("height",t.target.value),placeholder:"170"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"age",children:"Idade (anos)"}),e.jsx(O,{id:"age",type:"number",min:"0",max:"120",value:r.age,onChange:t=>T("age",t.target.value),placeholder:"30"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"gender",children:"Sexo"}),e.jsxs(K,{value:r.gender,onValueChange:t=>T("gender",t),children:[e.jsx(Y,{id:"gender",children:e.jsx($,{placeholder:"Selecione..."})}),e.jsxs(X,{children:[e.jsx(y,{value:"Masculino",children:"Masculino"}),e.jsx(y,{value:"Feminino",children:"Feminino"})]})]})]})]})]})]}),e.jsxs(A,{children:[e.jsxs(S,{children:[e.jsx(M,{className:"text-lg",children:"Protocolo de CÃ¡lculo"}),e.jsx(k,{children:"Selecione a fÃ³rmula cientÃ­fica"})]}),e.jsx(E,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"protocol",children:"Protocolo"}),e.jsxs(K,{value:r.protocol,onValueChange:t=>T("protocol",t),children:[e.jsx(Y,{id:"protocol",children:e.jsx($,{})}),e.jsxs(X,{children:[e.jsx(y,{value:"harris-benedict",children:"Harris-Benedict (1984)"}),e.jsx(y,{value:"schofield",children:"Schofield (1985)"}),e.jsx(y,{value:"fao-oms-2001",children:"FAO/OMS (2001)"}),e.jsx(y,{value:"fao-oms-1985",children:"FAO/OMS (1985)"}),e.jsx(y,{value:"eer-iom-2023",children:"EER/IOM (2023)"}),e.jsx(y,{value:"eer-iom-2005",children:"EER/IOM (2005)"}),e.jsx(y,{value:"eer-iom-2005-overweight",children:"EER/IOM (2005) Sobrepeso"})]})]}),L&&e.jsx("p",{className:"text-xs text-amber-600",children:"* EER jÃ¡ inclui atividade fÃ­sica integrada ao cÃ¡lculo"})]})})]}),e.jsxs(A,{children:[e.jsxs(S,{children:[e.jsx(M,{className:"text-lg",children:"NÃ­vel de Atividade FÃ­sica (NAF)"}),e.jsx(k,{children:"Atividade fÃ­sica diÃ¡ria do paciente"})]}),e.jsx(E,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"activity",children:"NÃ­vel de Atividade"}),e.jsxs(K,{value:r.activity_level,onValueChange:t=>T("activity_level",t),children:[e.jsx(Y,{id:"activity",children:e.jsx($,{})}),e.jsx(X,{children:Ve.map(t=>e.jsx(y,{value:t.value,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:t.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.description})]})},t.value))})]})]})})]}),e.jsxs(A,{children:[e.jsxs(S,{children:[e.jsxs(M,{className:"text-lg flex items-center justify-between",children:["Atividades FÃ­sicas EspecÃ­ficas",e.jsxs(q,{variant:"outline",className:"text-xs",children:["+",V()," kcal/dia"]})]}),e.jsx(k,{children:"Adicione as atividades fÃ­sicas praticadas para um cÃ¡lculo mais preciso"})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs(v,{onClick:Be,variant:"outline",className:"w-full",children:[e.jsx(et,{className:"w-4 h-4 mr-2"}),"Adicionar Atividade"]}),p.length>0&&e.jsx("div",{className:"space-y-2",children:p.map((t,a)=>{const o=ee.find(s=>s.value===t.activity_type),i=t.custom_name||o?.label||t.activity_type;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm",children:i}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.duration,"min Ã— ",t.frequency,"x/semana"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(q,{className:"bg-[#5f6f52]",children:["+",t.calories," kcal/dia"]}),e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>We(t,a),children:e.jsx(tt,{className:"w-4 h-4"})}),e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>He(a),children:e.jsx(Ue,{className:"w-4 h-4 text-destructive"})})]})]},a)})}),p.length===0&&e.jsx("p",{className:"text-sm text-center text-muted-foreground py-4",children:"Nenhuma atividade adicionada"})]})]}),e.jsxs(A,{className:b?"border-amber-300":"",children:[e.jsxs(S,{children:[e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(Qe,{id:"venta-enabled",checked:b,onCheckedChange:W}),e.jsx("label",{htmlFor:"venta-enabled",className:"cursor-pointer",children:"Ajuste CalÃ³rico para Objetivo de Peso (VENTA)"})]}),e.jsx(k,{children:"Calcule as calorias ajustadas para atingir um peso objetivo"})]}),b&&e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{htmlFor:"target-weight",children:"Peso Objetivo (kg)"}),e.jsx(O,{id:"target-weight",type:"number",step:"0.1",min:"1",max:"300",value:f,onChange:t=>H(t.target.value),placeholder:"65.0"})]}),f&&r.weight&&e.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-300 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-medium text-amber-900",children:[parseFloat(r.weight)>parseFloat(f)?"ðŸ“‰ Objetivo: Perder ":"ðŸ“ˆ Objetivo: Ganhar ",Math.abs(parseFloat(r.weight)-parseFloat(f)).toFixed(1)," kg"]}),e.jsxs("p",{className:"text-xs text-amber-700 mt-1",children:["Meta de 90 dias (~",(Math.abs(parseFloat(r.weight)-parseFloat(f))/12).toFixed(1),"kg/semana)"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(v,{onClick:Re,disabled:!ce,className:"flex-1 gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"Calcular"]}),e.jsxs(v,{onClick:Pe,disabled:!h.get||l,variant:"outline",className:"gap-2",children:[l?e.jsx(st,{className:"w-4 h-4 animate-spin"}):e.jsx(at,{className:"w-4 h-4"}),"Salvar"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs(v,{onClick:()=>ae(!se),variant:"outline",size:"sm",className:"gap-1 text-xs",children:[e.jsx(me,{className:"w-3 h-3"}),"HistÃ³rico"]}),e.jsxs(v,{onClick:ke,variant:"outline",size:"sm",className:"gap-1 text-xs",disabled:!ce,children:[e.jsx(ye,{className:"w-3 h-3"}),"Comparar"]}),e.jsxs(v,{onClick:Ee,variant:"outline",size:"sm",className:"gap-1 text-xs",disabled:!h.get,children:[e.jsx(mt,{className:"w-3 h-3"}),"Imprimir"]})]})]}),se&&z.length>0&&e.jsxs(A,{className:"border-dashed",children:[e.jsxs(S,{children:[e.jsxs(M,{className:"flex items-center gap-2 text-base",children:[e.jsx(me,{className:"w-4 h-4 text-primary"}),"CÃ¡lculos Anteriores"]}),e.jsx(k,{children:"Clique em um cÃ¡lculo para carregÃ¡-lo"})]}),e.jsx(E,{children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:z.map((t,a)=>e.jsxs("div",{onClick:()=>Fe(t),className:"p-3 rounded-lg border border-border hover:bg-muted/50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:new Date(t.created_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"})}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[t.weight,"kg â€¢ ",t.height,"cm â€¢ ",re(t.protocol)]})]}),a===0&&e.jsx(q,{variant:"outline",className:"text-xs",children:"Mais recente"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[e.jsxs("div",{className:"text-xs bg-muted/30 rounded p-1.5 text-center",children:[e.jsx("div",{className:"text-muted-foreground",children:"GET"}),e.jsxs("div",{className:"font-semibold",children:[Math.round(t.get_with_activities||t.get)," kcal"]})]}),t.target_weight&&e.jsxs("div",{className:"text-xs bg-amber-50 border border-amber-200 rounded p-1.5 text-center",children:[e.jsx("div",{className:"text-amber-800",children:"Objetivo"}),e.jsxs("div",{className:"font-semibold text-amber-900",children:[t.target_weight,"kg"]})]})]})]},t.id))})})]}),z.length>1&&e.jsx(xt,{historyData:z})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs(A,{className:"sticky top-8",children:[e.jsxs(S,{children:[e.jsx(M,{className:"text-lg",children:"Resultados"}),h.get>0&&e.jsx(q,{variant:"outline",className:"w-fit",children:ze[r.protocol]})]}),e.jsx(E,{className:"space-y-4",children:h.get>0?e.jsxs(e.Fragment,{children:[!L&&e.jsxs("div",{className:"text-center p-4 bg-[#fefae0] rounded-lg border-2 border-[#c4661f]",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(de,{className:"w-5 h-5 text-[#c4661f]"}),e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"TMB"})]}),e.jsx("div",{className:"text-4xl font-bold text-[#c4661f]",children:Math.round(h.tmb)}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"kcal/dia em repouso"})]}),e.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-[#5f6f52] to-[#a9b388] rounded-lg text-white",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(he,{className:"w-5 h-5 opacity-90"}),e.jsx("span",{className:"text-sm font-medium opacity-90",children:L?"EER":"GET Base"})]}),e.jsx("div",{className:"text-4xl font-bold",children:Math.round(h.get)}),e.jsxs("div",{className:"text-xs opacity-90 mt-1",children:["kcal/dia ",!L&&"(TMB Ã— NAF)"]})]}),p.length>0&&e.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-[#4a5a42] to-[#8ea36f] rounded-lg text-white",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(he,{className:"w-5 h-5 opacity-90"}),e.jsx("span",{className:"text-sm font-medium opacity-90",children:"GET + Atividades"})]}),e.jsx("div",{className:"text-4xl font-bold",children:Math.round(h.getWithActivities)}),e.jsx("div",{className:"text-xs opacity-90 mt-1",children:"kcal/dia total"})]}),b&&h.ventaAdjusted>0&&e.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-amber-500 to-amber-600 rounded-lg text-white",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx(Z,{className:"w-5 h-5 opacity-90"}),e.jsx("span",{className:"text-sm font-medium opacity-90",children:"Objetivo Ajustado"})]}),e.jsx("div",{className:"text-4xl font-bold",children:Math.round(h.ventaAdjusted)}),e.jsxs("div",{className:"text-xs opacity-90 mt-1",children:["kcal/dia para ",f,"kg"]})]}),e.jsxs("div",{className:"p-3 bg-muted/30 rounded-lg text-xs space-y-1",children:[!L&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"TMB:"}),e.jsxs("span",{className:"font-medium",children:[Math.round(h.tmb)," kcal"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"NAF:"}),e.jsx("span",{className:"font-medium",children:r.activity_level})]}),!L&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"GET Base:"}),e.jsxs("span",{className:"font-medium",children:[Math.round(h.get)," kcal"]})]}),p.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Atividades:"}),e.jsxs("span",{className:"font-medium",children:["+",V()," kcal"]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-1 mt-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"GET Total:"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(h.getWithActivities)," kcal"]})]})]}),b&&h.ventaAdjusted>0&&e.jsxs("div",{className:"flex justify-between border-t pt-1 mt-1 text-amber-700",children:[e.jsx("span",{children:"Ajuste VENTA:"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(h.ventaAdjusted)," kcal"]})]})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:b&&h.ventaAdjusted>0?"Calorias ajustadas para atingir o peso objetivo":"Energia necessÃ¡ria para manter o peso atual"})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Z,{className:"w-12 h-12 text-muted-foreground/30 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'Preencha os dados e clique em "Calcular"'})]})})]})})]})]}),e.jsx(ht,{isOpen:U,onClose:()=>B(!1),onSave:Ge,activity:J,patientWeight:r.weight}),e.jsx(ut,{isOpen:we,onClose:()=>ie(!1),comparisons:_e})]})};export{Dt as default};
