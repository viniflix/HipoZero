import{q as pe,j as e,J as se,K as ae,M as te,N as re,B as N,ad as le,F as f,C as k,c as B,d as U,e as S,u as ue,b as fe,a as ge,r as u,s as q,R as je,m as G,G as be,E as Ne,w as ye,D as ve,x as _e,y as we,z as Q,T as Me,az as Ce,ay as De,A as ke,h as Se,i as Te,k as Pe,l as Fe,n as Ee,o as Oe,p as Ae,a3 as ze,au as Re}from"./index-DL6VMzkS.js";import{D as Le}from"./date-input-zI4YYSYu.js";import{P as W}from"./progress-DU5vUya8.js";import{t as A}from"./mealTranslations-B1KHhmEq.js";import{B as He}from"./badge-CMQ26CgR.js";import{f as K}from"./measureTranslations-AG6EuUvS.js";import{E as $e}from"./jspdf.es.min-DtjUTZMk.js";import{a as Ie}from"./jspdf.plugin.autotable-C3NxY6Hi.js";import{F as qe}from"./file-text-C4_WSc72.js";import{D as Ge}from"./download-BjhT0Wxe.js";import{C as We}from"./calendar-jIa_pVTS.js";import{U as z}from"./utensils-Dewe3o1J.js";import{p as E}from"./pt-BR-faZp8-Xc.js";import{u as Be,B as Ue,W as Ye}from"./useNotifications-BIr6aeRZ.js";import{E as Ve}from"./eye-DPN_ZxMD.js";import{C as Je}from"./chevron-left-HK0xeE4r.js";import{F as Qe}from"./flame-C4A5vNmC.js";import{D as Ke}from"./droplet-BrR4CU0Z.js";import{P as X}from"./plus-D17bPVCi.js";import{P as Xe}from"./pen-square-BTn1AN_C.js";import{p as Ze}from"./parseISO-DyXfBXdu.js";import{i as es}from"./isSameDay-CfSWIrxC.js";import{i as Z}from"./isToday-lRkwsb-M.js";import{i as ss}from"./isYesterday-B0bUleEb.js";import{i as as}from"./isTomorrow-PwBINsYU.js";import"./input-CMIeflfg.js";import"./calendar-BOiwl0x6.js";import"./endOfMonth-fINJXo8H.js";import"./addMonths-Dpdm5UWc.js";import"./popover-D1PQqJd4.js";import"./extends-CF3RwP-h.js";import"./constructNow-BKPZXC7W.js";const ee=pe("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);function ts({open:y,onOpenChange:R,mealPlan:h,patientName:g}){if(!h)return null;const D=["breakfast","morning_snack","lunch","afternoon_snack","dinner","supper"],j=[...h.meal_plan_meals||[]].sort((s,p)=>D.indexOf(s.meal_type)-D.indexOf(p.meal_type)),v=j.reduce((s,p)=>{const o=(p.meal_plan_foods||[]).reduce((r,i)=>({calories:r.calories+(i.calories||0),protein:r.protein+(i.protein||0),carbs:r.carbs+(i.carbs||0),fat:r.fat+(i.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});return{calories:s.calories+o.calories,protein:s.protein+o.protein,carbs:s.carbs+o.carbs,fat:s.fat+o.fat}},{calories:0,protein:0,carbs:0,fat:0}),T=async()=>{const s=new $e,p=s.internal.pageSize.width,_=s.internal.pageSize.height,o=[70,125,70],r=[68,64,60],i=[120,113,108],P=[245,245,244];let l=20;s.setFont("helvetica");try{const C=await(await fetch("https://afyoidxrshkmplxhcyeh.supabase.co/storage/v1/object/public/IDV/HIPOZERO%20(2).png")).blob();await new Promise(F=>{const w=new Image;w.onload=()=>{const x=p*.2,O=w.height/w.width*x,m=new FileReader;m.onloadend=()=>{const V=m.result;s.addImage(V,"PNG",14,10,x,O),F()},m.readAsDataURL(C)},w.src=URL.createObjectURL(C)})}catch(d){console.error("Erro ao carregar logo:",d)}s.setFontSize(20),s.setTextColor(...o),s.setFont("helvetica","bold"),s.text("Plano Alimentar",p/2,20,{align:"center"}),s.setDrawColor(...o),s.setLineWidth(.5),s.line(14,24,p-14,24),l=32,s.setFont("helvetica","normal"),s.setFontSize(10),s.setTextColor(...r),g&&(s.text(`Paciente: ${g}`,14,l),l+=5);const L=f(new Date(h.start_date),"dd 'de' MMMM 'de' yyyy",{locale:E}),Y=h.end_date?f(new Date(h.end_date),"dd 'de' MMMM 'de' yyyy",{locale:E}):"Indeterminado";s.text(`Período: ${L} até ${Y}`,14,l),l+=5,s.text(`Gerado em: ${f(new Date,"dd/MM/yyyy 'às' HH:mm")}`,14,l),l+=10,s.setFillColor(...P),s.roundedRect(14,l,p-28,20,2,2,"F"),s.setFontSize(9),s.setTextColor(...r),s.setFont("helvetica","bold"),s.text("Meta Diária Total:",18,l+6),s.setFont("helvetica","normal"),s.setTextColor(...i);const H=`${Math.round(v.calories)} kcal  •  Proteínas: ${Math.round(v.protein)}g  •  Carboidratos: ${Math.round(v.carbs)}g  •  Gorduras: ${Math.round(v.fat)}g`;s.text(H,18,l+13),l+=28;for(let d=0;d<j.length;d++){const M=j[d],C=M.meal_plan_foods||[],F=15+(C.length+1)*7+(M.notes?10:0);l+F>_-30&&(s.addPage(),l=20),s.setFontSize(12),s.setTextColor(...o),s.setFont("helvetica","bold");const w=A(M.meal_type),x=M.meal_time||"";if(s.text(`${w}${x?` • ${x}`:""}`,14,l),l+=7,C.length>0){const O=C.map(m=>[m.foods?.name||"Alimento",K(m.quantity||0,m.unit||"",m.measure),Math.round(m.calories||0),Math.round(m.protein||0),Math.round(m.carbs||0),Math.round(m.fat||0)]);Ie(s,{startY:l,head:[["Alimento","Quantidade","Calorias","Proteína","Carboidrato","Gordura"]],body:O,theme:"striped",headStyles:{fillColor:o,textColor:[255,255,255],fontSize:9,fontStyle:"bold",halign:"center",font:"helvetica"},bodyStyles:{fontSize:8,textColor:r,font:"helvetica"},columnStyles:{0:{halign:"left",cellWidth:"auto"},1:{halign:"center",cellWidth:30},2:{halign:"center",cellWidth:23},3:{halign:"center",cellWidth:23},4:{halign:"center",cellWidth:28},5:{halign:"center",cellWidth:23}},alternateRowStyles:{fillColor:P},margin:{left:14,right:14}}),l=s.lastAutoTable.finalY+3}M.notes&&(s.setFontSize(8),s.setTextColor(...i),s.setFont("helvetica","italic"),s.text(`Obs: ${M.notes}`,14,l),l+=6),d<j.length-1&&(l+=5)}const $=s.internal.getNumberOfPages();for(let d=1;d<=$;d++)s.setPage(d),s.setFontSize(8),s.setTextColor(...i),s.setFont("helvetica","normal"),s.text(`Página ${d} de ${$}`,p-14,_-10,{align:"right"});const c=`plano-alimentar-${g?.replace(/\s+/g,"-").toLowerCase()||"paciente"}-${f(new Date,"dd-MM-yyyy")}.pdf`;s.save(c)};return e.jsx(se,{open:y,onOpenChange:R,children:e.jsxs(ae,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(te,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-6 h-6 text-primary"}),e.jsx(re,{className:"text-2xl",children:"Meu Plano Alimentar"})]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:T,className:"gap-2",children:[e.jsx(Ge,{className:"w-4 h-4"}),"Baixar PDF"]})]}),e.jsxs(le,{className:"flex items-center gap-2 pt-2",children:[e.jsx(We,{className:"w-4 h-4"}),e.jsxs("span",{children:["Período: ",f(new Date(h.start_date),"dd 'de' MMMM",{locale:E})," até ",h.end_date?f(new Date(h.end_date),"dd 'de' MMMM 'de' yyyy",{locale:E}):"indeterminado"]})]})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs(k,{className:"bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20",children:[e.jsx(B,{className:"pb-3",children:e.jsx(U,{className:"text-base text-primary",children:"Meta Diária Total"})}),e.jsx(S,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:Math.round(v.calories)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Calorias"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Math.round(v.protein),"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Proteínas"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Math.round(v.carbs),"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Carboidratos"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Math.round(v.fat),"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gorduras"})]})]})})]}),e.jsx("div",{className:"space-y-4",children:j.length>0?j.map((s,p)=>{const _=s.meal_plan_foods||[],o=_.reduce((r,i)=>({calories:r.calories+(i.calories||0),protein:r.protein+(i.protein||0),carbs:r.carbs+(i.carbs||0),fat:r.fat+(i.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});return e.jsxs(k,{className:"border-l-4 border-l-primary",children:[e.jsxs(B,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-primary"}),e.jsx(U,{className:"text-lg",children:A(s.meal_type)}),s.meal_time&&e.jsx(He,{variant:"outline",className:"text-xs",children:s.meal_time})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm font-bold text-primary",children:[Math.round(o.calories)," kcal"]})})]}),s.name&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.name})]}),e.jsx(S,{children:_.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"text-left p-2 font-semibold",children:"Alimento"}),e.jsx("th",{className:"text-right p-2 font-semibold",children:"Quantidade"}),e.jsx("th",{className:"text-right p-2 font-semibold",children:"Calorias"}),e.jsx("th",{className:"text-right p-2 font-semibold hidden md:table-cell",children:"Prot."}),e.jsx("th",{className:"text-right p-2 font-semibold hidden md:table-cell",children:"Carb."}),e.jsx("th",{className:"text-right p-2 font-semibold hidden md:table-cell",children:"Gord."})]})}),e.jsx("tbody",{children:_.map((r,i)=>e.jsxs("tr",{className:"border-b last:border-0 hover:bg-muted/30",children:[e.jsx("td",{className:"p-2",children:r.foods?.name||"Alimento"}),e.jsx("td",{className:"p-2 text-right whitespace-nowrap",children:K(r.quantity||0,r.unit||"",r.measure)}),e.jsxs("td",{className:"p-2 text-right font-medium whitespace-nowrap",children:[Math.round(r.calories||0)," kcal"]}),e.jsxs("td",{className:"p-2 text-right text-muted-foreground hidden md:table-cell",children:[Math.round(r.protein||0),"g"]}),e.jsxs("td",{className:"p-2 text-right text-muted-foreground hidden md:table-cell",children:[Math.round(r.carbs||0),"g"]}),e.jsxs("td",{className:"p-2 text-right text-muted-foreground hidden md:table-cell",children:[Math.round(r.fat||0),"g"]})]},i))})]})}),e.jsxs("div",{className:"md:hidden mt-3 p-2 bg-muted/30 rounded text-xs",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Totais desta refeição:"}),e.jsxs("p",{className:"text-muted-foreground",children:["P: ",Math.round(o.protein),"g | C: ",Math.round(o.carbs),"g | G: ",Math.round(o.fat),"g"]})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum alimento cadastrado nesta refeição"})})]},p)}):e.jsx(k,{children:e.jsxs(S,{className:"py-8 text-center",children:[e.jsx(z,{className:"w-12 h-12 text-muted-foreground/50 mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:"Nenhuma refeição cadastrada neste plano"})]})})})]})]})})}function zs(){const{user:y}=ue(),R=fe(),{toast:h}=ge(),[g,D]=u.useState(new Date),[j,v]=u.useState([]),[T,s]=u.useState(null),[p,_]=u.useState(!0),[o,r]=u.useState(!1),[i,P]=u.useState(null),[l,L]=u.useState(!1),[Y,H]=u.useState(!1),{unreadCount:$}=Be(),[c,d]=u.useState(null),M=[{key:"breakfast",label:"Café da Manhã"},{key:"morning_snack",label:"Lanche da Manhã"},{key:"lunch",label:"Almoço"},{key:"afternoon_snack",label:"Lanche da Tarde"},{key:"dinner",label:"Jantar"},{key:"supper",label:"Ceia"}],C=T?.meal_plan_meals?.map(a=>a.meal_type)||[],F=u.useCallback(async()=>{if(!y)return;const a=f(new Date,"yyyy-MM-dd"),{data:t}=await q.from("meal_plans").select(`
        *,
        meal_plan_meals (
          *,
          meal_plan_foods (
            *,
            foods (id, name)
          )
        )
      `).eq("patient_id",y.id).eq("is_active",!0).lte("start_date",a).or(`end_date.is.null,end_date.gte.${a}`).maybeSingle();s(t),t&&t.daily_calories>0?d({calories:t.daily_calories||0,protein:t.daily_protein||0,carbs:t.daily_carbs||0,fat:t.daily_fat||0}):d({calories:2e3,protein:0,carbs:0,fat:0})},[y]),w=u.useCallback(async()=>{if(!y)return;_(!0);const a=f(g,"yyyy-MM-dd"),{data:t,error:n}=await q.from("meals").select(`
        *,
        meal_items (
          *,
          foods (
            id,
            name
          )
        )
      `).eq("patient_id",y.id).eq("meal_date",a).is("deleted_at",null).order("created_at",{ascending:!0});n?(console.error("Erro ao carregar refeições:",n),h({title:"Erro",description:"Não foi possível carregar as refeições.",variant:"destructive"})):v(t||[]),_(!1)},[y,g,h]);u.useEffect(()=>{F()},[F]),u.useEffect(()=>{w()},[w]);const x=j.reduce((a,t)=>({calories:a.calories+(t.total_calories||0),protein:a.protein+(t.total_protein||0),carbs:a.carbs+(t.total_carbs||0),fat:a.fat+(t.total_fat||0)}),{calories:0,protein:0,carbs:0,fat:0}),O=[...new Set(j.map(a=>a.meal_type))],m=[...new Set([...C,...O])],V=m.reduce((a,t)=>(a[t]=j.filter(n=>n.meal_type===t),a),{}),ie=()=>{D(a=>ze(a,1))},ne=()=>{D(a=>Re(a,1))},oe=()=>{D(new Date)},ce=a=>Z(a)?"HOJE":ss(a)?"ONTEM":as(a)?"AMANHÃ":f(a,"dd 'de' MMMM",{locale:E}),de=a=>f(a,"EEEE, dd 'de' MMMM 'de' yyyy",{locale:E}),me=async()=>{if(!i)return;const a=j.find(n=>n.id===i),{error:t}=await q.from("meals").update({deleted_at:new Date().toISOString()}).eq("id",i);t?h({title:"Erro",description:"Não foi possível excluir a refeição.",variant:"destructive"}):(a&&await q.rpc("log_meal_action",{p_patient_id:y.id,p_meal_id:i,p_action:"delete",p_meal_type:a.meal_type,p_meal_date:a.meal_date,p_meal_time:a.meal_time,p_details:{total_calories:a.total_calories,total_protein:a.total_protein,total_carbs:a.total_carbs,total_fat:a.total_fat,items:(a.meal_items||[]).map(n=>({food_id:n.food_id,name:n.name,quantity:n.quantity,unit:n.unit,calories:n.calories,protein:n.protein,carbs:n.carbs,fat:n.fat})),deleted_at:new Date().toISOString()}}),h({title:"Sucesso",description:"Refeição excluída com sucesso."}),w()),P(null)},I=a=>{const t=T?.meal_plan_meals?.find(n=>n.meal_type===a);R("/patient/add-meal",{state:{mealType:a,mealTime:t?.meal_time||f(new Date,"HH:mm"),mealName:t?.name||"",recommendedFoods:t?.meal_plan_foods||[]}}),r(!1)};return e.jsxs("div",{className:"flex flex-col min-h-screen bg-background",children:[e.jsxs("div",{className:"max-w-7xl mx-auto w-full px-4 md:px-8 py-8 space-y-6",children:[e.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Plano Alimentar"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Registre suas refeições do dia"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[T&&e.jsxs(N,{variant:"ghost",size:"sm",onClick:()=>L(!0),className:"text-muted-foreground hover:text-foreground",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Ver Plano"})]}),e.jsxs(N,{variant:"ghost",size:"icon",onClick:()=>H(!0),className:"relative",children:[e.jsx(je,{className:"w-6 h-6 text-gray-700"}),$>0&&e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]})]})]}),e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(k,{className:"border-0 shadow-sm",children:e.jsxs(S,{className:"pt-6 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx(N,{variant:"ghost",size:"icon",onClick:ie,className:"flex-shrink-0",children:e.jsx(Je,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1 text-center",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-primary",children:ce(g)}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize mt-1",children:de(g)})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Le,{value:f(g,"yyyy-MM-dd"),onChange:a=>{const t=Ze(a);be(t)&&D(t)},className:"max-w-[170px]"})})]})}),e.jsx(N,{variant:"ghost",size:"icon",onClick:ne,className:"flex-shrink-0",disabled:es(g,new Date),children:e.jsx(Ne,{className:"h-5 w-5"})})]}),!Z(g)&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx(N,{variant:"ghost",size:"sm",onClick:oe,className:"text-primary hover:text-primary/80",children:"Ir para Hoje"})})]})})}),c&&e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(k,{className:"border-[#5f6f52]/20 shadow-sm",children:[e.jsxs(B,{className:"pb-4",children:[e.jsx(U,{className:"text-lg text-[#5f6f52]",children:"Progresso do Dia"}),e.jsx(ye,{children:"Consumido vs Meta"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Calorias"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(x.calories)," / ",Math.round(c.calories)," kcal"]})]}),e.jsx(W,{value:c.calories>0?Math.min(x.calories/c.calories*100,100):0,className:"h-3",indicatorClassName:"bg-gradient-to-r from-orange-500 to-red-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4 text-sky-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Proteínas"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(x.protein)," / ",Math.round(c.protein),"g"]})]}),e.jsx(W,{value:c.protein>0?Math.min(x.protein/c.protein*100,100):0,className:"h-3",indicatorClassName:"bg-sky-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Carboidratos"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(x.carbs)," / ",Math.round(c.carbs),"g"]})]}),e.jsx(W,{value:c.carbs>0?Math.min(x.carbs/c.carbs*100,100):0,className:"h-3",indicatorClassName:"bg-amber-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Gorduras"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(x.fat)," / ",Math.round(c.fat),"g"]})]}),e.jsx(W,{value:c.fat>0?Math.min(x.fat/c.fat*100,100):0,className:"h-3",indicatorClassName:"bg-yellow-500"})]})]})]})}),e.jsx("div",{className:"space-y-4",children:m.map((a,t)=>{const n=V[a]||[],xe=n.length>0;return e.jsx(G.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+t*.05},children:xe?e.jsxs(k,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(B,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-[#5f6f52]"}),e.jsx(U,{className:"text-base",children:A(a)})]}),e.jsxs(N,{size:"sm",variant:"outline",onClick:()=>I(a),className:"border-[#5f6f52]/30 text-[#5f6f52] hover:bg-[#5f6f52]/10",children:[e.jsx(X,{className:"w-4 h-4 mr-1"}),"Adicionar mais"]})]})}),e.jsx(S,{children:e.jsx("div",{className:"space-y-3",children:n.map(b=>e.jsxs(G.div,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"border rounded-lg p-4 bg-background hover:bg-muted/30 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("h4",{className:"text-sm font-semibold text-foreground",children:A(a)})}),e.jsxs("p",{className:"text-lg font-bold text-[#5f6f52]",children:[b.total_calories?.toFixed(0)," kcal"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["P: ",b.total_protein?.toFixed(1),"g • C: ",b.total_carbs?.toFixed(1),"g • G: ",b.total_fat?.toFixed(1),"g"]})]}),e.jsxs(ve,{children:[e.jsx(_e,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ee,{className:"w-4 h-4"})})}),e.jsxs(we,{align:"end",children:[e.jsxs(Q,{onClick:()=>R("/patient/add-meal",{state:{editMode:!0,mealId:b.id}}),children:[e.jsx(Xe,{className:"w-4 h-4 mr-2"}),"Editar"]}),e.jsxs(Q,{onClick:()=>P(b.id),className:"text-destructive focus:text-destructive",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"Excluir"]})]})]})]}),b.meal_items?.length>0&&e.jsx("div",{className:"space-y-2 mt-3 pt-3 border-t",children:b.meal_items.map((J,he)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-foreground",children:J.foods?.name||"Alimento desconhecido"}),e.jsxs("span",{className:"font-medium text-muted-foreground",children:[J.quantity," ",J.measure]})]},he))})]},b.id))})})]}):e.jsx(k,{className:"border-2 border-dashed border-muted-foreground/30 bg-muted/20 hover:bg-muted/30 hover:border-primary/40 transition-all cursor-pointer",onClick:()=>I(a),children:e.jsx(S,{className:"py-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:e.jsx(z,{className:"w-6 h-6 text-primary/60"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-base font-semibold text-muted-foreground",children:["Registrar ",A(a)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Clique para adicionar alimentos"})]}),e.jsxs(N,{size:"sm",className:"mt-2 bg-primary hover:bg-primary/90",onClick:b=>{b.stopPropagation(),I(a)},children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Adicionar"]})]})})})},a)})}),e.jsxs(se,{open:o,onOpenChange:r,children:[e.jsx(Ce,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:"w-full",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Registrar Outra Refeição"]})}),e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsx(re,{children:"Escolha o Tipo de Refeição"}),e.jsx(le,{children:"Selecione qual refeição deseja registrar"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 py-4",children:M.map(a=>e.jsxs(N,{variant:"outline",className:"justify-start",onClick:()=>I(a.key),children:[e.jsx(z,{className:"w-4 h-4 mr-2"}),a.label]},a.key))})]})]})]}),e.jsx(ts,{open:l,onOpenChange:L,mealPlan:T,patientName:y?.profile?.name}),e.jsx(De,{isOpen:Y,setIsOpen:H}),e.jsx(ke,{open:!!i,onOpenChange:()=>P(null),children:e.jsxs(Se,{children:[e.jsxs(Te,{children:[e.jsx(Pe,{children:"Excluir Refeição"}),e.jsx(Fe,{children:"Deseja realmente excluir esta refeição? Esta ação não pode ser desfeita."})]}),e.jsxs(Ee,{children:[e.jsx(Oe,{children:"Cancelar"}),e.jsx(Ae,{onClick:me,className:"bg-destructive hover:bg-destructive/90",children:"Excluir"})]})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})]})}export{zs as default};
