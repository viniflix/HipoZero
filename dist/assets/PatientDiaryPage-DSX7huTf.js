import{q as pe,j as e,ai as se,aj as ae,ak as te,I as ue,al as re,B as b,au as le,v as fe,O as N,H as k,C as P,c as B,d as U,e as S,E as A,u as ge,b as je,a as be,r as u,s as q,P as Ne,m as G,M as ye,w as ve,D as _e,x as we,y as Me,z as J,F as Ce,aM as De,Q as ke,A as Pe,h as Se,i as Te,k as Fe,l as Ee,n as Oe,o as Ae,p as ze,ap as Re,a7 as He}from"./index-BFkiRED3.js";import{C as Le}from"./calendar-DkuGnFKl.js";import{P as $e,a as Ie,b as qe}from"./popover-BBHYC_MP.js";import{P as W}from"./progress-zepUIh9f.js";import{t as z}from"./mealTranslations-B1KHhmEq.js";import{B as Ge}from"./badge-CtpHqUcx.js";import{f as X}from"./measureTranslations-AG6EuUvS.js";import{E as We,a as Be}from"./jspdf.plugin.autotable-CUT3NQ2x.js";import{D as Ue}from"./download-CvdH1k7l.js";import{u as Ye,B as Qe,W as Ve}from"./useNotifications-Cg1iBhzO.js";import{E as Je}from"./eye-DGsmBFOo.js";import{C as Xe}from"./chevron-left-qdon1vtW.js";import{F as Ze}from"./flame-B2D13F6d.js";import{D as Ke}from"./droplet-DZJnyUxB.js";import{P as Z}from"./plus-BYtwMioY.js";import{P as es}from"./pen-square-B-aU106W.js";import{i as ss}from"./isSameDay-DAXjByJv.js";import{i as K}from"./isToday-Dw1Q_Wh6.js";import{i as as}from"./isYesterday-BMSk4shC.js";import{i as ts}from"./isTomorrow-BO4vY-vw.js";import"./startOfMonth-cmkoOtFb.js";import"./addMonths-s36yr4Dj.js";import"./extends-CF3RwP-h.js";const ee=pe("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);function rs({open:y,onOpenChange:R,mealPlan:h,patientName:f}){if(!h)return null;const D=["breakfast","morning_snack","lunch","afternoon_snack","dinner","supper"],g=[...h.meal_plan_meals||[]].sort((s,p)=>D.indexOf(s.meal_type)-D.indexOf(p.meal_type)),v=g.reduce((s,p)=>{const o=(p.meal_plan_foods||[]).reduce((t,i)=>({calories:t.calories+(i.calories||0),protein:t.protein+(i.protein||0),carbs:t.carbs+(i.carbs||0),fat:t.fat+(i.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});return{calories:s.calories+o.calories,protein:s.protein+o.protein,carbs:s.carbs+o.carbs,fat:s.fat+o.fat}},{calories:0,protein:0,carbs:0,fat:0}),T=async()=>{const s=new We,p=s.internal.pageSize.width,_=s.internal.pageSize.height,o=[70,125,70],t=[68,64,60],i=[120,113,108],F=[245,245,244];let l=20;s.setFont("helvetica");try{const C=await(await fetch("https://afyoidxrshkmplxhcyeh.supabase.co/storage/v1/object/public/IDV/HIPOZERO%20(2).png")).blob();await new Promise(E=>{const w=new Image;w.onload=()=>{const x=p*.2,O=w.height/w.width*x,m=new FileReader;m.onloadend=()=>{const Q=m.result;s.addImage(Q,"PNG",14,10,x,O),E()},m.readAsDataURL(C)},w.src=URL.createObjectURL(C)})}catch(d){console.error("Erro ao carregar logo:",d)}s.setFontSize(20),s.setTextColor(...o),s.setFont("helvetica","bold"),s.text("Plano Alimentar",p/2,20,{align:"center"}),s.setDrawColor(...o),s.setLineWidth(.5),s.line(14,24,p-14,24),l=32,s.setFont("helvetica","normal"),s.setFontSize(10),s.setTextColor(...t),f&&(s.text(`Paciente: ${f}`,14,l),l+=5);const H=N(new Date(h.start_date),"dd 'de' MMMM 'de' yyyy",{locale:k}),Y=h.end_date?N(new Date(h.end_date),"dd 'de' MMMM 'de' yyyy",{locale:k}):"Indeterminado";s.text(`Período: ${H} até ${Y}`,14,l),l+=5,s.text(`Gerado em: ${N(new Date,"dd/MM/yyyy 'às' HH:mm")}`,14,l),l+=10,s.setFillColor(...F),s.roundedRect(14,l,p-28,20,2,2,"F"),s.setFontSize(9),s.setTextColor(...t),s.setFont("helvetica","bold"),s.text("Meta Diária Total:",18,l+6),s.setFont("helvetica","normal"),s.setTextColor(...i);const L=`${Math.round(v.calories)} kcal  •  Proteínas: ${Math.round(v.protein)}g  •  Carboidratos: ${Math.round(v.carbs)}g  •  Gorduras: ${Math.round(v.fat)}g`;s.text(L,18,l+13),l+=28;for(let d=0;d<g.length;d++){const M=g[d],C=M.meal_plan_foods||[],E=15+(C.length+1)*7+(M.notes?10:0);l+E>_-30&&(s.addPage(),l=20),s.setFontSize(12),s.setTextColor(...o),s.setFont("helvetica","bold");const w=z(M.meal_type),x=M.meal_time||"";if(s.text(`${w}${x?` • ${x}`:""}`,14,l),l+=7,C.length>0){const O=C.map(m=>[m.foods?.name||"Alimento",X(m.quantity||0,m.unit||"",m.measure),Math.round(m.calories||0),Math.round(m.protein||0),Math.round(m.carbs||0),Math.round(m.fat||0)]);Be(s,{startY:l,head:[["Alimento","Quantidade","Calorias","Proteína","Carboidrato","Gordura"]],body:O,theme:"striped",headStyles:{fillColor:o,textColor:[255,255,255],fontSize:9,fontStyle:"bold",halign:"center",font:"helvetica"},bodyStyles:{fontSize:8,textColor:t,font:"helvetica"},columnStyles:{0:{halign:"left",cellWidth:"auto"},1:{halign:"center",cellWidth:30},2:{halign:"center",cellWidth:23},3:{halign:"center",cellWidth:23},4:{halign:"center",cellWidth:28},5:{halign:"center",cellWidth:23}},alternateRowStyles:{fillColor:F},margin:{left:14,right:14}}),l=s.lastAutoTable.finalY+3}M.notes&&(s.setFontSize(8),s.setTextColor(...i),s.setFont("helvetica","italic"),s.text(`Obs: ${M.notes}`,14,l),l+=6),d<g.length-1&&(l+=5)}const $=s.internal.getNumberOfPages();for(let d=1;d<=$;d++)s.setPage(d),s.setFontSize(8),s.setTextColor(...i),s.setFont("helvetica","normal"),s.text(`Página ${d} de ${$}`,p-14,_-10,{align:"right"});const c=`plano-alimentar-${f?.replace(/\s+/g,"-").toLowerCase()||"paciente"}-${N(new Date,"dd-MM-yyyy")}.pdf`;s.save(c)};return e.jsx(se,{open:y,onOpenChange:R,children:e.jsxs(ae,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(te,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-6 h-6 text-primary"}),e.jsx(re,{className:"text-2xl",children:"Meu Plano Alimentar"})]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:T,className:"gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Baixar PDF"]})]}),e.jsxs(le,{className:"flex items-center gap-2 pt-2",children:[e.jsx(fe,{className:"w-4 h-4"}),e.jsxs("span",{children:["Período: ",N(new Date(h.start_date),"dd 'de' MMMM",{locale:k})," até ",h.end_date?N(new Date(h.end_date),"dd 'de' MMMM 'de' yyyy",{locale:k}):"indeterminado"]})]})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs(P,{className:"bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20",children:[e.jsx(B,{className:"pb-3",children:e.jsx(U,{className:"text-base text-primary",children:"Meta Diária Total"})}),e.jsx(S,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-primary",children:Math.round(v.calories)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Calorias"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Math.round(v.protein),"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Proteínas"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Math.round(v.carbs),"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Carboidratos"})]}),e.jsxs("div",{className:"text-center p-3 bg-white/80 rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Math.round(v.fat),"g"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Gorduras"})]})]})})]}),e.jsx("div",{className:"space-y-4",children:g.length>0?g.map((s,p)=>{const _=s.meal_plan_foods||[],o=_.reduce((t,i)=>({calories:t.calories+(i.calories||0),protein:t.protein+(i.protein||0),carbs:t.carbs+(i.carbs||0),fat:t.fat+(i.fat||0)}),{calories:0,protein:0,carbs:0,fat:0});return e.jsxs(P,{className:"border-l-4 border-l-primary",children:[e.jsxs(B,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-primary"}),e.jsx(U,{className:"text-lg",children:z(s.meal_type)}),s.meal_time&&e.jsx(Ge,{variant:"outline",className:"text-xs",children:s.meal_time})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm font-bold text-primary",children:[Math.round(o.calories)," kcal"]})})]}),s.name&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.name})]}),e.jsx(S,{children:_.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"text-left p-2 font-semibold",children:"Alimento"}),e.jsx("th",{className:"text-right p-2 font-semibold",children:"Quantidade"}),e.jsx("th",{className:"text-right p-2 font-semibold",children:"Calorias"}),e.jsx("th",{className:"text-right p-2 font-semibold hidden md:table-cell",children:"Prot."}),e.jsx("th",{className:"text-right p-2 font-semibold hidden md:table-cell",children:"Carb."}),e.jsx("th",{className:"text-right p-2 font-semibold hidden md:table-cell",children:"Gord."})]})}),e.jsx("tbody",{children:_.map((t,i)=>e.jsxs("tr",{className:"border-b last:border-0 hover:bg-muted/30",children:[e.jsx("td",{className:"p-2",children:t.foods?.name||"Alimento"}),e.jsx("td",{className:"p-2 text-right whitespace-nowrap",children:X(t.quantity||0,t.unit||"",t.measure)}),e.jsxs("td",{className:"p-2 text-right font-medium whitespace-nowrap",children:[Math.round(t.calories||0)," kcal"]}),e.jsxs("td",{className:"p-2 text-right text-muted-foreground hidden md:table-cell",children:[Math.round(t.protein||0),"g"]}),e.jsxs("td",{className:"p-2 text-right text-muted-foreground hidden md:table-cell",children:[Math.round(t.carbs||0),"g"]}),e.jsxs("td",{className:"p-2 text-right text-muted-foreground hidden md:table-cell",children:[Math.round(t.fat||0),"g"]})]},i))})]})}),e.jsxs("div",{className:"md:hidden mt-3 p-2 bg-muted/30 rounded text-xs",children:[e.jsx("p",{className:"font-semibold mb-1",children:"Totais desta refeição:"}),e.jsxs("p",{className:"text-muted-foreground",children:["P: ",Math.round(o.protein),"g | C: ",Math.round(o.carbs),"g | G: ",Math.round(o.fat),"g"]})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Nenhum alimento cadastrado nesta refeição"})})]},p)}):e.jsx(P,{children:e.jsxs(S,{className:"py-8 text-center",children:[e.jsx(A,{className:"w-12 h-12 text-muted-foreground/50 mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:"Nenhuma refeição cadastrada neste plano"})]})})})]})]})})}function ks(){const{user:y}=ge(),R=je(),{toast:h}=be(),[f,D]=u.useState(new Date),[g,v]=u.useState([]),[T,s]=u.useState(null),[p,_]=u.useState(!0),[o,t]=u.useState(!1),[i,F]=u.useState(null),[l,H]=u.useState(!1),[Y,L]=u.useState(!1),{unreadCount:$}=Ye(),[c,d]=u.useState(null),M=[{key:"breakfast",label:"Café da Manhã"},{key:"morning_snack",label:"Lanche da Manhã"},{key:"lunch",label:"Almoço"},{key:"afternoon_snack",label:"Lanche da Tarde"},{key:"dinner",label:"Jantar"},{key:"supper",label:"Ceia"}],C=T?.meal_plan_meals?.map(a=>a.meal_type)||[],E=u.useCallback(async()=>{if(!y)return;const a=N(new Date,"yyyy-MM-dd"),{data:r}=await q.from("meal_plans").select(`
        *,
        meal_plan_meals (
          *,
          meal_plan_foods (
            *,
            foods (id, name)
          )
        )
      `).eq("patient_id",y.id).eq("is_active",!0).lte("start_date",a).or(`end_date.is.null,end_date.gte.${a}`).maybeSingle();s(r),r&&r.daily_calories>0?d({calories:r.daily_calories||0,protein:r.daily_protein||0,carbs:r.daily_carbs||0,fat:r.daily_fat||0}):d({calories:2e3,protein:0,carbs:0,fat:0})},[y]),w=u.useCallback(async()=>{if(!y)return;_(!0);const a=N(f,"yyyy-MM-dd"),{data:r,error:n}=await q.from("meals").select(`
        *,
        meal_items (
          *,
          foods (
            id,
            name
          )
        )
      `).eq("patient_id",y.id).eq("meal_date",a).is("deleted_at",null).order("created_at",{ascending:!0});n?(console.error("Erro ao carregar refeições:",n),h({title:"Erro",description:"Não foi possível carregar as refeições.",variant:"destructive"})):v(r||[]),_(!1)},[y,f,h]);u.useEffect(()=>{E()},[E]),u.useEffect(()=>{w()},[w]);const x=g.reduce((a,r)=>({calories:a.calories+(r.total_calories||0),protein:a.protein+(r.total_protein||0),carbs:a.carbs+(r.total_carbs||0),fat:a.fat+(r.total_fat||0)}),{calories:0,protein:0,carbs:0,fat:0}),O=[...new Set(g.map(a=>a.meal_type))],m=[...new Set([...C,...O])],Q=m.reduce((a,r)=>(a[r]=g.filter(n=>n.meal_type===r),a),{}),ie=()=>{D(a=>Re(a,1))},ne=()=>{D(a=>He(a,1))},oe=()=>{D(new Date)},ce=a=>K(a)?"HOJE":as(a)?"ONTEM":ts(a)?"AMANHÃ":N(a,"dd 'de' MMMM",{locale:k}),de=a=>N(a,"EEEE, dd 'de' MMMM 'de' yyyy",{locale:k}),me=async()=>{if(!i)return;const a=g.find(n=>n.id===i),{error:r}=await q.from("meals").update({deleted_at:new Date().toISOString()}).eq("id",i);r?h({title:"Erro",description:"Não foi possível excluir a refeição.",variant:"destructive"}):(a&&await q.rpc("log_meal_action",{p_patient_id:y.id,p_meal_id:i,p_action:"delete",p_meal_type:a.meal_type,p_meal_date:a.meal_date,p_meal_time:a.meal_time,p_details:{total_calories:a.total_calories,total_protein:a.total_protein,total_carbs:a.total_carbs,total_fat:a.total_fat,items:(a.meal_items||[]).map(n=>({food_id:n.food_id,name:n.name,quantity:n.quantity,unit:n.unit,calories:n.calories,protein:n.protein,carbs:n.carbs,fat:n.fat})),deleted_at:new Date().toISOString()}}),h({title:"Sucesso",description:"Refeição excluída com sucesso."}),w()),F(null)},I=a=>{const r=T?.meal_plan_meals?.find(n=>n.meal_type===a);R("/patient/add-meal",{state:{mealType:a,mealTime:r?.meal_time||N(new Date,"HH:mm"),mealName:r?.name||"",recommendedFoods:r?.meal_plan_foods||[]}}),t(!1)};return e.jsxs("div",{className:"flex flex-col min-h-screen bg-background",children:[e.jsxs("div",{className:"max-w-7xl mx-auto w-full px-4 md:px-8 py-8 space-y-6",children:[e.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Plano Alimentar"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Registre suas refeições do dia"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[T&&e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>H(!0),className:"text-muted-foreground hover:text-foreground",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Ver Plano"})]}),e.jsxs(b,{variant:"ghost",size:"icon",onClick:()=>L(!0),className:"relative",children:[e.jsx(Ne,{className:"w-6 h-6 text-gray-700"}),$>0&&e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]})]})]}),e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:e.jsx(P,{className:"border-0 shadow-sm",children:e.jsxs(S,{className:"pt-6 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:ie,className:"flex-shrink-0",children:e.jsx(Xe,{className:"h-5 w-5"})}),e.jsx("div",{className:"flex-1 text-center",children:e.jsxs($e,{children:[e.jsx(Ie,{asChild:!0,children:e.jsxs("button",{className:"hover:opacity-80 transition-opacity",children:[e.jsx("h2",{className:"text-2xl font-bold text-primary",children:ce(f)}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize mt-1",children:de(f)})]})}),e.jsx(qe,{className:"w-auto p-0",align:"center",children:e.jsx(Le,{mode:"single",selected:f,onSelect:a=>a&&D(a),initialFocus:!0,locale:k})})]})}),e.jsx(b,{variant:"ghost",size:"icon",onClick:ne,className:"flex-shrink-0",disabled:ss(f,new Date),children:e.jsx(ye,{className:"h-5 w-5"})})]}),!K(f)&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx(b,{variant:"ghost",size:"sm",onClick:oe,className:"text-primary hover:text-primary/80",children:"Ir para Hoje"})})]})})}),c&&e.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(P,{className:"border-[#5f6f52]/20 shadow-sm",children:[e.jsxs(B,{className:"pb-4",children:[e.jsx(U,{className:"text-lg text-[#5f6f52]",children:"Progresso do Dia"}),e.jsx(ve,{children:"Consumido vs Meta"})]}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4 text-orange-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Calorias"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(x.calories)," / ",Math.round(c.calories)," kcal"]})]}),e.jsx(W,{value:c.calories>0?Math.min(x.calories/c.calories*100,100):0,className:"h-3",indicatorClassName:"bg-gradient-to-r from-orange-500 to-red-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"w-4 h-4 text-sky-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Proteínas"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(x.protein)," / ",Math.round(c.protein),"g"]})]}),e.jsx(W,{value:c.protein>0?Math.min(x.protein/c.protein*100,100):0,className:"h-3",indicatorClassName:"bg-sky-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Carboidratos"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(x.carbs)," / ",Math.round(c.carbs),"g"]})]}),e.jsx(W,{value:c.carbs>0?Math.min(x.carbs/c.carbs*100,100):0,className:"h-3",indicatorClassName:"bg-amber-500"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4 text-yellow-500"}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Gorduras"})]}),e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[Math.round(x.fat)," / ",Math.round(c.fat),"g"]})]}),e.jsx(W,{value:c.fat>0?Math.min(x.fat/c.fat*100,100):0,className:"h-3",indicatorClassName:"bg-yellow-500"})]})]})]})}),e.jsx("div",{className:"space-y-4",children:m.map((a,r)=>{const n=Q[a]||[],xe=n.length>0;return e.jsx(G.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+r*.05},children:xe?e.jsxs(P,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(B,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-[#5f6f52]"}),e.jsx(U,{className:"text-base",children:z(a)})]}),e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>I(a),className:"border-[#5f6f52]/30 text-[#5f6f52] hover:bg-[#5f6f52]/10",children:[e.jsx(Z,{className:"w-4 h-4 mr-1"}),"Adicionar mais"]})]})}),e.jsx(S,{children:e.jsx("div",{className:"space-y-3",children:n.map(j=>e.jsxs(G.div,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"border rounded-lg p-4 bg-background hover:bg-muted/30 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("h4",{className:"text-sm font-semibold text-foreground",children:z(a)})}),e.jsxs("p",{className:"text-lg font-bold text-[#5f6f52]",children:[j.total_calories?.toFixed(0)," kcal"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["P: ",j.total_protein?.toFixed(1),"g • C: ",j.total_carbs?.toFixed(1),"g • G: ",j.total_fat?.toFixed(1),"g"]})]}),e.jsxs(_e,{children:[e.jsx(we,{asChild:!0,children:e.jsx(b,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ee,{className:"w-4 h-4"})})}),e.jsxs(Me,{align:"end",children:[e.jsxs(J,{onClick:()=>R("/patient/add-meal",{state:{editMode:!0,mealId:j.id}}),children:[e.jsx(es,{className:"w-4 h-4 mr-2"}),"Editar"]}),e.jsxs(J,{onClick:()=>F(j.id),className:"text-destructive focus:text-destructive",children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Excluir"]})]})]})]}),j.meal_items?.length>0&&e.jsx("div",{className:"space-y-2 mt-3 pt-3 border-t",children:j.meal_items.map((V,he)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-foreground",children:V.foods?.name||"Alimento desconhecido"}),e.jsxs("span",{className:"font-medium text-muted-foreground",children:[V.quantity," ",V.measure]})]},he))})]},j.id))})})]}):e.jsx(P,{className:"border-2 border-dashed border-muted-foreground/30 bg-muted/20 hover:bg-muted/30 hover:border-primary/40 transition-all cursor-pointer",onClick:()=>I(a),children:e.jsx(S,{className:"py-8 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:e.jsx(A,{className:"w-6 h-6 text-primary/60"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-base font-semibold text-muted-foreground",children:["Registrar ",z(a)]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Clique para adicionar alimentos"})]}),e.jsxs(b,{size:"sm",className:"mt-2 bg-primary hover:bg-primary/90",onClick:j=>{j.stopPropagation(),I(a)},children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Adicionar"]})]})})})},a)})}),e.jsxs(se,{open:o,onOpenChange:t,children:[e.jsx(De,{asChild:!0,children:e.jsxs(b,{variant:"outline",className:"w-full",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Registrar Outra Refeição"]})}),e.jsxs(ae,{children:[e.jsxs(te,{children:[e.jsx(re,{children:"Escolha o Tipo de Refeição"}),e.jsx(le,{children:"Selecione qual refeição deseja registrar"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 py-4",children:M.map(a=>e.jsxs(b,{variant:"outline",className:"justify-start",onClick:()=>I(a.key),children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),a.label]},a.key))})]})]})]}),e.jsx(rs,{open:l,onOpenChange:H,mealPlan:T,patientName:y?.profile?.name}),e.jsx(ke,{isOpen:Y,setIsOpen:L}),e.jsx(Pe,{open:!!i,onOpenChange:()=>F(null),children:e.jsxs(Se,{children:[e.jsxs(Te,{children:[e.jsx(Fe,{children:"Excluir Refeição"}),e.jsx(Ee,{children:"Deseja realmente excluir esta refeição? Esta ação não pode ser desfeita."})]}),e.jsxs(Oe,{children:[e.jsx(Ae,{children:"Cancelar"}),e.jsx(ze,{onClick:me,className:"bg-destructive hover:bg-destructive/90",children:"Excluir"})]})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})})]})}export{ks as default};
