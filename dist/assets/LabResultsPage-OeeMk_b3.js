import{a5 as Ve,b as Be,a as qe,u as Ie,r as l,s as Ue,j as e,B as n,C as E,e as k,c as Ke,d as $e,w as He,$,T as de,J as H,K as G,M as J,N as W,ad as ce,X as me,O as X,L as xe,t as Ge}from"./index-BvWB-6Y-.js";import{I as w}from"./input-OBodSLFw.js";import{D as Je}from"./date-input-NufpG6-F.js";import{L as c}from"./label-Dds-NHUC.js";import{B as Q}from"./badge-CCK5Bs0D.js";import{S as ue,a as he,b as fe,c as pe,d as y}from"./select-CHitR1r5.js";import{g as Y}from"./date-C2sroe8F.js";import{a as We,b as Xe,c as Qe,d as Ye,u as Ze,e as es,f as ss,h as ts,i as as}from"./lab-results-queries-B3ZMjFH4.js";import{A as rs}from"./arrow-left-c5Ho3YFj.js";import{D as Z}from"./droplet-BdKopZMO.js";import{P as ge}from"./plus-BWNKYoo4.js";import{S as ls}from"./search-DAzfs9rU.js";import{F as C}from"./file-text-CyOxrREb.js";import{C as ns}from"./calendar-BxLBJTLY.js";import{E as je}from"./eye-D-rBLbjZ.js";import{P as ve}from"./pen-square-OCV3PTXs.js";import{U as is}from"./upload-r4K88bxr.js";import{S as os}from"./save-BW9rbxWl.js";import{A as ds}from"./alert-circle-HzKGSyQg.js";import{D as cs}from"./download-CU2JC9ir.js";import{T as ms}from"./trending-up-DCN4wKoA.js";import{T as xs}from"./trending-down-Be-17Tpn.js";import{M as us}from"./minus-Doq1nRnQ.js";import"./calendar-rgGv7qqU.js";import"./endOfMonth-Ca9QmV5D.js";import"./addMonths-hOFFPW3g.js";import"./isSameDay-CSO39H9U.js";import"./chevron-left-FDyjizdT.js";import"./popover-BK70NwGK.js";import"./extends-CF3RwP-h.js";import"./pt-BR-BMtVLtF7.js";import"./parseISO-DtrTOw4I.js";import"./query-helpers-mbysFH2_.js";const Gs=()=>{const{patientId:j}=Ve(),Ne=Be(),{toast:m}=qe(),{user:ee}=Ie(),[_e,se]=l.useState(!0),[A,te]=l.useState(!1),[be,we]=l.useState(""),[d,ye]=l.useState([]),[S,Ce]=l.useState([]),[p,De]=l.useState({total:0,high:0,medium:0,low:0,highest_risk:"none"}),[v,z]=l.useState(""),[Fe,O]=l.useState(!1),[i,V]=l.useState(null),[Ee,P]=l.useState(!1),[B,ae]=l.useState(null),[ke,q]=l.useState(!1),[R,Se]=l.useState(null),[x,D]=l.useState(null),[L,re]=l.useState(!1),le=l.useRef(null),[a,I]=l.useState({test_name:"",test_value:"",test_unit:"",reference_min:"",reference_max:"",test_date:Y(),notes:""}),[T,Pe]=l.useState(""),[M,Re]=l.useState("all");l.useEffect(()=>{Le(),U()},[j,ee?.id]),l.useEffect(()=>{Te()},[d,T,M]);const Le=async()=>{try{const{data:s}=await Ue.from("user_profiles").select("name").eq("id",j).single();s&&we(s.name)}catch(s){console.error("Erro ao carregar dados do paciente:",s)}},U=async()=>{se(!0);try{const{data:s,error:t}=await We(j),{data:r}=await Xe(ee?.id||null);if(t)throw t;const u=Qe(s||[],r||[]);ye(u.data||[]),De(u.summary||{total:0,high:0,medium:0,low:0,highest_risk:"none"})}catch(s){console.error("Erro ao carregar exames:",s),m({title:"Erro",description:"Não foi possível carregar os exames.",variant:"destructive"})}finally{se(!1)}},Te=()=>{let s=[...d];T&&(s=s.filter(t=>t.test_name.toLowerCase().includes(T.toLowerCase()))),M!=="all"&&(s=s.filter(t=>t.status===M)),Ce(s)},F=l.useMemo(()=>{const s={};return(d||[]).forEach(t=>{const r=t.marker_key||t.test_name||"marcador_desconhecido";s[r]||(s[r]=[]),s[r].push(t)}),Object.keys(s).forEach(t=>{s[t].sort((r,u)=>new Date(r.test_date)-new Date(u.test_date))}),s},[d]),N=l.useMemo(()=>Object.keys(F).map(s=>{const t=F[s]||[],r=t[t.length-1];return{markerKey:s,label:r?.test_name||s,count:t.length}}),[F]);l.useEffect(()=>{if(!N.length){z("");return}(!v||!N.some(s=>s.markerKey===v))&&z(N[0].markerKey)},[N,v]);const h=l.useMemo(()=>F[v]||[],[F,v]),f=l.useMemo(()=>{if(!h.length)return null;const s=h[h.length-1],t=h.length>1?h[h.length-2]:null,r=Number(s?.test_value),u=Number(t?.test_value);if(!Number.isFinite(r)||!Number.isFinite(u))return{latest:s,previous:t,direction:"stable",delta:null};const b=r-u,o=b>0?"up":b<0?"down":"stable";return{latest:s,previous:t,direction:o,delta:b}},[h]),K=(s=null)=>{s?(V(s),I({test_name:s.test_name,test_value:s.test_value||"",test_unit:s.test_unit||"",reference_min:s.reference_min?.toString()||"",reference_max:s.reference_max?.toString()||"",test_date:s.test_date,notes:s.notes||""}),D(null)):(V(null),I({test_name:"",test_value:"",test_unit:"",reference_min:"",reference_max:"",test_date:Y(),notes:""}),D(null)),O(!0)},ne=()=>{O(!1),V(null),D(null)},Me=s=>{const t=s.target.files?.[0];if(t){if(t.type!=="application/pdf"){m({title:"Tipo de arquivo inválido",description:"Apenas arquivos PDF são permitidos.",variant:"destructive"});return}if(t.size>10*1024*1024){m({title:"Arquivo muito grande",description:"O arquivo deve ter no máximo 10MB.",variant:"destructive"});return}D(t)}},ie=s=>{Se(s),q(!0)},g=(s,t)=>{I(r=>({...r,[s]:t}))},Ae=async()=>{if(!a.test_name||!a.test_date){m({title:"Campos obrigatórios",description:"Preencha nome do exame e data.",variant:"destructive"});return}const s=a.test_value&&a.test_value.trim()!=="",t=x||i?.pdf_url;if(!s&&!t){m({title:"Dados obrigatórios",description:"Preencha os valores do exame OU anexe um PDF (ou ambos).",variant:"destructive"});return}te(!0),re(!0);try{let r=i?.pdf_url||null,u=i?.pdf_filename||null;if(x){const o=await Ze(j,x);if(o.error)throw new Error(o.error.message||"Erro ao fazer upload do PDF");r=o.url,u=o.filename,i?.pdf_url&&await es(i.pdf_url)}const b={patient_id:j,test_name:a.test_name,test_date:a.test_date,notes:a.notes||null,test_value:a.test_value||null,test_unit:a.test_unit||null,reference_min:a.reference_min?parseFloat(a.reference_min):null,reference_max:a.reference_max?parseFloat(a.reference_max):null,pdf_url:r,pdf_filename:u};if(i){const{error:o}=await ss(i.id,b);if(o)throw o;m({title:"Atualizado!",description:"Exame atualizado com sucesso."})}else{const{error:o}=await ts(b);if(o)throw o;m({title:"Adicionado!",description:"Exame adicionado com sucesso."})}ne(),U()}catch(r){console.error("Erro ao salvar exame:",r),m({title:"Erro",description:Ge(r,"Não foi possível salvar o exame."),variant:"destructive"})}finally{te(!1),re(!1)}},ze=async()=>{if(B)try{const{error:s}=await as(B.id);if(s)throw s;m({title:"Excluído!",description:"Exame excluído com sucesso."}),P(!1),ae(null),U()}catch(s){console.error("Erro ao excluir exame:",s),m({title:"Erro",description:"Não foi possível excluir o exame.",variant:"destructive"})}},oe=s=>{const t={normal:{label:"Normal",className:"bg-emerald-100 text-emerald-800 border-emerald-300"},low:{label:"Baixo",className:"bg-amber-100 text-amber-800 border-amber-300"},high:{label:"Alto",className:"bg-red-100 text-red-800 border-red-300"},pending:{label:"Pendente",className:"bg-gray-100 text-gray-800 border-gray-300"}},r=t[s]||t.pending;return e.jsx(Q,{variant:"outline",className:$("text-xs",r.className),children:r.label})},_=s=>{const t={none:{label:"Risco baixo",className:"bg-emerald-100 text-emerald-800 border-emerald-300"},low:{label:"Risco leve",className:"bg-sky-100 text-sky-800 border-sky-300"},medium:{label:"Risco moderado",className:"bg-amber-100 text-amber-800 border-amber-300"},high:{label:"Risco alto",className:"bg-red-100 text-red-800 border-red-300"}},r=t[s]||t.none;return e.jsx(Q,{variant:"outline",className:$("text-xs",r.className),children:r.label})},Oe=s=>s==="up"?{icon:ms,label:"Em alta",className:"text-red-600"}:s==="down"?{icon:xs,label:"Em queda",className:"text-emerald-600"}:{icon:us,label:"Estável",className:"text-muted-foreground"};return _e?null:e.jsxs("div",{className:"flex flex-col min-h-screen bg-background overflow-x-hidden",children:[e.jsxs("div",{className:"max-w-7xl mx-auto w-full px-4 md:px-8 py-4 md:py-8 min-w-0",children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[e.jsxs(n,{variant:"ghost",size:"sm",onClick:()=>Ne(`/nutritionist/patients/${j}/hub`),className:"-ml-2 w-fit text-[#5f6f52] hover:text-[#5f6f52] hover:bg-[#5f6f52]/10",children:[e.jsx(rs,{className:"w-4 h-4 mr-1"}),"Voltar"]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(Z,{className:"w-6 h-6 md:w-8 md:h-8 text-[#b99470]"}),e.jsx("span",{className:"truncate",children:"Exames Laboratoriais"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1 truncate",children:["Paciente: ",e.jsx("span",{className:"font-medium text-foreground",children:be})]})]}),e.jsxs(n,{onClick:()=>K(),className:"gap-2 w-full sm:w-auto",children:[e.jsx(ge,{className:"w-4 h-4"}),"Adicionar Exame"]})]})]}),e.jsx(E,{className:"mb-6",children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(c,{htmlFor:"search",children:"Buscar exame"}),e.jsxs("div",{className:"relative",children:[e.jsx(ls,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(w,{id:"search",placeholder:"Digite o nome do exame...",value:T,onChange:s=>Pe(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"status-filter",children:"Filtrar por status"}),e.jsxs(ue,{value:M,onValueChange:Re,children:[e.jsx(he,{id:"status-filter",children:e.jsx(fe,{})}),e.jsxs(pe,{children:[e.jsx(y,{value:"all",children:"Todos"}),e.jsx(y,{value:"normal",children:"Normal"}),e.jsx(y,{value:"low",children:"Baixo"}),e.jsx(y,{value:"high",children:"Alto"}),e.jsx(y,{value:"pending",children:"Pendente"})]})]})]})]})})}),d.length>0&&e.jsxs(E,{className:"mb-6",children:[e.jsxs(Ke,{children:[e.jsx($e,{className:"text-lg",children:"Risco Laboratorial e Tendência"}),e.jsx(He,{children:"Semáforo de risco por regra e evolução temporal por marcador."})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[_("high")," ",e.jsx("span",{className:"text-sm text-muted-foreground",children:p.high}),_("medium")," ",e.jsx("span",{className:"text-sm text-muted-foreground",children:p.medium}),_("low")," ",e.jsx("span",{className:"text-sm text-muted-foreground",children:p.low}),_("none")," ",e.jsx("span",{className:"text-sm text-muted-foreground",children:Math.max(0,(p.total||0)-(p.high||0)-(p.medium||0)-(p.low||0))})]}),N.length>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"marker-select",children:"Marcador"}),e.jsxs(ue,{value:v,onValueChange:z,children:[e.jsx(he,{id:"marker-select",children:e.jsx(fe,{})}),e.jsx(pe,{children:N.map(s=>e.jsxs(y,{value:s.markerKey,children:[s.label," (",s.count,")"]},s.markerKey))})]})]}),e.jsx("div",{className:"md:col-span-2 rounded-lg border p-3",children:f?(()=>{const s=Oe(f.direction),t=s.icon;return e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Último valor"}),e.jsxs("p",{className:"text-lg font-semibold",children:[f.latest?.test_value??"--"," ",f.latest?.test_unit||""]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f.latest?.test_date?new Date(f.latest.test_date).toLocaleDateString("pt-BR"):"sem data"})]}),e.jsxs("div",{className:$("flex items-center gap-1 text-sm font-medium",s.className),children:[e.jsx(t,{className:"w-4 h-4"}),s.label,f.delta!=null?` (${f.delta>0?"+":""}${f.delta.toFixed(2)})`:""]})]})})():e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sem dados para tendência."})})]}),h.length>0&&e.jsxs("div",{className:"space-y-2 rounded-lg border p-3",children:[e.jsx("p",{className:"text-sm font-medium",children:"Linha do tempo"}),e.jsx("div",{className:"space-y-2 max-h-44 overflow-y-auto pr-1",children:[...h].reverse().slice(0,8).map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-2",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium",children:[s.test_value??"--"," ",s.test_unit||""]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.test_date?new Date(s.test_date).toLocaleDateString("pt-BR"):"sem data"})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[_(s.risk_level||"none"),s.risk_reason?e.jsx("span",{className:"text-[11px] text-muted-foreground",children:s.risk_reason}):null]})]},s.id))})]})]})]}),S.length===0?e.jsx(E,{className:"border-dashed",children:e.jsxs(k,{className:"py-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center mx-auto mb-4",children:e.jsx(Z,{className:"w-8 h-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:d.length===0?"Nenhum exame registrado":"Nenhum resultado encontrado"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:d.length===0?"Adicione o primeiro exame laboratorial do paciente":"Tente ajustar os filtros de busca"}),d.length===0&&e.jsxs(n,{onClick:()=>K(),className:"gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Adicionar Primeiro Exame"]})]})}):e.jsx("div",{className:"space-y-3",children:S.map(s=>e.jsx(E,{className:"hover:shadow-md transition-all",children:e.jsx(k,{className:"py-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[e.jsx("h3",{className:"text-lg font-semibold truncate",children:s.test_name}),s.pdf_url&&e.jsxs(Q,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700 border-blue-300",children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),"PDF"]}),s.test_value!==null&&s.test_value!==void 0&&s.test_value!==""&&s.status&&oe(s.status),s.test_value!==null&&s.test_value!==void 0&&s.test_value!==""&&_(s.risk_level||"none")]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:[s.test_value&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Valor:"})," ",e.jsxs("span",{className:"font-medium",children:[s.test_value," ",s.test_unit||""]})]}),s.reference_min!=null&&s.reference_max!=null&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Referência:"})," ",e.jsxs("span",{className:"font-medium",children:[s.reference_min," - ",s.reference_max]})]})]}),s.pdf_url&&!s.test_value&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground truncate",children:s.pdf_filename||"Arquivo PDF"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ns,{className:"w-3 h-3 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:new Date(s.test_date).toLocaleDateString("pt-BR")})]})]}),s.notes&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 italic",children:["Obs: ",s.notes]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.pdf_url&&e.jsx(n,{variant:"outline",size:"icon",onClick:()=>ie(s.pdf_url),title:"Visualizar PDF",children:e.jsx(je,{className:"w-4 h-4 text-blue-600"})}),e.jsx(n,{variant:"outline",size:"icon",onClick:()=>K(s),title:"Editar",children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsx(n,{variant:"outline",size:"icon",onClick:()=>{ae(s),P(!0)},title:"Excluir",children:e.jsx(de,{className:"w-4 h-4 text-destructive"})})]})]})})},s.id))}),d.length>0&&e.jsx(E,{className:"mt-6",children:e.jsx(k,{className:"py-4",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:["Total de exames: ",e.jsx("strong",{children:d.length})]}),S.length!==d.length&&e.jsxs("span",{className:"text-muted-foreground",children:["Exibindo: ",e.jsx("strong",{children:S.length})]})]})})})]}),e.jsx(H,{open:Fe,onOpenChange:O,children:e.jsxs(G,{className:"sm:max-w-[650px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(J,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-primary"}),i?"Editar Exame":"Adicionar Novo Exame"]}),e.jsx(ce,{children:i?"Atualize as informações do exame":"Preencha valores e/ou anexe PDF"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"test_name",children:"Nome do Exame *"}),e.jsx(w,{id:"test_name",placeholder:"Ex: Hemograma, Glicemia, Colesterol Total",value:a.test_name,onChange:s=>g("test_name",s.target.value)})]}),e.jsxs("div",{className:"space-y-3 p-4 bg-muted/50 rounded-lg border border-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[e.jsx(ve,{className:"w-4 h-4"}),"Valores Manuais (opcional)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"test_value",children:"Valor do Resultado"}),e.jsx(w,{id:"test_value",placeholder:"Ex: 95",value:a.test_value,onChange:s=>g("test_value",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"test_unit",children:"Unidade"}),e.jsx(w,{id:"test_unit",placeholder:"Ex: mg/dL, ng/mL",value:a.test_unit,onChange:s=>g("test_unit",s.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"reference_min",children:"Referência Mínima"}),e.jsx(w,{id:"reference_min",type:"number",step:"0.01",placeholder:"Ex: 70",value:a.reference_min,onChange:s=>g("reference_min",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"reference_max",children:"Referência Máxima"}),e.jsx(w,{id:"reference_max",type:"number",step:"0.01",placeholder:"Ex: 100",value:a.reference_max,onChange:s=>g("reference_max",s.target.value)})]})]}),a.test_value&&a.reference_min&&a.reference_max&&e.jsxs("div",{className:"p-3 bg-background rounded-lg border",children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Status calculado:"}),e.jsx("div",{children:oe(Ye(a.test_value,a.reference_min,a.reference_max))})]})]}),e.jsxs("div",{className:"space-y-3 p-4 bg-muted/50 rounded-lg border border-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[e.jsx(C,{className:"w-4 h-4"}),"Anexar PDF (opcional)"]}),i?.pdf_url&&!x&&e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-green-900",children:"PDF anexado"}),e.jsx("div",{className:"text-xs text-green-700",children:i.pdf_filename})]})]}),e.jsxs(n,{type:"button",size:"sm",variant:"outline",onClick:()=>ie(i.pdf_url),children:[e.jsx(je,{className:"w-4 h-4 mr-1"}),"Ver PDF"]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"pdf-upload",children:x||i?.pdf_url?"Substituir PDF":"Anexar PDF do Exame"}),e.jsx("input",{ref:le,id:"pdf-upload",type:"file",accept:"application/pdf",onChange:Me,className:"hidden"}),e.jsxs(n,{type:"button",variant:"outline",className:"w-full",onClick:()=>le.current?.click(),children:[e.jsx(is,{className:"w-4 h-4 mr-2"}),x?`Arquivo selecionado: ${x.name}`:"Escolher arquivo PDF"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Formato: PDF • Tamanho máximo: 10MB"})]}),x&&e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-900",children:"Novo arquivo selecionado"}),e.jsxs("div",{className:"text-xs text-blue-700",children:[x.name," • ",(x.size/1024/1024).toFixed(2)," MB"]})]})]}),e.jsx(n,{type:"button",size:"sm",variant:"ghost",onClick:()=>D(null),children:e.jsx(me,{className:"w-4 h-4"})})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"test_date",children:"Data do Exame *"}),e.jsx(Je,{id:"test_date",value:a.test_date,onChange:s=>g("test_date",s),max:Y()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"notes",children:"Observações"}),e.jsx("textarea",{id:"notes",className:"w-full min-h-[80px] px-3 py-2 text-sm rounded-md border border-input bg-background resize-none",placeholder:"Notas adicionais sobre o exame...",value:a.notes,onChange:s=>g("notes",s.target.value)})]})]}),e.jsxs(X,{children:[e.jsxs(n,{variant:"outline",onClick:ne,disabled:A||L,children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Cancelar"]}),e.jsx(n,{onClick:Ae,disabled:A||L,children:A||L?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-4 h-4 mr-2 animate-spin"}),L?"Enviando...":"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(os,{className:"w-4 h-4 mr-2"}),i?"Atualizar":"Adicionar"]})})]})]})}),e.jsx(H,{open:Ee,onOpenChange:P,children:e.jsxs(G,{children:[e.jsxs(J,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(ds,{className:"w-5 h-5 text-destructive"}),"Confirmar Exclusão"]}),e.jsxs(ce,{children:["Tem certeza que deseja excluir o exame ",e.jsx("strong",{children:B?.test_name}),"? Esta ação não pode ser desfeita."]})]}),e.jsxs(X,{children:[e.jsx(n,{variant:"outline",onClick:()=>P(!1),children:"Cancelar"}),e.jsxs(n,{variant:"destructive",onClick:ze,children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Excluir"]})]})]})}),e.jsx(H,{open:ke,onOpenChange:q,children:e.jsxs(G,{className:"sm:max-w-[90vw] max-h-[90vh] p-0",children:[e.jsx(J,{className:"p-6 pb-0",children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5 text-primary"}),"Visualizar Exame (PDF)"]})}),e.jsx("div",{className:"h-[75vh] p-6 pt-4",children:R?e.jsx("iframe",{src:R,className:"w-full h-full rounded-lg border border-border",title:"Visualizador de PDF"}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(xe,{className:"w-8 h-8 animate-spin text-muted-foreground"})})}),e.jsxs(X,{className:"p-6 pt-0",children:[e.jsx(n,{variant:"outline",onClick:()=>q(!1),children:"Fechar"}),R&&e.jsxs(n,{onClick:()=>window.open(R,"_blank"),children:[e.jsx(cs,{className:"w-4 h-4 mr-2"}),"Abrir em nova aba"]})]})]})})]})};export{Gs as default};
